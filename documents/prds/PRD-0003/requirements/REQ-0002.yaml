prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"

  id: "REQ-0002"
  type: "FUNCTIONAL"
  title: "AAT Agent Invocation as Merge Gate"
  statement: |
    The AAT agent MUST be invoked automatically on PR creation and update events.
    The aat/acceptance status check MUST block merge until it reports success or
    is explicitly waived by an authorized authority.

  acceptance_criteria:
    - "AAT agent triggers on PR opened event"
    - "AAT agent triggers on PR synchronize event (new commits)"
    - "GitHub branch protection requires aat/acceptance status check"
    - "PR cannot merge when aat/acceptance is pending or failure"
    - "Waiver by AUTH_AAT or AUTH_SECURITY allows merge despite failure"
    - "Status check includes target_url linking to evidence bundle"

  evidence:
    evidence_ids:
      - "EVID-0003"
      - "EVID-0004"
    inherited_from_prd: false
    notes:
      - "Branch protection rules must be configured in repository settings"
