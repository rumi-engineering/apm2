prd_evidence_artifact:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"

  id: "EVID-0009"
  category: "POLICY_CHECK_RESULTS"
  title: "TODO Documentation Check"

  capture:
    paths:
      - "evidence/aat/todo_documentation/"

  verification:
    commands:
      - id: "CMD-0001"
        shell: "bash"
        command: |
          # Verify TODO documentation check results
          set -euo pipefail
          TODO_FILE="$1"

          if [[ ! -f "$TODO_FILE" ]]; then
            echo "TODO check file not found: $TODO_FILE"
            exit 1
          fi

          # Validate JSON
          jq empty "$TODO_FILE" || { echo "Invalid JSON"; exit 1; }

          # Check required sections
          jq -e '.todos_found' "$TODO_FILE" > /dev/null || {
            echo "Missing todos_found section"
            exit 1
          }

          jq -e '.documented_in_known_limitations' "$TODO_FILE" > /dev/null || {
            echo "Missing documented_in_known_limitations section"
            exit 1
          }

          # Check for undocumented TODOs
          UNDOCUMENTED=$(jq '.undocumented_todos | length' "$TODO_FILE")
          if [[ "$UNDOCUMENTED" -gt 0 ]]; then
            echo "Found $UNDOCUMENTED undocumented TODOs"
            jq '.undocumented_todos' "$TODO_FILE"
            exit 1
          fi

          echo "TODO documentation check passed"
        expected_exit_code: 0
        cwd: "."
        timeout_seconds: 60
        network_access: "DISALLOWED"
        allowlist_hosts: []
        constraints:
          - "Requires jq installed"

  data:
    classification: "INTERNAL"
    redaction:
      required: false
      guidance: []
