prd_success_metrics:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"

  metrics:
    - id: "MET-0001"
      name: "AAT Coverage Rate"
      description: "Percentage of PRs that receive AAT verification before merge"
      baseline: "0% (no AAT currently)"
      target: ">= 95%"
      measurement_method: "Count of PRs with AAT status check / Total merged PRs"
      evidence_ids:
        - "EVID-0004"

    - id: "MET-0002"
      name: "False Positive Rate"
      description: "Percentage of AAT failures that are incorrect (verified correct PR marked as failed)"
      baseline: "N/A"
      target: "< 5%"
      measurement_method: "Count of AAT failures overridden by adjudication / Total AAT failures"
      evidence_ids:
        - "EVID-0004"
        - "EVID-0006"

    - id: "MET-0003"
      name: "Hypothesis Hit Rate"
      description: "Percentage of hypotheses that pass verification (too high suggests tests are too easy)"
      baseline: "N/A"
      target: "70-95%"
      measurement_method: "Passed hypotheses / Total hypotheses across all AAT runs"
      evidence_ids:
        - "EVID-0005"
        - "EVID-0006"

    - id: "MET-0004"
      name: "Post-Merge Defect Rate"
      description: "Percentage of merged PRs that result in production defects related to acceptance criteria"
      baseline: "Unknown"
      target: "< 2%"
      measurement_method: "Defects traced to acceptance failures / Total merged PRs with AAT pass"
      evidence_ids:
        - "EVID-0003"
        - "EVID-0006"

    - id: "MET-0005"
      name: "AAT Execution Time (P95)"
      description: "95th percentile time from AAT trigger to status check completion"
      baseline: "N/A"
      target: "< 10 minutes"
      measurement_method: "P95 of (status_check_time - trigger_time) across AAT runs"
      evidence_ids:
        - "EVID-0003"

    - id: "MET-0006"
      name: "Anti-Gaming Detection Rate"
      description: "Percentage of gaming attempts (hardcoded values, mock returns) detected by AAT"
      baseline: "0% (no detection currently)"
      target: "> 90%"
      measurement_method: "Detected gaming patterns / Known gaming patterns in test corpus"
      evidence_ids:
        - "EVID-0007"
        - "EVID-0008"

  guardrails:
    - id: "GRD-0001"
      name: "AAT Timeout Limit"
      threshold: "AAT execution must complete within 15 minutes"
      response_plan: "If AAT times out, set status to pending and alert for investigation"
      evidence_ids:
        - "EVID-0003"

    - id: "GRD-0002"
      name: "Manual Override Rate Limit"
      threshold: "Manual AAT overrides must not exceed 10% of total AAT runs"
      response_plan: "If override rate exceeds limit, review AAT false positive patterns"
      evidence_ids:
        - "EVID-0004"

    - id: "GRD-0003"
      name: "Hypothesis Minimum"
      threshold: "Every AAT run must produce at least 3 hypotheses"
      response_plan: "If fewer hypotheses, set status to pending and request PR description improvement"
      evidence_ids:
        - "EVID-0005"
