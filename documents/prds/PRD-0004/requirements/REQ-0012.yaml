prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: REQ-0012
  type: FUNCTIONAL
  title: Deterministic finding signatures for clustering
  statement: 'Findings MUST have deterministic signatures computed from canonical fields (category, rule_id, language, api_surface, normalized snippet fingerprint). The same issue MUST produce the same signature regardless of when, where, or by which agent it was detected.'
  acceptance_criteria:
    - FindingSignature is computed from category, rule_id, language, api_surface, and snippet_fingerprint.
    - Snippet fingerprint is blake3 hash of normalized snippet (whitespace removed, variables anonymized).
    - Same logical issue in different files/commits produces identical signature.
    - Signature computation is a pure function with no external dependencies.
    - Property tests verify signature determinism across equivalent code patterns.
    - Signature enables O(1) lookup for recurrence checking.
  evidence:
    evidence_ids:
      - EVID-0004
