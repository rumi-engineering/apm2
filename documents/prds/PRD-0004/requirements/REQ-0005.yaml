prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: REQ-0005
  type: FUNCTIONAL
  title: ChangeSet abstraction decoupled from git branches
  statement: 'The system MUST provide a ChangeSet abstraction that decouples work tracking from git branches. A ChangeSet represents a proposed change with a stable ID, associated plan reference, and lifecycle state. Git commit ranges are optional metadata, not the primary identifier.'
  acceptance_criteria:
    - ChangeSet has stable ID (changeset-{uuid}) independent of git branch name.
    - ChangeSet references plan_id and spec_snapshot_hash for reproducibility.
    - ChangeSet lifecycle (OPEN → SUBMITTED → REVIEWING → MERGED/ABANDONED) tracked via ledger events.
    - Multiple ChangeSets can exist for the same plan (e.g., parallel implementation approaches).
    - ChangeSet can exist before any git commits (planning phase).
    - ChangeSetOpened, ChangeSetSubmitted, ChangeSetMerged events emitted to ledger.
  evidence:
    evidence_ids:
      - EVID-0002
      - EVID-0003
