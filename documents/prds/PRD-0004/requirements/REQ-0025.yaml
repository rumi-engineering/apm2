prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: REQ-0025
  type: SECURITY
  title: Critical Event Signing
  statement: Critical ledger events MUST be signed by their authoring agent using
    Ed25519 signatures; critical events include PlanApproved, GateOutcome, CountermeasureProposed,
    and MergeReceipt.
  acceptance_criteria:
  - Critical events (PlanApproved, GateOutcome, CountermeasureProposed, MergeReceipt)
    include author_actor_id and event_signature fields.
  - Signatures are Ed25519 over canonical protobuf-encoded event bytes with domain
    separator specific to event type (e.g., "PLAN_APPROVED:", "GATE_OUTCOME:", "COUNTERMEASURE_PROPOSED:",
    "MERGE_RECEIPT:").
  - Signature verification is mandatory on event ingestion; unsigned or invalid-signature
    critical events are rejected with reason code INVALID_SIGNATURE.
  - The author_actor_id MUST correspond to an agent identity with an authorized Ed25519
    public key; key binding to agent identity is enforced during signature verification.
  - Event signatures are included in the hash chain computation as part of the canonical
    event bytes, ensuring signature integrity is bound to the immutable audit trail.
  - All unsigned critical events are rejected at ingestion time; the ledger writer
    MUST NOT persist critical events lacking valid signatures.
  - Audit log records signature verification results (success/failure, key ID, timestamp)
    for all critical event ingestion attempts.
  evidence:
    evidence_ids:
    - EVID-0004
    - EVID-0016
    inherited_from_prd: true
    notes:
    - "Cryptographic binding per INV-0007: ensures critical governance and work state\
      \ transitions are attributable and tamper-evident"
    - "Agent identity key binding prevents unauthorized agents from forging critical\
      \ decisions"
    - "Signature inclusion in hash chain computation ensures end-to-end cryptographic\
      \ integrity"
