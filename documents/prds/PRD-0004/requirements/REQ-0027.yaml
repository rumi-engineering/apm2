prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"

  id: "REQ-0027"
  type: "FUNCTIONAL"
  title: "Recurrence threshold with time window"
  statement: |
    The RecurrenceReducer MUST track finding recurrence by signature and automatically
    create countermeasure work when a finding signature exceeds a configurable threshold
    within a configurable time window. Recurrence counting MUST be time-bounded to
    focus countermeasure efforts on recent, active issues rather than historical noise.

  acceptance_criteria:
    - "Recurrence threshold is configurable per signature category (default: 3 occurrences)."
    - "Recurrence count is computed within configurable time window (default: 30 days)."
    - "Older findings outside the time window do not increment recurrence count."
    - "When signature recurrence exceeds threshold within window, CountermeasureProposed event is emitted."
    - "Time window is measured from finding detection timestamp, not resolution timestamp."
    - "RecurrenceReducer projection maintains sliding window counts per signature."
    - "Recurrence statistics queryable via `apm2 stats findings --recurrence [--signature SIGNATURE]`."
    - "Time window configuration is recorded in ledger; changes trigger recurrence recomputation."

  evidence:
    evidence_ids:
      - "EVID-0004"
      - "EVID-0005"
    inherited_from_prd: false
    notes:
      - "Time-bounded recurrence prevents countermeasure work for stale issues"
      - "Configurable window enables tuning based on development velocity"
      - "Supports systematic self-improvement per GOAL-0004"
