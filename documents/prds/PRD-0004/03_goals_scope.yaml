prd_goals_scope:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  goals:
    - id: G-0001
      statement: Agents can create and refine plans via stable internal APIs without knowledge of external forge APIs.
      measurable_outcomes:
        - Agent produces high-fidelity PRD from low-fidelity idea in <5 tool invocations.
        - No agent code references GitHub, GitLab, or other external forge APIs.
        - Plan refinement produces deterministic patches and decisions recorded to ledger.
    - id: G-0002
      statement: All work state lives in the ledger and is projectable via deterministic reducers; external forges are sync adapters, not sources of truth.
      measurable_outcomes:
        - All work lifecycle queries (status, history, findings) are answerable from ledger projections.
        - GitHub state is a strict projection of internal state; internal operations proceed regardless of GitHub availability.
        - Work state is reproducible by replaying ledger events.
    - id: G-0003
      statement: Reviews and gates operate as internal holonic episodes producing typed findings and evidence bundles.
      measurable_outcomes:
        - Gate outcomes (AAT, security, code quality) are ledger events with evidence bundle references.
        - Findings are typed artifacts with deterministic signatures enabling clustering.
        - Agents receive structured feedback (not prose) for remediation.
    - id: G-0004
      statement: Agents receive structured feedback enabling systematic self-improvement via recurrence detection and countermeasure automation.
      measurable_outcomes:
        - FindingSignature enables clustering of equivalent issues across the factory.
        - Recurrence exceeding threshold automatically creates countermeasure work items.
        - Countermeasure effectiveness is tracked as reduction in recurrence rate post-deployment.
  scope:
    in_scope:
      - 'Plan lifecycle: create from template, bounded refinement passes, lint gates, approval events.'
      - 'ChangeSet abstraction: decouple from git branches, bind spec snapshot hash to commit range.'
      - 'Internal gate system: Gate trait, GateRunner, AAT/security/code-quality implementations.'
      - 'Finding normalization: FindingSignature with deterministic fingerprinting for clustering.'
      - 'Recurrence tracking: RecurrenceReducer with threshold-triggered countermeasure creation.'
      - 'Evidence bundle management: content-addressed artifacts with verification commands.'
      - 'GitHub sync adapter: project ledger state to PRs/issues while preserving internal authority.'
      - 'Operator console: audit timeline/why, stats findings/gates, intervene freeze/override commands.'
      - 'WorkReducer and projections: plan status, gate readiness, traceability closure queries.'
    out_of_scope:
      - Full GitHub replacement (CI runner, artifact storage, team management).
      - Browser-based UI for work management.
      - Multi-tenant or multi-repository support.
      - Credential management (covered in PRD-0001).
      - Real-time push notifications or collaboration features.
      - Custom distributed consensus for work state (single authority per subtree is sufficient).
  success_criteria_summary:
    - Agent can refine idea to approved PRD without calling any external forge API.
    - Work status queries are answered from ledger projections in <100ms.
    - GitHub sync adapter reflects internal state; GitHub unavailability does not block internal work.
    - Recurring findings are detected and countermeasure work is automatically created.
    - Gate outcomes provide structured feedback enabling targeted remediation.
