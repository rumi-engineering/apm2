prd_decisions_review:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  decisions:
    - id: DEC-0001
      decision: "Scope"
      choice: "Execution substrate only"
      rationale: |
        FAC (PRD-0009) handles admission decisions; PRD-0010 handles orchestration.
        Clear separation of concerns prevents scope creep and maintains single
        responsibility.
      alternatives_considered:
        - "Combined admission + orchestration in daemon"
        - "Admission logic embedded in daemon"
      date: "2026-01-30"
    - id: DEC-0002
      decision: "Agent Types"
      choice: "Core trio (IMPLEMENTER, GATE_EXECUTOR, AAT_EXECUTOR)"
      rationale: |
        Gate executor parameterized by gate_id allows single role type for all gates.
        Reduces complexity while maintaining capability differentiation.
      alternatives_considered:
        - "Separate role per gate type (SECURITY_REVIEWER, QUALITY_REVIEWER, etc.)"
        - "Single generic EXECUTOR role with capability-based differentiation only"
      date: "2026-01-30"
    - id: DEC-0003
      decision: "Migration"
      choice: "Deprecation period (2-3 releases)"
      rationale: |
        xtask emits warnings -> --allow-deprecated flag -> removal. Gradual migration
        reduces disruption and allows discovery of undocumented dependencies.
      alternatives_considered:
        - "Hard cutover in single release"
        - "Indefinite parallel support"
      date: "2026-01-30"
    - id: DEC-0004
      decision: "IPC Auth"
      choice: "Unix socket + peer creds + capability tokens"
      rationale: |
        Privilege separation for agent vs operator. Peer credentials provide strong
        authentication without credential exchange. Capability tokens scope operations.
      alternatives_considered:
        - "Named pipes (Windows compatibility)"
        - "HTTP with bearer tokens"
        - "mTLS over Unix socket"
      date: "2026-01-30"
    - id: DEC-0005
      decision: "Policy Resolution Ownership"
      choice: "Daemon calls HOLON-KERNEL-GOVERNANCE for policy resolution"
      rationale: |
        Governance logic remains centralized in governance holon. Daemon is caller,
        not owner, of policy resolution. Ensures auditability and single source of
        policy truth.
      alternatives_considered:
        - "Daemon embeds policy resolution logic"
        - "Agent calls governance directly"
      date: "2026-01-30"
    - id: DEC-0006
      decision: "Context Firewall Implementation"
      choice: "Reuse FAC rules (CTX-*), implement enforcement point"
      rationale: |
        Rule semantics defined in PRD-0009 FAC. PRD-0010 specifies mechanical enforcement
        in tool broker only. Avoids duplicate rule definitions.
      alternatives_considered:
        - "Independent context firewall rules in PRD-0010"
        - "Shared library for rules with separate enforcement"
      date: "2026-01-30"
    - id: DEC-0007
      decision: "xtask Divergence During Deprecation"
      choice: "WARNING only, no freeze during deprecation period"
      rationale: |
        Full freeze enforcement during deprecation would trap operators who haven't
        migrated. WARNING allows visibility while preventing migration deadlock.
      alternatives_considered:
        - "Full freeze from day one"
        - "No divergence detection during deprecation"
      date: "2026-01-30"
  review_history:
    - review_id: REV-0001
      date: "2026-01-30"
      reviewer: "PRD Review Agent"
      findings_count: 21
      blockers: 0
      majors: 16
      minors: 5
      status: "NEEDS_REMEDIATION"
      notes: |
        Initial review identified 21 findings. Key issues: policy resolution ownership
        ambiguity (resolved in DEC-0005), context firewall reuse clarification (resolved
        in DEC-0006), deprecation freeze loop risk (resolved in DEC-0007).
