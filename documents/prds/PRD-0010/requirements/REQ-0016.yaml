prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: "REQ-0016"
  type: "SECURITY"
  source_id: "DCP-G-0001"
  title: "Capability Terminology Separation"
  statement: |
    apm2-daemon IPC protocol MUST separate feature negotiation terminology from
    permission capability terminology; protocol handshake fields for version/feature
    negotiation MUST NOT use "capability" or "cap" naming; permission capabilities
    (OCAP handles minted by policy) MUST use distinct naming (capability_manifest,
    granted_capabilities) to prevent semantic confusion and future policy bypass.
  acceptance_criteria:
    - "Protocol handshake uses 'supported_features'/'enabled_features' for feature negotiation, not 'caps'. Verified by: Proto schema inspection shows no 'cap' fields in handshake."
    - "Permission capabilities use 'capability_manifest' or 'granted_capabilities' naming. Verified by: Proto schema uses approved naming for OCAP handles."
    - "No semantic overlap between feature flags and permission grants. Verified by: Code review confirms feature negotiation cannot influence permission decisions."
    - "Documentation clearly distinguishes feature negotiation from permission capabilities. Verified by: IPC protocol docs include terminology glossary."
  evidence:
    evidence_ids:
      - EVID-0015
  law_alignment:
    - law_id: "LAW-05"
      enforcement: "Dual-Axis Containment: Clear semantic boundary between features and permissions"
      applies_to:
        - "IPC protocol design"
        - "Capability minting"
    - law_id: "LAW-13"
      enforcement: "Contract Determinism: Unambiguous protocol contracts"
      applies_to:
        - "Proto schema naming"
  defect_codes:
    - code: "CAPABILITY_SEMANTIC_CONFUSION"
      severity: "S1"
      description: "Protocol field naming conflates features with permissions"
    - code: "FEATURE_AS_PERMISSION"
      severity: "S0"
      description: "Feature negotiation field used to grant permissions"
  review_finding_ref: "FND-PRD-0010-002"
