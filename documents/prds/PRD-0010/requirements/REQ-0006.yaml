prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: "REQ-0006"
  type: "SECURITY"
  source_id: "DCP-G-0005"
  title: "SoD Custody Domain Enforcement"
  statement: |
    apm2-daemon MUST enforce Separation of Duties by rejecting gate executor spawn
    when executor custody domain overlaps with author custody domains for the
    changeset; rejection MUST emit diagnostic event.
  acceptance_criteria:
    - "SpawnEpisode for gate executor validates custody domain separation from author. Verified by: ADV-006 test shows same-domain author+reviewer spawn is rejected."
    - "LeaseIssueDenied event emitted with reason=SOD_VIOLATION on custody domain overlap. Verified by: Event inspection confirms reason field."
    - "CLI returns non-zero exit code with diagnostic message. Verified by: CLI output inspection shows error message and non-zero exit."
    - "Custody domain check uses FAC key policy grouping. Verified by: Test confirms group-level check, not individual key."
  evidence:
    evidence_ids:
      - EVID-0006
  law_alignment:
    - law_id: "LAW-05"
      enforcement: "Dual-Axis Containment: SoD via custody domains"
      applies_to:
        - "Gate executor spawn"
        - "Custody domain validation"
  defect_codes:
    - code: "SOD_VIOLATION"
      severity: "S1"
      description: "Gate executor custody domain overlaps author domain"
