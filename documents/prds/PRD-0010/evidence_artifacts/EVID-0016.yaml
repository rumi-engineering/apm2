prd_evidence_artifact:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: "EVID-0016"
  category: "INTEGRATION_TEST"
  title: "RFC-0015 dependency contract integration test"
  description: |
    Integration test validating PRD-0010 compatibility with RFC-0015 event
    schemas. Tests verify PolicyResolvedForChangeSet and GateLeaseIssued
    events have required fields and types. CI gate blocks RFC-0015 changes
    that break PRD-0010 compatibility.
  source_acceptance_test: INT-002
  capture:
    paths:
      - "test/integration/rfc0015_contract.rs"
      - "evidence/integration/rfc0015_contract/"
  verification:
    commands:
      - id: "CMD-0001"
        shell: "bash"
        command: "cargo test --workspace -- integration::rfc0015_contract"
        expected_exit_code: 0
        cwd: "."
        timeout_seconds: 120
        network_access: "DISALLOWED"
        allowlist_hosts: []
        constraints:
          - "RFC-0015 event schemas available"
          - "PRD-0010 daemon components compiled"
      - id: "CMD-0002"
        shell: "bash"
        command: "cargo test --workspace -- integration::rfc0015_contract::schema_compatibility"
        expected_exit_code: 0
        cwd: "."
        timeout_seconds: 60
        network_access: "DISALLOWED"
        allowlist_hosts: []
        constraints:
          - "Schema definition files present"
  assertions:
    - "PolicyResolvedForChangeSet has required fields: work_id, changeset_digest, policy_hash, risk_tier"
    - "GateLeaseIssued has required fields: work_id, gate_id, changeset_digest, executor_actor_id, lease_expiry"
    - "Field types match expected types (no silent coercion)"
    - "Missing required fields cause test failure"
    - "CI configuration includes cross-dependency check"
    - "Breaking change to RFC-0015 triggers PRD-0010 integration test"
  data:
    classification: "INTERNAL"
    redaction:
      required: false
      guidance: []
