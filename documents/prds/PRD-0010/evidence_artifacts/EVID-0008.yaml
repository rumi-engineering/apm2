prd_evidence_artifact:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: "EVID-0008"
  category: "SECURITY_TEST"
  title: "ADV-008: xtask direct GitHub write divergence"
  description: |
    Adversarial test verifying divergence detection for direct xtask GitHub
    writes. Test uses xtask to write directly to GitHub, expects divergence
    detection. During deprecation period: WARNING only. Post-deprecation: freeze.
  source_acceptance_test: ADV-008
  capture:
    paths:
      - "test/daemon/adversarial/adv_008_xtask_divergence.rs"
      - "evidence/adv/ADV-008/"
  verification:
    commands:
      - id: "CMD-0001"
        shell: "bash"
        command: "cargo test --workspace -- daemon::adversarial::adv_008"
        expected_exit_code: 0
        cwd: "."
        timeout_seconds: 120
        network_access: "ALLOW_LISTED_ONLY"
        allowlist_hosts:
          - "api.github.com"
        constraints:
          - "Daemon running with divergence watchdog enabled"
          - "Test GitHub repository available"
  assertions:
    - "Direct xtask GitHub write triggers divergence detection"
    - "During deprecation: WARNING emitted, no freeze"
    - "Post-deprecation: PROJECTION_DIVERGENCE emitted, freeze triggered"
    - "Divergence includes diff of expected vs observed state"
  data:
    classification: "INTERNAL"
    redaction:
      required: true
      guidance:
        - "Redact GitHub repository names"
        - "Redact any tokens in logs"
