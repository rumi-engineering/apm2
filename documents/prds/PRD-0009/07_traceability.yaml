prd_traceability:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  requirement_registry:
    mode: "FILE_PER_REQUIREMENT"
    local_root: "requirements/"
    local_requirements:
      - requirement_id: "REQ-0001"
        requirement_ref: "requirements/REQ-0001.yaml#prd_requirement"
      - requirement_id: "REQ-0002"
        requirement_ref: "requirements/REQ-0002.yaml#prd_requirement"
      - requirement_id: "REQ-0003"
        requirement_ref: "requirements/REQ-0003.yaml#prd_requirement"
      - requirement_id: "REQ-0004"
        requirement_ref: "requirements/REQ-0004.yaml#prd_requirement"
      - requirement_id: "REQ-0005"
        requirement_ref: "requirements/REQ-0005.yaml#prd_requirement"
      - requirement_id: "REQ-0006"
        requirement_ref: "requirements/REQ-0006.yaml#prd_requirement"
      - requirement_id: "REQ-0007"
        requirement_ref: "requirements/REQ-0007.yaml#prd_requirement"
      - requirement_id: "REQ-0008"
        requirement_ref: "requirements/REQ-0008.yaml#prd_requirement"
      - requirement_id: "REQ-0009"
        requirement_ref: "requirements/REQ-0009.yaml#prd_requirement"
      - requirement_id: "REQ-0010"
        requirement_ref: "requirements/REQ-0010.yaml#prd_requirement"
      - requirement_id: "REQ-0011"
        requirement_ref: "requirements/REQ-0011.yaml#prd_requirement"
      - requirement_id: "REQ-0012"
        requirement_ref: "requirements/REQ-0012.yaml#prd_requirement"
      - requirement_id: "REQ-0013"
        requirement_ref: "requirements/REQ-0013.yaml#prd_requirement"
      - requirement_id: "REQ-0014"
        requirement_ref: "requirements/REQ-0014.yaml#prd_requirement"
      - requirement_id: "REQ-0015"
        requirement_ref: "requirements/REQ-0015.yaml#prd_requirement"
      - requirement_id: "REQ-0016"
        requirement_ref: "requirements/REQ-0016.yaml#prd_requirement"
      - requirement_id: "REQ-0017"
        requirement_ref: "requirements/REQ-0017.yaml#prd_requirement"
      - requirement_id: "REQ-0018"
        requirement_ref: "requirements/REQ-0018.yaml#prd_requirement"
      - requirement_id: "REQ-0019"
        requirement_ref: "requirements/REQ-0019.yaml#prd_requirement"
      - requirement_id: "REQ-0020"
        requirement_ref: "requirements/REQ-0020.yaml#prd_requirement"
    imports:
      - source_prd: "PRD-0004"
        requirement_id: "REQ-0009"
        description: "Signed GateRunCompleted"
      - source_prd: "PRD-0004"
        requirement_id: "REQ-0015"
        description: "GitHub sync adapter projects ledger state"
      - source_prd: "PRD-0004"
        requirement_id: "REQ-0025"
        description: "Critical Event Signing"
  mapping:
    requirement_to_sections:
      - requirement_id: "PRD-0004:REQ-0009"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.protocol.stages"
          - "04_solution_overview.yaml#prd_solution_overview.authority.identity.keys"
      - requirement_id: "PRD-0004:REQ-0015"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.protocol.stages"
          - "04_solution_overview.yaml#prd_solution_overview.projection"
      - requirement_id: "PRD-0004:REQ-0025"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.authority.identity.keys"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.security_controls"
      - requirement_id: "REQ-0001"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.protocol.stages"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.security_controls"
      - requirement_id: "REQ-0002"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.protocol.stages"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.invariants"
      - requirement_id: "REQ-0003"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.protocol.stages"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0004"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.aat_contract"
          - "04_solution_overview.yaml#prd_solution_overview.gate_receipts"
      - requirement_id: "REQ-0005"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.determinism_envelope"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0006"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.aat_contract"
          - "04_solution_overview.yaml#prd_solution_overview.gate_receipts"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0007"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.aat_contract"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0008"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.aat_contract"
          - "04_solution_overview.yaml#prd_solution_overview.determinism_envelope"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0009"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.aat_contract"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0010"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.authority.gate_lease"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0011"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.aat_contract"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0012"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.aat_contract"
          - "04_solution_overview.yaml#prd_solution_overview.protocol.stages"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0013"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.aat_contract"
          - "04_solution_overview.yaml#prd_solution_overview.appendix"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0014"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.aat_contract"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
          - "11_evidence_standards.yaml#prd_evidence_standards"
      - requirement_id: "REQ-0015"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.aat_contract"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0016"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.aat_contract"
          - "04_solution_overview.yaml#prd_solution_overview.ocap_and_context"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0017"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.protocol.stages"
          - "04_solution_overview.yaml#prd_solution_overview.policy_resolution_anchor"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0018"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.quarantine"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0019"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.ci_evidence"
          - "11_evidence_standards.yaml#prd_evidence_standards"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
      - requirement_id: "REQ-0020"
        section_refs:
          - "04_solution_overview.yaml#prd_solution_overview.gate_receipts"
          - "06_constraints_invariants.yaml#prd_constraints_invariants.constraints"
  source_mapping:
    fac_requirement_to_local:
      - source_id: "FAC-REQ-0100"
        local_id: "REQ-0001"
        title: "Mechanical Context Firewall"
      - source_id: "FAC-REQ-0101"
        local_id: "REQ-0002"
        title: "Projection Divergence Emergency Stop"
      - source_id: "FAC-REQ-0102"
        local_id: "REQ-0003"
        title: "CI evidence-backed readiness gating"
      - source_id: "FAC-REQ-0103"
        local_id: "REQ-0004"
        title: "Typed GateReceipt payloads for AAT"
      - source_id: "FAC-REQ-0104"
        local_id: "REQ-0005"
        title: "Gate outcome determinism envelope"
      - source_id: "FAC-REQ-0105"
        local_id: "REQ-0006"
        title: "Evidence-bound AAT GateReceipt"
      - source_id: "FAC-REQ-0106"
        local_id: "REQ-0007"
        title: "Terminal verifier binding for AAT"
      - source_id: "FAC-REQ-0107"
        local_id: "REQ-0008"
        title: "AAT flake classification and policy routing"
      - source_id: "FAC-REQ-0108"
        local_id: "REQ-0009"
        title: "Risk-tiered AAT selection policy"
      - source_id: "FAC-REQ-0109"
        local_id: "REQ-0010"
        title: "AAT lease binding and executor isolation"
      - source_id: "FAC-REQ-0110"
        local_id: "REQ-0011"
        title: "Invariant-first AAT specifications"
      - source_id: "FAC-REQ-0111"
        local_id: "REQ-0012"
        title: "AAT anti-downgrade invariant"
      - source_id: "FAC-REQ-0112"
        local_id: "REQ-0013"
        title: "AAT reuse safety and provenance"
      - source_id: "FAC-REQ-0113"
        local_id: "REQ-0014"
        title: "AAT evidence hygiene and retention"
      - source_id: "FAC-REQ-0114"
        local_id: "REQ-0015"
        title: "AAT quorum/audit enforcement by risk tier"
      - source_id: "FAC-REQ-0115"
        local_id: "REQ-0016"
        title: "AAT harness sandboxing and egress control"
      - source_id: "FAC-REQ-0116"
        local_id: "REQ-0017"
        title: "Policy resolution anchor event"
      - source_id: "FAC-REQ-0117"
        local_id: "REQ-0018"
        title: "Quarantine events and projection"
      - source_id: "FAC-REQ-0118"
        local_id: "REQ-0019"
        title: "CI attestation level enforcement"
      - source_id: "FAC-REQ-0119"
        local_id: "REQ-0020"
        title: "GateReceipt versioning and canonicalization"
    law_to_requirement:
      - law_id: "LAW-01"
        applies_to:
          - "GateRunCompleted"
          - "MergeReceipt"
        enforcement: "Signed events + receipt verification + deterministic admission projection"
        requirement_ids:
          - "PRD-0004:REQ-0009"
          - "REQ-0001"
          - "REQ-0004"
          - "REQ-0006"
          - "REQ-0010"
          - "REQ-0012"
          - "REQ-0015"
          - "REQ-0017"
          - "REQ-0020"
      - law_id: "LAW-02"
        applies_to:
          - "ContextPack"
          - "RunReceipt"
        enforcement: "Context sufficiency observed; context misses terminate and trigger refinement"
        requirement_ids:
          - "REQ-0001"
          - "REQ-0010"
      - law_id: "LAW-03"
        applies_to:
          - "GitHub adapter"
        enforcement: "Ledger is truth; projections overwriteable; divergence detection halts factory"
        requirement_ids:
          - "PRD-0004:REQ-0015"
          - "REQ-0002"
      - law_id: "LAW-04"
        applies_to:
          - "LLM reviewers"
        enforcement: "Terminal verifiers anchor; advisory signals never sole admission basis"
        requirement_ids:
          - "REQ-0003"
          - "REQ-0004"
          - "REQ-0005"
          - "REQ-0006"
          - "REQ-0007"
          - "REQ-0011"
          - "REQ-0016"
          - "REQ-0019"
      - law_id: "LAW-05"
        applies_to:
          - "OCAP"
        enforcement: "Mechanical context firewall + capability scoping; no ambient credentials"
        requirement_ids:
          - "REQ-0001"
          - "REQ-0016"
      - law_id: "LAW-08"
        applies_to:
          - "Gates"
        enforcement: "Holdouts/adversarial suites + evaluator audit (Phase 2)"
        requirement_ids:
          - "REQ-0001"
      - law_id: "LAW-10"
        applies_to:
          - "Merge semantics"
        enforcement: "Atomic merge receipt binds (base, changeset) -> result; anti-entropy divergence checks"
        requirement_ids:
          - "REQ-0002"
      - law_id: "LAW-12"
        applies_to:
          - "Coordinator"
        enforcement: "Bounded retries, echo-trap detection, oracle escalation"
        requirement_ids:
          - "REQ-0001"
          - "REQ-0005"
          - "REQ-0008"
          - "REQ-0009"
          - "REQ-0013"
          - "REQ-0018"
      - law_id: "LAW-15"
        applies_to:
          - "Metrics"
        enforcement: "Measurement integrity: auditor sampling + drift alarms"
        requirement_ids:
          - "REQ-0001"
          - "REQ-0004"
          - "REQ-0005"
          - "REQ-0006"
          - "REQ-0007"
          - "REQ-0008"
          - "REQ-0009"
          - "REQ-0010"
          - "REQ-0012"
          - "REQ-0013"
          - "REQ-0014"
          - "REQ-0017"
          - "REQ-0018"
          - "REQ-0019"
          - "REQ-0020"
          - "REQ-0015"
  terminology_links:
    - term: "Gate"
      ref: "documents/theory/unified-theory-v2.json"
    - term: "Merge Receipt"
      ref: "documents/theory/unified-theory-v2.json"
    - term: "ContextPack"
      ref: "documents/theory/unified-theory-v2.json"
    - term: "View Commitment"
      ref: "documents/theory/unified-theory-v2.json"
    - term: "Lease/Budget"
      ref: "documents/theory/unified-theory-v2.json"
    - term: "OCAP"
      ref: "documents/theory/unified-theory-v2.json"
    - term: "Terminal Verifier"
      ref: "documents/theory/unified-theory-v2.json"
    - term: "Oracle"
      ref: "documents/theory/unified-theory-v2.json"
  external_references:
    - ref_id: "PRD-0004"
      type: "PRD"
      path: "documents/prds/PRD-0004/"
      description: "Work Substrate PRD - inherited requirements for signed events and GitHub sync"
    - ref_id: "PRD-0007"
      type: "PRD"
      path: "documents/prds/PRD-0007/"
      description: "CAC Substrate PRD - control artifact and admission patterns"
    - ref_id: "RFC-0012"
      type: "RFC"
      path: "documents/rfcs/RFC-0012/"
      description: "Coordination patterns and CAS-at-commit ordering"
    - ref_id: "RFC-0013"
      type: "RFC"
      path: "documents/rfcs/RFC-0013/"
      description: "Daemon runtime and session management"
    - ref_id: "LAWS"
      type: "SKILL"
      path: "documents/theory/AGENTS.md"
      description: "Laws of Holonic Agent Systems governing FAC behavior"
    - ref_id: "GLOSSARY"
      type: "SKILL"
      path: "documents/theory/unified-theory-v2.json"
      description: "APM2 terminology glossary"
