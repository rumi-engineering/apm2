prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: "REQ-0018"
  type: "SECURITY"
  source_id: "FAC-REQ-0117"
  title: "Quarantine events and projection"
  statement: |
    Quarantine MUST be modeled as first-class events with a QuarantineProjection.
    Runner pool and AAT spec quarantines are enforced by selection/routing; work
    transitions are not used to represent quarantine state.
  acceptance_criteria:
    - "RunnerPoolQuarantined, AATSpecQuarantined, and QuarantineCleared events are signed and include quarantine_id, target_id, reason, evidence_refs, time_envelope_ref (HTF). Verified by: Schema validation test."
    - "QuarantineProjection keyed by target_id reflects current quarantine status. Verified by: Projection update test."
    - "Selection excludes quarantined runner pools/specs; if no eligible targets exist, admission returns NEEDS_INPUT. Verified by: Routing test."
    - "Quarantine windows use HTF time envelopes (TIME_TBD); wall-clock timestamps are observational only. Verified by: Policy enforcement test."
  evidence:
    evidence_ids:
      - EVID-0034
  law_alignment:
    - law_id: "LAW-12"
      enforcement: "Bounded retries and termination discipline use explicit quarantine state."
      applies_to:
        - "QuarantineProjection"
        - "Routing"
    - law_id: "LAW-15"
      enforcement: "Fail-closed behavior for quarantined targets."
      applies_to:
        - "Admission"
  defect_codes:
    - code: "QUARANTINE_ACTIVE"
      severity: "S1"
      description: "Attempted selection of quarantined runner pool or AAT spec"
    - code: "QUARANTINE_EVENT_INVALID"
      severity: "S1"
      description: "Invalid quarantine event signature or schema"
