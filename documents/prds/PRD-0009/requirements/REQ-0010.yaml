prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: "REQ-0010"
  type: "SECURITY"
  source_id: "FAC-REQ-0109"
  title: "AAT lease binding and executor isolation"
  statement: |
    AAT GateLease scope MUST bind view_commitment_hash, rcp_aat_manifest_hash, and
    selection_policy_id; AAT executor keys MUST be isolated from coordinator and
    implementer custody domains. Gate runs MUST execute against pinned snapshots,
    not live worktrees.
  acceptance_criteria:
    - "GateLease for gate_id=aat includes view_commitment_hash, rcp_aat_manifest_hash, and selection_policy_id. Verified by: Lease schema validation test."
    - "GateRunCompleted for gate_id=aat matches lease-bound view_commitment_hash and rcp_aat_manifest_hash. Verified by: Admission rejection on mismatch."
    - "Executor key custody domain differs from coordinator/implementer roles. Verified by: KeyPolicy enforcement test."
    - "AAT runs execute against pinned snapshots only; live worktree reads are denied. Verified by: Context firewall test using a live worktree probe."
  evidence:
    evidence_ids:
      - EVID-0026
  law_alignment:
    - law_id: "LAW-01"
      enforcement: "Lease-bound authority and receipt verification for admission integrity."
      applies_to:
        - "GateLease"
        - "GateRunCompleted"
    - law_id: "LAW-05"
      enforcement: "OCAP containment and no ambient authority for consumption holons."
      applies_to:
        - "Context firewall"
    - law_id: "LAW-15"
      enforcement: "Measurement integrity requires custody separation."
      applies_to:
        - "KeyPolicy"
  defect_codes:
    - code: "UNAUTHORIZED_EXECUTOR"
      severity: "S0"
      description: "AAT executor key not authorized or custody domain violation"
    - code: "AAT_POLICY_MISMATCH"
      severity: "S1"
      description: "Lease-bound policy selection mismatch"
