prd_readme:
  schema_version: "2026-01-23"
  prd_id: "PRD-0008"
  title: "Agent Coordination Layer for Autonomous Work Loop Execution"
  description: |
    This PRD defines the Agent Coordination Layer, enabling autonomous work loop
    execution in the APM2 system. The coordination layer binds work items to agent
    sessions, enforces budgets and stop conditions, and emits evidence receipts.

    Key components:
    - CoordinationReducer: Event-sourced state projection
    - Work-Session Binding: Links work items to agent sessions
    - Budget Enforcement: max_episodes, max_duration_ms limits
    - Circuit Breaker: 3 consecutive failure abort
    - CLI Command: apm2 coordinate
    - Evidence Receipts: receipt.coordination artifacts

  status: "DRAFT"
  created_date: "2026-01-27"
  north_star_alignment: |
    Directly enables Phase 1 exit criterion: "Agent can complete end-to-end feature
    implementation from PRD to merged PR without manual intervention."

  directory_structure:
    - "00_meta.yaml - PRD metadata and custody"
    - "01_customer.yaml - Customer segments and user journeys"
    - "02_problem.yaml - Problem statement and failure modes"
    - "03_goals_scope.yaml - Goals and scope definition"
    - "04_solution_overview.yaml - Technical solution design"
    - "05_success_metrics.yaml - Metrics and guardrails"
    - "06_constraints_invariants.yaml - Constraints, invariants, security"
    - "07_traceability.yaml - Requirement traceability"
    - "08_risks_questions.yaml - Risks and open questions"
    - "09_decisions_review.yaml - Design decisions and gates"
    - "10_quality_framework.yaml - Quality dimensions"
    - "11_evidence_standards.yaml - Evidence policies"
    - "12_evidence_bundle.yaml - Evidence artifact registry"
    - "13_governance_model.yaml - Governance and gates"
    - "requirements/ - Individual requirement files"
    - "evidence_artifacts/ - Evidence artifact definitions"

  key_requirements:
    - "REQ-COORD-0001: CoordinationReducer implementation"
    - "REQ-COORD-0002: Work-session binding events"
    - "REQ-COORD-0003: Coordination budget enforcement"
    - "REQ-COORD-0004: Serial execution loop"
    - "REQ-COORD-0005: Stop conditions and circuit breaker"
    - "REQ-COORD-0006: CLI command (apm2 coordinate)"
    - "REQ-COORD-0007: Coordination evidence receipts"

  guardrails:
    - "GRD-COORD-001: Hard budget ceiling (non-optional)"
    - "GRD-COORD-002: Circuit breaker (3 consecutive failures)"
    - "GRD-COORD-003: Work freshness check before spawn"
