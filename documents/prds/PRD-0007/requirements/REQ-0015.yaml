prd_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: "REQ-0015"
  type: "FUNCTIONAL"
  title: "RunReceipt emission"
  statement: |
    Consumption runs MUST emit RunReceipt capturing context_pack_miss, context_pack_sufficiency,
    and budget usage. Pack misses MUST trigger DefectRecord emission and run failure by
    default unless explicitly in escalation-allowed mode.
  acceptance_criteria:
    - "RunReceipt captures context_pack_miss count. Verified by: RunReceipt schema includes miss_count field."
    - "RunReceipt captures context_pack_sufficiency flag. Verified by: RunReceipt schema includes sufficiency boolean."
    - "RunReceipt captures budget usage. Verified by: RunReceipt includes budget delta quantities."
    - "Pack miss triggers DefectRecord and run failure. Verified by: context_pack_miss > 0 emits UNPLANNED_CONTEXT_READ defect and fails run."
  evidence:
    evidence_ids:
      - EVID-0011
