prd_success_metrics:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  metrics:
    - id: CAC-M-LEAD-0001
      name: Unplanned context reads in consumption mode
      description: Count of denied or defect-emitting context reads per work item.
      baseline: "Baseline established from first 30 days post-deployment; expected >50 per 1000 work items."
      target: "≥20% MoM decrease; <5 per 1000 work items within 6 months (80% CI: 3-8 per 1000)."
      measurement_method: "Aggregate PolicyViolation and DefectRecord events from ledger; compute rate per 1000 work items with Wilson score interval."
      evidence_ids:
        - EVID-0005
    - id: CAC-M-LEAD-0002
      name: ContextPack completeness rate
      description: Fraction of work items completed without unplanned reads.
      baseline: "Baseline established from first 30 days; expected <50% initially."
      target: "≥95% within 3 months; ≥99% within 12 months (80% CI: 98.5%-99.5%)."
      measurement_method: "RunReceipt analysis for context_pack_sufficiency=true; Clopper-Pearson exact confidence interval."
      evidence_ids:
        - EVID-0011
    - id: CAC-M-LEAD-0004
      name: ContextPack miss rate
      description: Rate of context_pack_miss entries per run receipt.
      baseline: "Baseline established from first 30 days; expected >2 misses per run."
      target: "<0.5 misses per run within 6 months; <0.1 within 12 months."
      measurement_method: "Aggregate context_pack_miss counts from RunReceipts; Poisson rate with exact confidence interval."
      evidence_ids:
        - EVID-0011
    - id: CAC-M-LEAD-0005
      name: ContextPack sufficiency rate
      description: Fraction of runs where context_pack_sufficiency=true.
      baseline: "Baseline established from first 30 days; expected <50% initially."
      target: "≥95% within 3 months; ≥99% within 12 months."
      measurement_method: "RunReceipt aggregation with Clopper-Pearson exact confidence interval."
      evidence_ids:
        - EVID-0011
    - id: CAC-M-LEAD-0003
      name: Admission rejection rate by category
      description: Schema/canonicalization/replay/policy rejection counts.
      baseline: "Expected >30% rejection rate in first 30 days during adoption."
      target: "<10% within 3 months; <5% within 6 months as authoring tooling improves."
      measurement_method: "PolicyViolation event categorization from ledger; track by category (schema, replay, policy)."
      evidence_ids:
        - EVID-0002
        - EVID-0003
    - id: CAC-M-LAG-0001
      name: PR cycle time
      description: Median time from work opened to work completed and merged.
      baseline: "Current baseline to be measured via EVID-0013 methodology."
      target: "≥15% reduction in median cycle time within 3 months post-adoption (p<0.05)."
      measurement_method: "WorkEvent timeline analysis from ledger with stratification by PR complexity and work type."
      evidence_ids:
        - EVID-0013
    - id: CAC-M-LAG-0002
      name: Defect recurrence rate (missing-context class)
      description: Repeat incidence of UNPLANNED_CONTEXT_READ defects on similar work types.
      baseline: "Baseline established from first 30 days of DefectRecord collection."
      target: "≥20% MoM decrease in recurrence rate; <5 recurring signatures per 1000 work items within 6 months."
      measurement_method: "DefectRecord clustering by signature using Jaccard similarity; Poisson regression for trend analysis."
      evidence_ids:
        - EVID-0014
  guardrails:
    - id: GRD-0001
      name: Bootstrap trust root integrity
      threshold: "Bootstrap hash verification MUST pass at startup."
      response_plan: "Fail startup if bootstrap verification fails. No runtime recovery; requires binary update."
      evidence_ids:
        - EVID-0008
    - id: GRD-0002
      name: Canonicalization determinism
      threshold: "Canonicalization MUST be idempotent across all platforms and runs."
      response_plan: "Hash drift triggers immediate investigation; canonicalizer version recorded for audit."
      evidence_ids:
        - EVID-0001
    - id: GRD-0003
      name: Schema strictness enforcement
      threshold: "Unknown fields MUST be rejected; size/depth limits MUST be enforced."
      response_plan: "Validation failures are fail-closed; artifacts rejected without admission."
      evidence_ids:
        - EVID-0002
    - id: GRD-0004
      name: Consumption hermeticity
      threshold: "Discretionary context discovery MUST be denied in consumption mode."
      response_plan: "Policy violations emit DefectRecord; runs fail unless explicitly escalated."
      evidence_ids:
        - EVID-0005
    - id: GRD-0005
      name: Export determinism
      threshold: "Exports from identical inputs MUST produce byte-identical trees."
      response_plan: "Export drift triggers conformance test failure; blocks release."
      evidence_ids:
        - EVID-0006
