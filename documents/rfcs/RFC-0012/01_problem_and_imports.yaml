rfc_problem_and_imports:
  schema_version: "2026-01-26"
  template_version: "2026-01-26"

  problem_statement:
    summary: |
      APM2 lacks the coordination layer that binds work items to agent sessions and
      manages the autonomous execution loop. Operators must manually spawn agents for
      each work item, monitor completion, and decide retry/escalation strategies. This
      manual intervention is the primary blocker for achieving Phase 1 autonomous operation.

      The coordination layer is the missing piece that enables autonomous work loop
      execution: spawning sessions on a loop, tracking outcomes, enforcing budgets and
      stop conditions, and emitting evidence receipts - all without manual intervention.
    prd_ref: "documents/prds/PRD-0008/02_problem.yaml#prd_problem"

  imported_requirements:
    - id: REQ-COORD-0001
      title: "CoordinationReducer implementation"
      ref: "documents/prds/PRD-0008/requirements/REQ-COORD-0001.yaml#prd_requirement"
    - id: REQ-COORD-0002
      title: "Work-session binding events"
      ref: "documents/prds/PRD-0008/requirements/REQ-COORD-0002.yaml#prd_requirement"
    - id: REQ-COORD-0003
      title: "Coordination budget enforcement"
      ref: "documents/prds/PRD-0008/requirements/REQ-COORD-0003.yaml#prd_requirement"
    - id: REQ-COORD-0004
      title: "Serial execution loop"
      ref: "documents/prds/PRD-0008/requirements/REQ-COORD-0004.yaml#prd_requirement"
    - id: REQ-COORD-0005
      title: "Stop conditions and circuit breaker"
      ref: "documents/prds/PRD-0008/requirements/REQ-COORD-0005.yaml#prd_requirement"
    - id: REQ-COORD-0006
      title: "CLI command (apm2 coordinate)"
      ref: "documents/prds/PRD-0008/requirements/REQ-COORD-0006.yaml#prd_requirement"
    - id: REQ-COORD-0007
      title: "Coordination evidence receipts"
      ref: "documents/prds/PRD-0008/requirements/REQ-COORD-0007.yaml#prd_requirement"

  ccp_grounding:
    ccp_index_ref: "evidence/prd/PRD-0008/ccp/ccp_index.json"
    impact_assessment: |
      All 7 requirements are NET-NEW. The impact map shows no existing components match
      coordination functionality at Jaccard similarity threshold. This is expected:
      - WorkReducer handles work state, not work-session binding
      - SessionReducer handles session lifecycle, not multi-session coordination
      - LeaseReducer handles resource budgets, not coordination-level budgets

      Coordination is a new reducer that observes events from existing reducers and
      emits coordination-specific events. It does NOT modify other reducer states.
    component_dependencies:
      - id: COMP-WORK-REDUCER
        ref: "crates/apm2-core/src/work/reducer.rs"
        rationale: "CoordinationController reads WorkState to determine work queue"
      - id: COMP-SESSION-REDUCER
        ref: "crates/apm2-core/src/session/reducer.rs"
        rationale: "CoordinationController reads SessionState and spawns sessions"
      - id: COMP-LEASE-REDUCER
        ref: "crates/apm2-core/src/lease/reducer.rs"
        rationale: "Coordination budget enforcement complements session-level leases"
      - id: COMP-LEDGER
        ref: "crates/apm2-core/src/ledger/mod.rs"
        rationale: "Coordination events appended to and replayed from ledger"
      - id: COMP-CAS
        ref: "crates/apm2-core/src/cas/mod.rs"
        rationale: "CoordinationReceipt stored in content-addressed store"
      - id: COMP-CLI
        ref: "crates/apm2-cli/src/commands/"
        rationale: "apm2 coordinate command extends CLI"
