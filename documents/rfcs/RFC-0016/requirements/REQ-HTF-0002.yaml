requirement:
  id: REQ-HTF-0002
  title: "TimeEnvelope is mandatory on critical artifacts"
  status: ACTIVE

  statement: |
    All critical receipts/events include TimeEnvelopeV1, either embedded or
    referenced via time_envelope_ref. Each TimeEnvelope pins a governed
    ClockProfile by content hash.

  rationale: |
    Time must be auditable and replay-stable. By requiring envelopes on
    critical artifacts, the system can verify ordering/expiry decisions and
    reproduce metrics and audits from ledger+CAS.

  acceptance_criteria:
    - id: AC-HTF-0002-001
      description: "Critical events/receipts include TimeEnvelopeV1 (embedded or referenced)."
      verification: "Schema validation and admission checks reject missing envelopes."

    - id: AC-HTF-0002-002
      description: "TimeEnvelope pins ClockProfile by content hash."
      verification: "Envelope invariants enforce presence of clock_profile_hash."

    - id: AC-HTF-0002-003
      description: "Canonicalization vectors exist and are verified in CI for TimeEnvelopeV1 and ClockProfileV1."
      verification: "Conformance tests verify vectors against reference implementation."

  design_references:
    - "02_design_decisions.yaml#DD-HTF-0002"
    - "04_contracts_and_versioning.yaml#cac_schemas"

  test_references:
    - "07_test_and_evidence.yaml#Canonicalization"

  law_refs:
    - LAW-01
    - LAW-15
