requirement:
  schema_version: "2026-02-09"
  id: "REQ-0023"
  title: "AdmissionKernel plan/execute API with capability-gated effect surfaces and join-input assembly"
  category: "SECURITY"
  priority: "P0"
  status: "PROPOSED"
  statement: |
    An AdmissionKernel implementation MUST provide a plan/execute API that owns
    lifecycle ordering (join -> revalidate -> consume -> effect), PCAC join input
    assembly via canonical builder (including AdmissionSpineJoinExtV1 digest),
    revalidation reads, durable consume barrier, effect invocation through
    boundary mediation, and receipt emission.

    Authoritative effect surfaces MUST be capability-gated: EffectCapability,
    LedgerWriteCapability, and QuarantineCapability tokens MUST only be
    constructible by AdmissionKernel.

    AdmissionPlanV1 MUST be single-use, non-serializable across trust boundaries,
    and non-cloneable (or execute MUST enforce monotonic state transitions with
    durable guards).

    Witness seeds MUST be created by the daemon (not the client), bound to
    RequestId/session/tool_class/boundary_profile/LedgerAnchorV1/HT_start + nonce,
    and committed into the join extension.

    Ledger validated state and policy root MUST be resolved from authoritative
    sources and fail closed when missing for fail-closed tiers.

    Primary delivery ticket: TCK-00492.
  rationale: |
    The composition contract (§5 of ch19) requires all authoritative handlers to route
    through a single kernel API. Without capability gating, effect surfaces are bypassable
    by any code path with access to the broker/executor.
  acceptance_criteria:
    - "AdmissionKernel plan/execute API exists and enforces phase ordering A–Q."
    - "EffectCapability, LedgerWriteCapability, and QuarantineCapability are only constructible by AdmissionKernel."
    - "Join input assembly uses canonical builder with AdmissionSpineJoinExtV1."
    - "Witness seeds are daemon-created with provider provenance and committed into join extension."
    - "Fail-closed tiers deny on missing ledger state or policy root."
  evidence_ids:
    - "EVID-0018"
  source_refs:
    - "documents/rfcs/RFC-0019/19_admission_spine_v1_1_pcac_boundaries.md"
