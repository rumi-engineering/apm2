requirement:
  schema_version: "2026-02-09"
  id: "REQ-0024"
  title: "Admission evidence closure: seal AdmissionBundleV1 before receipt/event emission with no digest cycles"
  category: "SECURITY"
  priority: "P0"
  status: "PROPOSED"
  statement: |
    AdmissionKernel MUST emit a single CAS-stored AdmissionBundleV1 object that is sealed
    BEFORE emitting authoritative receipts/events that reference it.

    AdmissionBundleV1 MUST NOT include hashes/ids of receipts/events that are only created
    after the bundle is sealed (digest-cycle avoidance).

    Discovery of "what receipts/events were emitted" MUST be supported by querying for
    receipts/events that carry the bundle digest (reverse edge).

    If a forward index is required, it MUST be a separate object (e.g., AdmissionOutcomeIndexV1)
    emitted after receipts/events, referencing the already-sealed bundle digest.

    Bundle content MUST include at minimum: session + HSI envelope binding digests,
    authoritative policy-root digest + provenance, AJC id and join/consume selector digests,
    intent digest and consume-time intent digest, witness seed hashes + post-effect witness
    evidence hashes, effect digest, quarantine actions, and HT/HE anchors.

    AdmissionBundleV1 MUST be bounded (size limits), deny unknown fields, and stored
    with access control consistent with RFC-0019 evidence handling.

    Primary delivery ticket: TCK-00493.
  rationale: |
    Without a single sealed bundle, evidence closure requires matching multiple artifacts
    across receipts and events — a pattern that has repeatedly regressed (missing one hash
    field). Digest-cycle avoidance prevents ordering traps where bundle depends on receipt
    ids that depend on bundle.
  acceptance_criteria:
    - "AdmissionBundleV1 is sealed before authoritative receipt/event emission."
    - "No digest cycle exists between bundle and receipts/events."
    - "Bundle includes all normative fields from ch19 §8.2."
    - "Bundle is bounded, deny_unknown_fields, and stored with appropriate access control."
    - "Reverse-edge discovery works for receipt/event to bundle correlation."
  evidence_ids:
    - "EVID-0019"
  source_refs:
    - "documents/rfcs/RFC-0019/19_admission_spine_v1_1_pcac_boundaries.md"
