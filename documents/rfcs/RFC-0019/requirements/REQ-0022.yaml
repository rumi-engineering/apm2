requirement:
  schema_version: "2026-02-09"
  id: "REQ-0022"
  title: "Admission Spine v1.1 composition contract (PCAC-boundary + ledger trust-stack + anti-rollback anchoring)"
  category: "SECURITY"
  priority: "P0"
  status: "PROPOSED"
  statement: |
    RFC-0019 addendum (chapter 19) MUST define the Admission Spine v1.1 composition contract
    binding PCAC/AJC authority lifecycle, boundary-flow witnesses, ledger trust stack,
    quarantine containment, and anti-rollback anchoring into a single enforceable composition
    contract with no-bypass rules.

    The addendum MUST resolve the following structural traps:
    - Witness-hash ordering trap: witness binding MUST be split into seed-at-join (pre-effect)
      and evidence-post-effect, with witness provider provenance bound into seeds.
    - AdmissionBundle digest-cycle trap: bundle MUST be sealed before receipt/event emission;
      reverse-edge discovery MUST replace forward references.
    - Quarantine reservation contradiction: quarantine capacity MUST be reserved via a
      consume-adjacent durable guard before effect execution for fail-closed tiers.
    - Rollback-by-local-write: fail-closed tiers MUST require an external anti-rollback anchor
      and MUST deny when the anchor is unavailable or inconsistent.

    The addendum MUST define normative terminology, threat model (14 threat categories),
    versioning/migration rules, and phase ordering (Aâ€“Q) for AdmissionKernel.

    The addendum MUST define Appendix A kernel-facing interfaces (AntiRollbackAnchor,
    BoundaryMediator, LedgerTrustVerifier, PolicyRootResolver, WitnessProvider, AdmissionKernel).

    Placeholder requirement and evidence artifact stubs MUST exist for all subsequent
    implementation tickets (TCK-00492 through TCK-00502).

    Primary delivery ticket: TCK-00491.
  rationale: |
    As PCAC surfaces expand into a universal admission spine, composition rules must be explicit,
    mechanically enforceable, and reviewable. Without a single binding contract, cross-RFC
    interactions produce monolithic PRs and reviewer failure cycles. This requirement makes the
    composition contract the single enforceable source of truth.
  acceptance_criteria:
    - "Addendum is mergeable: clear normative MUST/SHOULD statements, explicit phase ordering, and no-bypass rules."
    - "Addendum explicitly resolves the witness-hash ordering trap and the AdmissionBundle digest-cycle trap."
    - "Addendum explicitly resolves rollback claims via anti-rollback anchoring requirements for fail-closed tiers."
    - "Requirements REQ-0022 through REQ-0030 and evidence artifacts EVID-0017 through EVID-0025 exist and are referenced by later tickets."
  evidence_ids:
    - "EVID-0017"
  source_refs:
    - "documents/rfcs/RFC-0019/19_admission_spine_v1_1_pcac_boundaries.md"
    - "documents/rfcs/RFC-0019/17_pcac_implementation_contract_snapshot.md"
    - "documents/rfcs/RFC-0019/18_fac_vnext_cross_rfc_traceability_matrix.md"
