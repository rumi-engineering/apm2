requirement:
  schema_version: "2026-02-09"
  id: "REQ-0018"
  title: "Deterministic ContextPack recipe compilation and drift fingerprinting"
  category: "NON_FUNCTIONAL"
  priority: "P0"
  status: "PROPOSED"
  statement: |
    FAC RoleSpec execution MUST compile deterministic ContextPack recipes from hash-pinned
    selector inputs and emit drift fingerprints binding role_spec_hash, required-read digest set,
    context_pack_manifest_hash, and budget profile.

    Context reconstruction from receipts MUST be possible without ambient filesystem assumptions.

    Primary delivery ticket: TCK-00447.
  rationale: |
    Deterministic context is the core efficiency and correctness lever; ambiguous or ambient
    context injection causes unreplayable outcomes and authority drift.
  acceptance_criteria:
    - "Context recipe compilation is deterministic for fixed hash inputs."
    - "Run receipts include context recipe digest and role hash bindings."
    - "Drift fingerprints are queryable and comparable across runs for the same WorkObject."
    - "Context rebuild from ledger/CAS artifacts succeeds for replay scenarios."
  evidence_ids:
    - "EVID-0013"
    - "EVID-0014"
  source_refs:
    - "documents/rfcs/RFC-0019/17_pcac_implementation_contract_snapshot.md"
    - "documents/rfcs/RFC-0019/18_fac_vnext_cross_rfc_traceability_matrix.md"
