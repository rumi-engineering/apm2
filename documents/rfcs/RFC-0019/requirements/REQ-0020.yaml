requirement:
  schema_version: "2026-02-09"
  id: "REQ-0020"
  title: "CAC snapshot contract registry schema qualification"
  category: "SECURITY"
  priority: "P0"
  status: "PROPOSED"
  statement: |
    RFC-0019 chapter 17 snapshot contract surfaces MUST be represented as schema-qualified
    object registry rows with canonicalizer tuple, digest bindings, compatibility state, and
    deterministic validation ordering.

    Tier2+ unresolved CAC ambiguity MUST force deny/freeze escalation bounded by adjudication windows.

    Primary delivery ticket: TCK-00439.
  rationale: |
    Object-name-only contract references are insufficient for promotion-critical traceability;
    schema and canonicalization bindings are required for replayable, fail-closed verification.
  acceptance_criteria:
    - "Chapter 17 registry rows include schema_id, schema_major, stable_id, digest, and canonicalizer tuple fields."
    - "Validation order is explicit: schema -> canonicalizer -> signature/freshness -> digest completeness -> predicate."
    - "CAC defect classes include unresolved schema/canonicalizer, digest mismatch/incomplete, stale input, and validation-order violations."
    - "Tier2+ unresolved CAC ambiguity yields deny/freeze with bounded escalation policy."
  evidence_ids:
    - "EVID-0010"
    - "EVID-0013"
  source_refs:
    - "documents/rfcs/RFC-0019/17_pcac_implementation_contract_snapshot.md"
    - "documents/rfcs/RFC-0019/18_fac_vnext_cross_rfc_traceability_matrix.md"
