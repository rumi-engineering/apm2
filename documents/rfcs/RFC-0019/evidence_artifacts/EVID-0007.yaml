evidence_artifact:
  schema_version: "2026-01-23"
  id: "EVID-0007"
  title: "xtask authority reduction evidence"
  category: "INTEGRATION_TEST_RESULT"
  status: "APPROVED"
  description: |
    Evidence that xtask has --emit-receipt-only mode,
    requires explicit flags for GitHub writes,
    and uses projection worker by default.

    TCK-00324 Implementation Summary:
    1. Added --emit-receipt-only flag to `xtask push` and `xtask review` commands.
    2. Implemented `check_status_write_with_flags` in `xtask/src/util.rs` to enforce fail-closed status write gating.
    3. Added `emit_projection_request_receipt` to emit internal receipts when direct writes are disabled.
    4. Enforced strict precedence: HEF Projection > CLI Flags > Env Vars > Default.
    5. Added unit tests in `xtask/src/util.rs` verifying flag precedence and environment variable handling.
  requirement_ids:
    - "REQ-0007"
  source_refs:
    - "xtask/src/util.rs"
    - "xtask/src/main.rs"
    - "xtask/src/tasks/push.rs"
    - "xtask/src/tasks/review.rs"
  artifacts:
    - type: "unit_test"
      path: "xtask/src/util.rs"
      description: "Unit tests `test_check_status_write_allowed_emit_receipt_only` and `test_check_status_write_with_flags_cli_overrides_env` verifying logic."
    - type: "implementation"
      path: "xtask/src/main.rs"
      description: "CLI argument parsing for --emit-receipt-only and --allow-github-write."
    - type: "implementation"
      path: "xtask/src/util.rs"
      description: "Core logic for check_status_write_with_flags and emit_projection_request_receipt."