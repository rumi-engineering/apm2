evidence_artifact:
  schema_version: "2026-01-23"
  id: "EVID-0013"
  title: "Deterministic RoleSpec/context recipe reconstruction evidence"
  category: "INTEGRATION_TEST_RESULT"
  status: "COMPLETE"
  description: |
    Evidence that RoleSpec vNext and ContextPack recipe lineage is deterministic
    and reconstructable from receipt-bound hashes without ambient filesystem
    assumptions.

    Coverage includes repeated recipe compilation consistency and
    reconstruction of `ContextPackRecipe` from CAS-hash-bound drift
    fingerprints.
  requirement_ids:
    - "REQ-0017"
    - "REQ-0018"
  source_refs:
    - "documents/rfcs/RFC-0019/requirements/REQ-0017.yaml"
    - "documents/rfcs/RFC-0019/requirements/REQ-0018.yaml"
    - "crates/apm2-daemon/tests/tck_00437_rolespec_vnext.rs"
  artifacts:
    - type: "integration_test"
      path: "crates/apm2-daemon/tests/tck_00437_rolespec_vnext.rs"
      description: |
        Deterministic recipe checks (`compiled_a == compiled_b`) and
        `reconstruct_from_receipts` verification in
        `tck_00437_rolespec_vnext_hash_lineage_and_spawn_binding`.
    - type: "implementation"
      path: "crates/apm2-daemon/src/protocol/dispatch.rs"
      description: |
        Deterministic policy lineage helpers:
        `build_policy_context_pack_recipe`,
        `policy_context_pack_recipe_hash`, and
        `seed_policy_artifacts_in_cas`.
    - type: "implementation"
      path: "crates/apm2-core/src/context/recipe.rs"
      description: |
        Context recipe and drift fingerprint model with
        fail-closed `reconstruct_from_receipts` for replay-oriented
        context reconstruction.
