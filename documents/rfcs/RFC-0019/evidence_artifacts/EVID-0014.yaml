evidence_artifact:
  schema_version: "2026-01-23"
  id: "EVID-0014"
  title: "Production role/context lineage fail-closed evidence"
  category: "INTEGRATION_TEST_RESULT"
  status: "COMPLETE"
  description: |
    Evidence that production WorkObject spawn paths fail closed for
    role/context ambiguity and lineage breaks, while admitting valid
    deterministic lineage.

    Coverage includes:
    - ambiguous role profile hash mismatch denial,
    - stale context recipe hash mismatch denial,
    - missing lineage hash-chain denial.
  requirement_ids:
    - "REQ-0018"
    - "REQ-0019"
  source_refs:
    - "documents/rfcs/RFC-0019/requirements/REQ-0018.yaml"
    - "documents/rfcs/RFC-0019/requirements/REQ-0019.yaml"
    - "crates/apm2-daemon/tests/tck_00437_rolespec_vnext.rs"
  artifacts:
    - type: "integration_test"
      path: "crates/apm2-daemon/tests/tck_00437_rolespec_vnext.rs"
      description: |
        `tck_00437_rolespec_vnext_spawn_fails_closed_on_role_context_ambiguity`
        validates fail-closed denial semantics with no session/ledger mutation
        side effects under lineage ambiguity.
    - type: "integration_test"
      path: "crates/apm2-daemon/tests/tck_00437_rolespec_vnext.rs"
      description: |
        `tck_00437_rolespec_vnext_claim_work_lineage_fields_are_populated`
        validates that claim-time lineage hashes are populated and consistent
        with deterministic derivation.
    - type: "implementation"
      path: "crates/apm2-daemon/src/protocol/dispatch.rs"
      description: |
        Authoritative spawn-path enforcement via
        `validate_claim_authority_context_lineage` and fail-closed deny
        response mapping for authority-context faults.
