rfc_requirement:
  schema_version: "2026-02-09"
  template_version: "2026-01-23"
  id: "REQ-HEF-0020"
  type: "SECURITY"
  title: "Trusted-context workflow orchestration and preflight authorization"
  statement: |
    GitHub FAC projection MUST execute in a trusted workflow context with explicit
    preflight authorization checks before any self-hosted review dispatch.

    Authorization MUST deny by default for unsupported actor association classes and
    for ambiguous base-ref trust conditions.

    Primary delivery ticket: TCK-00442.
  acceptance_criteria:
    - "Preflight authorization executes on GitHub-hosted infrastructure before self-hosted dispatch."
    - "Unauthorized actor association or ambiguous trust context blocks dispatch with terminal failure."
    - "Workflow code path for authoritative projection uses trusted base-branch semantics."
    - "Authorization and trust decisions are receipted and visible in workflow logs."
  evidence:
    evidence_ids:
      - "EVID-HEF-0017"
    inherited_from_prd: false
    notes: []
