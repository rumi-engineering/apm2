requirement:
  id: DCS-REQ-0013
  title: "Membership Admission Hardening"
  imported_from: null
  status: ACTIVE

  statement: |
    Join attempts MUST be rate-limited and require a bootstrap credential signed
    by the validator quorum to prevent join/leave abuse.

  rationale: |
    Rate limits prevent resource exhaustion; signed invitation tokens establish
    identity and reduce Sybil-adjacent attacks.

  acceptance_criteria:
    - id: AC-001
      description: "Join attempts rate-limited per source IP or identity"
      verification: "Rate limiter rejects after N attempts"
    - id: AC-002
      description: "Joining node presents invitation token signed by T1 quorum"
      verification: "Token signature verifies against quorum public key"
    - id: AC-003
      description: "Invalid or missing token rejects membership"
      verification: "Join fails without valid token"
    - id: AC-004
      description: "Tokens are single-use"
      verification: "Second join attempt with same token is rejected"
    - id: AC-005
      description: "Tokens expire within configurable window (default 24h)"
      verification: "Join fails if token timestamp older than expiration window"
    - id: AC-006
      description: "Tokens bound to joining node public key"
      verification: "Token includes node public key; mismatch rejects join"

  design_references:
    - "03_trust_boundaries.yaml#TB-0003"

  test_references:
    - "07_test_and_evidence.yaml#TEST-MA-001"
    - "07_test_and_evidence.yaml#TEST-MA-002"
    - "07_test_and_evidence.yaml#TEST-MA-003"
    - "07_test_and_evidence.yaml#TEST-MA-004"
