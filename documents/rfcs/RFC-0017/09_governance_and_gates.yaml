rfc_governance_and_gates:
  schema_version: "2026-01-30"
  template_version: "2026-01-23"

  governance:
    authority_signoffs:
      - authority: AUTH_ARCHITECTURE
        status: PENDING
        signoff_date: null
        conditions: []

      - authority: AUTH_SECURITY
        status: PENDING
        signoff_date: null
        conditions:
          - "Adversarial tests ADV-001 through ADV-007 pass"
          - "Peer credential validation tested in container environments"
          - "Context firewall deny+terminate verified"

      - authority: AUTH_RELIABILITY
        status: PENDING
        signoff_date: null
        conditions:
          - "Daemon crash recovery within 5s verified"
          - "Latency benchmarks meet requirements"

      - authority: AUTH_PRODUCT
        status: PENDING
        signoff_date: null
        conditions:
          - "CLI migration path documented"
          - "xtask deprecation timeline approved"

    custody_domains:
      - domain: DOMAIN_DAEMON
        owner: "apm2-daemon team"
        responsibilities:
          - "IPC handler implementation"
          - "Session manager implementation"
          - "Tool broker implementation"

      - domain: DOMAIN_KERNEL
        owner: "apm2-core team"
        responsibilities:
          - "Event signing infrastructure"
          - "Capability manifest schema"
          - "Governance integration"

      - domain: DOMAIN_EXECUTION
        owner: "Runtime team"
        responsibilities:
          - "Episode spawner implementation"
          - "Sandbox setup"
          - "Process lifecycle management"

      - domain: DOMAIN_SECURITY
        owner: "Security team"
        responsibilities:
          - "Security review of IPC authentication"
          - "Adversarial test verification"
          - "Container deployment guidance"

  gates:
    phase_gates:
      - phase_id: PHASE-1
        gate_id: GATE-PHASE1-SECURITY
        description: "Security foundation verification"
        criteria:
          - "ADV-001, ADV-002, ADV-005 pass"
          - "Unit tests for IPC authentication pass"
          - "Integration test for privilege separation passes"
        required_signoffs: [AUTH_SECURITY]

      - phase_id: PHASE-2
        gate_id: GATE-PHASE2-FAC
        description: "FAC lease enforcement verification"
        criteria:
          - "ADV-004, ADV-006 pass"
          - "Integration test with FAC events passes"
        required_signoffs: [AUTH_ARCHITECTURE, AUTH_SECURITY]

      - phase_id: PHASE-3
        gate_id: GATE-PHASE3-ISOLATION
        description: "Session isolation verification"
        criteria:
          - "ADV-003 passes"
          - "No credential access in session verified"
          - "Context firewall latency <100ms"
        required_signoffs: [AUTH_SECURITY]

      - phase_id: PHASE-4
        gate_id: GATE-PHASE4-CLI
        description: "CLI migration readiness"
        criteria:
          - "All CLI commands functional via daemon IPC"
          - "Help text documents migration"
        required_signoffs: [AUTH_PRODUCT]

      - phase_id: PHASE-5
        gate_id: GATE-PHASE5-DEPRECATION
        description: "xtask deprecation complete"
        criteria:
          - "Telemetry shows <5% xtask direct usage"
          - "ADV-008 passes"
        required_signoffs: [AUTH_PRODUCT]

    rfc_review_gates:
      - gate_id: GATE-TCK-SCHEMA
        type: TRUSTED
        status: PENDING
        description: "All RFC YAML files parse correctly"

      - gate_id: GATE-TCK-DEPENDENCY-ACYCLICITY
        type: DETERMINISTIC
        status: PENDING
        description: "Ticket dependencies form DAG (no cycles)"

      - gate_id: GATE-TCK-SCOPE-COVERAGE
        type: DETERMINISTIC
        status: PENDING
        description: "All PRD requirements covered by tickets"

      - gate_id: GATE-TCK-CCP-MAPPING
        type: DETERMINISTIC
        status: PENDING
        description: "All file paths exist in CCP or marked as new"

      - gate_id: GATE-TCK-ATOMICITY
        type: LLM-ASSISTED
        status: PENDING
        description: "Each ticket is single-PR completable"

      - gate_id: GATE-TCK-IMPLEMENTABILITY
        type: LLM-ASSISTED
        status: PENDING
        description: "Agent can implement without ambiguity"

      - gate_id: GATE-TCK-SECURITY-AND-INTEGRITY
        type: LLM-ASSISTED
        status: PENDING
        description: "Trust boundaries and threats properly documented"

      - gate_id: GATE-TCK-REQUIREMENT-FIDELITY
        type: LLM-ASSISTED
        status: PENDING
        description: "RFC requirements faithful to PRD"

      - gate_id: GATE-TCK-ANTI-COUSIN
        type: LLM-ASSISTED
        status: PENDING
        description: "No cousin abstractions; reuses existing patterns"

  version_progression:
    current_version: "v4"
    current_phase: "Standard"

    progression_rules:
      - from_version: "v0"
        to_version: "v2"
        mode: EXPLORE
        requirements:
          - "All REQUIRES_EXPLORATION questions resolved"
          - "Design decisions grounded in codebase evidence"
          - "GATE-TCK-CCP-MAPPING passes"

      - from_version: "v2"
        to_version: "v4"
        mode: FINALIZE
        requirements:
          - "All open questions RESOLVED or explicitly DEFERRED"
          - "All 9 gates pass (APPROVED or APPROVED_WITH_REMEDIATION)"

      - from_version: "v4"
        to_version: "Tickets"
        mode: DECOMPOSE
        requirements:
          - "06_ticket_decomposition.yaml populated"
          - "GATE-TCK-ATOMICITY and GATE-TCK-IMPLEMENTABILITY pass for each ticket"
          - "apm2 factory tickets emit succeeds"

  review_history:
    reviews:
      - review_id: COUNCIL-RFC-0017-20260130-EXPLORE
        date: "2026-01-30"
        phase_transition: "v0 -> v2"
        mode: EXPLORE
        verdict: APPROVED
        verdict_reason: |
          All 7 primary open questions (OQ-001 through OQ-007) resolved with
          codebase evidence. Protocol decision (DD-008) made. Anti-cousin
          analysis complete.
        findings_count: 1
        blockers_resolved: 0

      - review_id: COUNCIL-RFC-0017-20260130-FINALIZE
        date: "2026-01-30"
        phase_transition: "v2 -> v4"
        mode: FINALIZE
        verdict: APPROVED_WITH_REMEDIATION
        verdict_reason: |
          RFC-0017 FINALIZE Council completed with 3-agent deliberation.
          18 total findings (0 BLOCKER, 7 MAJOR, 9 MINOR, 3 INFO).
          All MAJOR findings remediated in-session:
          - OQ-008, OQ-009, OQ-010 status formalized
          - ADV-009, ADV-010, ADV-011 added for threat coverage
          - Proto message specification delegated to ticket scope

          Remaining items are documentation refinements, not architectural gaps.
        subagent_summary:
          SA-1:
            role: "Structural Rigorist"
            modes: [4, 30, 40, 49, 57]
            findings: 5
            artifact: "Explanatory Scoring Table"
            overall_readiness: READY
          SA-2:
            role: "Implementation Feasibility"
            modes: [26, 29, 30, 31, 48]
            findings: 7
            artifact: "Mock Implementation Run Report"
            overall_feasibility: NEEDS_CLARIFICATION
            note: "Clarifications provided in ticket scope refinements"
          SA-3:
            role: "Security & Anti-Cousin Guardian"
            modes: [12, 26, 60, 61, 62]
            findings: 6
            artifact: "CAE Tree"
            anti_cousin_verdict: COMPLIANT
            overall_assurance: NEEDS_WORK
            note: "Assurance improved by adding ADV-009, ADV-010, ADV-011"
        findings_count: 18
        blockers_resolved: 0
        major_remediated: 7

        council_metadata:
          session_id: "COUNCIL-RFC-0017-20260130-FINALIZE"
          cycles_completed: 1
          quorum_achieved: true
          elapsed_time_seconds: "~600"
