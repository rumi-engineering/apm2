rfc_meta:
  schema_version: "2026-01-27"
  template_version: "2026-01-27"
  rfc:
    id: RFC-0011
    title: "Context-as-Code (CAC) v1: Canonical Context Pipeline for the APM2 Holonic Kernel"
    version: v4
    status: APPROVED
    created_date: "2026-01-27"
    last_updated_date: "2026-01-27"
    council_session: COUNCIL-RFC-0011-20260127-FINALIZE
    phase_transition: "v2 (Grounded) -> v4 (Standard)"
  binds_to_prd:
    prd_id: PRD-0007
    prd_base_path: "documents/prds/PRD-0007"
    requirement_registry_ref: "documents/prds/PRD-0007/requirements/"
    evidence_bundle_ref: "documents/prds/PRD-0007/12_evidence_bundle.yaml"
    prd_meta_ref: "documents/prds/PRD-0007/00_meta.yaml"
    rationale: |
      RFC v4 (Standard) for PRD-0007: Context-as-Code (CAC) v1 specification.
      CAC makes context the authoritative program in an agent-native factory, providing
      a canonical context substrate, patch-first authoring, hermetic consumption, and
      target interoperability through compiled payloads. Council FINALIZE session resolved
      all open questions and approved transition to v4 with ticket decomposition ready.
  protocol_profile:
    id: NONE
    applies: false
    inherited_from_prd: true
    profile_ref: "documents/prds/PRD-0007/00_meta.yaml#protocol_profile"
  custody:
    producing_agent_roles:
      - AGENT_AUTHOR
      - AGENT_REVIEWER
      - AGENT_ARCHITECT
    responsible_domains:
      - DOMAIN_KERNEL
      - DOMAIN_COMPILER
      - DOMAIN_POLICY
      - DOMAIN_TOOLING
      - DOMAIN_AGENT_RUNTIME
      - DOMAIN_SECURITY
    authority_signoffs_required:
      - AUTH_PRODUCT
      - AUTH_SECURITY
      - AUTH_ARCHITECTURE
  refs:
    standards:
      requirement_schema: "standards/schemas/02_requirement.schema.yaml#requirement_schema"
      evidence_artifact_schema: "standards/schemas/01_evidence_artifact.schema.yaml#evidence_artifact_schema"
      quality_coverage_schema: "standards/schemas/03_quality_coverage.schema.yaml#quality_coverage_schema"
      gate_review_schema: "standards/schemas/06_gate_review.schema.yaml#gate_review_schema"
      waiver_schema: "standards/schemas/05_waiver.schema.yaml#waiver_schema"
      ticket_meta_schema: "standards/schemas/04_ticket_meta.schema.yaml#ticket_meta_schema"
      lint_spec: "standards/lint/LINT_SPEC.yaml#lint_spec"
    ccp_index: "evidence/prd/PRD-0007/ccp/ccp_index.json"
    impact_map: "evidence/prd/PRD-0007/impact_map/impact_map.yaml"
  implementation:
    language: Rust
    edition: "2021"
    primary_crates:
      - apm2-core
      - apm2-cli
      - apm2-holon
    implementation_approach: |
      CAC v1 introduces a canonical context pipeline for the APM2 holonic kernel.
      Implementation spans multiple phases:

      Phase 1 - Foundations: CAC-JSON canonicalizer and validator
      Phase 2 - Admission: Patch engine with replay protection
      Phase 3 - Fetch: DCP stable-ID resolution and ArtifactFetch tool
      Phase 4 - Packs: ContextPack compiler with deep-pinning
      Phase 5 - Delivery: Target profile compilation and exports
      Phase 6 - Gating: CapabilityManifest and AAT/selftest pipeline

      All state transitions recorded as signed kernel messages with hash references.
    key_dependencies:
      - name: serde_json
        purpose: "JSON parsing and serialization"
      - name: jsonschema
        purpose: "JSON Schema validation (draft 2020-12)"
      - name: blake3
        purpose: "BLAKE3-256 content-addressed hashing"
      - name: json-patch
        purpose: "JSON Patch (RFC 6902) and Merge Patch (RFC 7396)"
