rfc_governance_and_gates:
  schema_version: "2026-02-10"

  governance_overview:
    description: |
      RFC-0028 governs promotion-critical external I/O security conformance over
      RFC-0027 lifecycle semantics, with explicit fail-closed gate behavior.
    authority_requirements:
      - authority: "AUTH_ARCHITECTURE"
        scope:
          - "Security profile formal model and predicate contracts"
          - "Cross-RFC ownership boundary integrity"
          - "CAC schema/gate binding structure"
      - authority: "AUTH_SECURITY"
        scope:
          - "Threat model, containment policy, and defect handling"
          - "Temporal ambiguity fail-closed posture"
          - "Projection isolation and compromise containment guarantees"
    dominance_order: "containment/security > verification/correctness > liveness/progress"

  gates:
    - id: "GATE-SIO28-SNAPSHOT"
      name: "PCAC snapshot validity"
      type: "DETERMINISTIC"
      purpose: "Blocks on snapshot drift."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "snapshot_digest covers all required digests and canonicalizer_id/version"
      evidence_required:
        - "RFC-0028::EVID-0001"
        - "RFC-0028::EVID-0006"
      cac_inputs:
        - kind: "snapshot.report"
          schema: "apm2.pcac_snapshot_report.v1"
          binding_rule: "snapshot_digest MUST cover all required object digests and carry canonicalizer_id/canonicalizer_version"

    - id: "GATE-SIO28-TIME-AUTHORITY"
      name: "Shared temporal authority contracts"
      type: "DETERMINISTIC"
      purpose: "Enforces shared temporal contracts TP-EIO29-001 and TP-EIO29-008 with deny-on-ambiguity."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "time_authority_envelope_valid is true"
        - "promotion_temporal_ambiguity == false"
        - "Temporal disagreement/arbitration receipts are digest-bound to evaluated predicate bundle"
      evidence_required:
        - "RFC-0028::EVID-0002"
      cac_inputs:
        - kind: "time.envelope"
          schema: "apm2.time_authority_envelope.v1"
          binding_rule: "contract_digest_set MUST include envelope digest"
        - kind: "temporal.evaluator"
          schema: "apm2.temporal_predicate_evaluator.v1"
          binding_rule: "contract_digest_set MUST include evaluator digest"
        - kind: "temporal.disagreement.receipt"
          schema: "apm2.temporal_disagreement_receipt.v1"
          binding_rule: "Receipt MUST be digest-bound to the same predicate bundle and canonicalizer tuple"
        - kind: "temporal.arbitration.receipt"
          schema: "apm2.temporal_arbitration_receipt.v1"
          binding_rule: "Receipt MUST be digest-bound to the same predicate bundle and canonicalizer tuple"

    - id: "GATE-SIO28-LIFECYCLE"
      name: "Lifecycle predicate closure"
      type: "DETERMINISTIC"
      purpose: "Blocks on lifecycle predicate failure."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "join/revalidate/consume/effect lifecycle predicates all pass"
        - "Lifecycle receipt digest set is complete and coherently canonicalized"
      evidence_required:
        - "RFC-0028::EVID-0001"
      cac_inputs:
        - kind: "authority.kernel.decision"
          schema: "apm2.authority_kernel_decision.v1"
          binding_rule: "lifecycle receipt digest set MUST bind join/revalidate/consume/effect receipts to one canonicalizer tuple"

    - id: "GATE-SIO28-DELEGATION-MEET-EXACTNESS"
      name: "Delegation exact meet"
      type: "DETERMINISTIC"
      purpose: "Blocks on meet mismatch, verifier disagreement, or unsatisfiable delegation output."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "Delegation output equals deterministic exact meet(parent, overlay)"
        - "Satisfiability proof demonstrates non-empty admissible workset"
      evidence_required:
        - "RFC-0028::EVID-0003"
      cac_inputs:
        - kind: "delegation.meet.receipt"
          schema: "apm2.delegation_meet_computation_receipt.v1"
          binding_rule: "meet input/output digests MUST be verifier-recomputable under identical canonicalization vectors"
        - kind: "delegation.satisfiability.receipt"
          schema: "apm2.delegation_satisfiability_receipt.v1"
          binding_rule: "receipt MUST prove non-empty admissible workset"

    - id: "GATE-SIO28-CONSUME"
      name: "Consume integrity"
      type: "DETERMINISTIC"
      purpose: "Blocks on intent mismatch, duplicate consume, or prerequisite bypass."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "consume.intent_digest equals effect.intent_digest"
        - "single-consume invariant is preserved"
      evidence_required:
        - "RFC-0028::EVID-0003"
      cac_inputs:
        - kind: "authority.kernel.decision"
          schema: "apm2.authority_kernel_decision.v1"
          binding_rule: "consume digest MUST equal effect intent digest in the same contract_digest_set"

    - id: "GATE-SIO28-REVOCATION"
      name: "Revocation dominance"
      type: "DETERMINISTIC"
      purpose: "Blocks on stale/revoked authority acceptance; allows only constrained authority-reduction fallback when full envelope validity is unavailable."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "Revocation frontier is fresh for referenced HTF window"
        - "Fallback path (if used) is stop/revoke-only and denies authority expansion"
      evidence_required:
        - "RFC-0028::EVID-0002"
      cac_inputs:
        - kind: "time.envelope"
          schema: "apm2.time_authority_envelope.v1"
          binding_rule: "revocation checks must bind to referenced temporal window"
        - kind: "revocation.frontier.snapshot"
          schema: "apm2.revocation_frontier_snapshot.v1"
          binding_rule: "revocation frontier digest MUST be fresh for referenced HTF window"
        - kind: "local.time.emergency.receipt"
          optional: true
          schema: "apm2.local_monotonic_emergency_time_receipt.v1"
          binding_rule: "required only when full envelope validity is unavailable; fallback is admissible only for authority-reduction stop/revoke actions"

    - id: "GATE-SIO28-EFFECT"
      name: "Effect acceptance-fact completeness"
      type: "DETERMINISTIC"
      purpose: "Blocks on acceptance-fact incompleteness."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "Acceptance-fact digest set is complete"
        - "Missing digest entry denies"
      evidence_required:
        - "RFC-0028::EVID-0005"
      cac_inputs:
        - kind: "authority.kernel.decision"
          schema: "apm2.authority_kernel_decision.v1"
          binding_rule: "acceptance-fact digest set MUST be complete; missing digest entry denies"

    - id: "GATE-SIO28-BOUNDARY-FLOW"
      name: "Boundary flow admissibility"
      type: "DETERMINISTIC"
      purpose: "Blocks on capability/taint/classification/declassification failures."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "boundary_admit predicate is true"
        - "Policy digest coheres with admitted root and canonicalizer tuple"
      evidence_required:
        - "RFC-0028::EVID-0004"
      cac_inputs:
        - kind: "boundary.flow.policy"
          schema: "apm2.boundary_flow_policy.v1"
          binding_rule: "flow policy digest MUST match admitted policy root digest and canonicalizer tuple"

    - id: "GATE-SIO28-PROJECTION-NONINTERFERENCE"
      name: "Projection noninterference"
      type: "DETERMINISTIC"
      purpose: "Blocks on authoritative trace divergence under equivalent authoritative inputs."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "Projected and authoritative traces remain equivalent under identical authoritative inputs"
      evidence_required:
        - "RFC-0028::EVID-0008"
      cac_inputs:
        - kind: "projection.diff.proof"
          schema: "apm2.projection_diff_proof.v1"
          binding_rule: "projected and authoritative trace digests MUST be computed from the same canonicalizer vectors"

    - id: "GATE-SIO28-VERIFIER-INDEPENDENCE"
      name: "Verifier independence"
      type: "DETERMINISTIC"
      purpose: "Blocks on unacceptable shared-failure dependency correlation."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "Verifier dependency graph and correlation thresholds satisfy independence policy"
      evidence_required:
        - "RFC-0028::EVID-0006"
      cac_inputs:
        - kind: "verifier.independence.profile"
          schema: "apm2.verifier_independence_profile.v1"
          binding_rule: "independence profile digest MUST bind dependency graph hash and correlation thresholds"

    - id: "GATE-SIO28-TRADE-SECRET"
      name: "Disclosure-control trade-secret interlock"
      type: "DETERMINISTIC"
      purpose: "Blocks on trade-secret control regression."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "Active policy epoch remains admissible for trade-secret control"
        - "Policy regression or stale state denies"
      evidence_required:
        - "RFC-0028::EVID-0007"
      cac_inputs:
        - kind: "trade.secret.policy"
          schema: "apm2.trade_secret_policy_profile.v1"
          binding_rule: "trade-secret policy digest MUST match active policy epoch root"

    - id: "GATE-SIO28-PROJECTION-ISOLATION"
      name: "Projection isolation"
      type: "DETERMINISTIC"
      purpose: "Blocks on direct GitHub authority reintroduction."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "Production agent_runtime excludes direct GitHub capability classes"
        - "Policy and capability-surface digests cohere"
      evidence_required:
        - "RFC-0028::EVID-0008"
      cac_inputs:
        - kind: "projection.isolation.policy"
          schema: "apm2.projection_isolation_policy.v1"
          binding_rule: "capability-surface digest and policy digest MUST cohere under one canonicalizer tuple"

    - id: "GATE-SIO28-PROJECTION-COMPROMISE-CONTAINMENT"
      name: "Projection compromise containment"
      type: "DETERMINISTIC"
      purpose: "Blocks on missing or invalid compromise containment evidence."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "Compromise signal is digest-linked to trust-root and sink-identity snapshots"
        - "Compromised channels are quarantined while authoritative flow continuity is preserved"
      evidence_required:
        - "RFC-0028::EVID-0009"
      cac_inputs:
        - kind: "projection.compromise.signal"
          schema: "apm2.projection_compromise_signal.v1"
          binding_rule: "compromise signal digest MUST chain to trust snapshot digest and sink identity digest"
        - kind: "source.trust.snapshot"
          schema: "apm2.source_trust_snapshot.v1"
          binding_rule: "Trust-root snapshot MUST match authoritative CAS+ledger source"
        - kind: "sink.identity.snapshot"
          schema: "apm2.sink_identity_snapshot.v1"
          binding_rule: "Sink identity snapshot MUST validate endpoint/key binding and transition continuity"

    - id: "GATE-SIO28-CRYPTO-AGILITY"
      name: "Crypto agility and downgrade resistance"
      type: "DETERMINISTIC"
      purpose: "Blocks on algorithm downgrade risk or stale key-epoch policy."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "Algorithm allowlist and keyset are valid for active policy epoch"
      evidence_required:
        - "RFC-0028::EVID-0006"
      cac_inputs:
        - kind: "crypto.agility.policy"
          schema: "apm2.crypto_agility_policy.v1"
          binding_rule: "algorithm allowlist digest and keyset digest MUST match active epoch under current time authority envelope"

    - id: "GATE-SIO28-POST-COMPROMISE-RECOVERY"
      name: "Post-compromise recovery completeness"
      type: "DETERMINISTIC"
      purpose: "Blocks on incomplete re-proof after key compromise."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "Recovery receipt proves re-sealed roots and replay coverage"
      evidence_required:
        - "RFC-0028::EVID-0009"
      cac_inputs:
        - kind: "post_compromise.recovery.receipt"
          schema: "apm2.post_compromise_recovery_receipt.v1"
          binding_rule: "recovery receipt digest MUST prove re-sealed roots and replay coverage for affected windows"
        - kind: "source.trust.snapshot"
          schema: "apm2.source_trust_snapshot.v1"
          binding_rule: "source trust snapshot MUST align with recovered trust root"

    - id: "GATE-SIO28-OPERATOR-SAFETY"
      name: "Operator safety controls"
      type: "DETERMINISTIC"
      purpose: "Blocks on unresolved operator-error class findings for promotion-critical paths."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "UI authority-field constraints and policy diff approvals are present and valid"
      evidence_required:
        - "RFC-0028::EVID-0006"
      cac_inputs:
        - kind: "operator.safety.guard"
          schema: "apm2.operator_safety_guard_profile.v1"
          binding_rule: "safety guard digest MUST bind UI authority-field constraints and policy diff approvals"

    - id: "GATE-SIO28-EVIDENCE-QUALITY"
      name: "Evidence quality and freshness"
      type: "DETERMINISTIC"
      purpose: "Blocks on insufficient statistical power, reproducibility, or evidence freshness."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "Evidence quality profile and freshness SLA are current for promoted evidence class"
      evidence_required:
        - "RFC-0028::EVID-0006"
      cac_inputs:
        - kind: "evidence.quality.profile"
          schema: "apm2.evidence_quality_profile.v1"
          binding_rule: "statistical power digest MUST be current for promoted evidence class"
        - kind: "evidence.freshness.sla"
          schema: "apm2.evidence_freshness_sla.v1"
          binding_rule: "freshness SLA digest MUST be current for promoted evidence class"

    - id: "GATE-SIO28-SEMANTIC-DRIFT"
      name: "Semantic drift non-promotable classes"
      type: "DETERMINISTIC"
      purpose: "Blocks on SEMANTIC_RISKY or AMBIGUOUS cross-RFC drift."
      applies_to: "RFC-0028 security profile"
      pass_criteria:
        - "Semantic diff class is not SEMANTIC_RISKY and not AMBIGUOUS"
      evidence_required:
        - "RFC-0028::EVID-0006"
      cac_inputs:
        - kind: "semantic.diff.report"
          schema: "apm2.semantic_diff_report.v1"
          binding_rule: "semantic diff digest MUST be signed and canonicalized with active vectors before gate evaluation"

  cac_validation_and_defect_handling:
    validation_order:
      - "Resolve schema (schema_id, schema_major) from CAC registry."
      - "Verify canonicalizer tuple compatibility (canonicalizer_id, canonicalizer_version, canonicalizer_vectors_ref)."
      - "Verify signature set and HTF freshness binding."
      - "Verify contract_digest_set completeness and digest equality constraints."
      - "Execute gate predicate logic."
    defect_classes:
      - "CAC_SCHEMA_UNRESOLVED"
      - "CAC_SCHEMA_VERSION_INCOMPATIBLE"
      - "CAC_CANONICALIZER_UNRESOLVED"
      - "CAC_CANONICALIZER_VECTOR_MISMATCH"
      - "CAC_DIGEST_SET_INCOMPLETE"
      - "CAC_DIGEST_MISMATCH"
      - "CAC_SIGNATURE_INVALID"
      - "CAC_INPUT_STALE"
      - "CAC_VALIDATION_ORDER_VIOLATION"
    tier_behavior:
      tier0_tier1: "Deny gate and emit cac.defect_record.v1."
      tier2_plus: "Deny gate, transition to S3 fail-closed freeze, and block promotion until adjudication finishes before cac_adjudication_deadline_window_ref; missed deadline escalates to S4 emergency halt."

  theory_lineage:
    rows:
      - contract_surface: "Authority continuity and proof-carrying effects"
        law_anchors:
          - "LAW-01"
          - "LAW-15"
          - "LAW-20"
        principle_anchors:
          - "PRIN-092"
          - "PRIN-105"
      - contract_surface: "Dual-axis containment and projection isolation"
        law_anchors:
          - "LAW-05"
          - "LAW-16"
        principle_anchors:
          - "PRIN-100"
          - "PRIN-107"
      - contract_surface: "Revocation and split-brain handling"
        law_anchors:
          - "LAW-10"
          - "LAW-18"
        principle_anchors:
          - "PRIN-049"
          - "PRIN-124"
      - contract_surface: "Temporal fail-closed posture"
        law_anchors:
          - "LAW-09"
          - "LAW-15"
        principle_anchors:
          - "PRIN-108"
          - "PRIN-122"
      - contract_surface: "Verifier independence"
        law_anchors:
          - "LAW-14"
          - "LAW-17"
        principle_anchors:
          - "PRIN-094"
          - "PRIN-121"
      - contract_surface: "Trade-secret interlock"
        law_anchors:
          - "LAW-05"
          - "LAW-14"
          - "LAW-15"
        principle_anchors:
          - "PRIN-106"

  traceability:
    laws_alignment:
      - law_id: "LAW-01"
        role: "Proof-carrying authority continuity and receipted promotion gates."
      - law_id: "LAW-05"
        role: "Dual-axis containment and projection isolation constraints."
      - law_id: "LAW-09"
        role: "Temporal pinning/freshness and deny-on-ambiguity posture."
      - law_id: "LAW-10"
        role: "Revocation merge semantics under partition and split-brain conditions."
      - law_id: "LAW-14"
        role: "Risk-weighted evidence sufficiency and verifier independence economics."
      - law_id: "LAW-15"
        role: "Measurement integrity via deterministic digest-bound evidence and freshness gates."
      - law_id: "LAW-16"
        role: "Boundary contracts and composition closure across lifecycle, security, and projection planes."
      - law_id: "LAW-17"
        role: "Independent verifier posture to reduce shared-failure correlations."
      - law_id: "LAW-18"
        role: "Revocation latency and propagation dominance under federation uncertainty."
      - law_id: "LAW-20"
        role: "Deterministic reverification path for portable acceptance claims."
