requirement:
  schema_version: "2026-02-09"
  id: "REQ-0008"
  title: "Direct projection-sink authority elimination for agent runtimes (GitHub profile default)"
  category: "SECURITY"
  priority: "P0"
  status: "PROPOSED"
  statement: |
    Production FAC agent runtimes MUST NOT carry direct actuation authority for
    external projection sinks. External projection, when required, MUST execute
    only through an isolated projection worker using receipt-bound projection
    intents derived from internal authoritative state.

    This profile binding is explicitly for GitHub projection surfaces and
    corresponding capability classes (`github_api`, `gh_cli`,
    `forge_org_admin`, `forge_repo_admin`).

    Decommission policy:
    - Stage 0: non-production compatibility only.
    - Stage 1: production deny-by-default, explicit break-glass only.
    - Stage 2: hard deny for all production direct GitHub actuation by agent runtimes.
    Unknown, stale, missing, or ambiguous stage state MUST fail closed to Stage 2 deny.
  rationale: |
    Direct GitHub authority in agent runtimes creates a high-impact blast
    radius (org settings mutation, guardrail removal, destructive admin
    actions) that is disproportionate to FAC evaluation requirements.
  acceptance_criteria:
    - "Production RoleSpec capability surfaces exclude github_api/gh_cli/admin classes."
    - "All admissible GitHub projections are receipt-linked to projection_worker execution."
    - "Any direct gh/GitHub API attempt from agent_runtime is denied with structured security defects."
    - "Stage-state ambiguity fails closed to hard deny behavior."
  imported_dependencies:
    - "RFC-0020::REQ-0029"
    - "RFC-0020::REQ-0030"
    - "RFC-0027::REQ-0009"
    - "RFC-0019::REQ-0007"
  evidence_ids:
    - "EVID-0008"
