rfc_risks_and_open_questions:
  schema_version: "2026-01-29"

  # CRITICAL: This file lists all "Known Unknowns" for v0 (Discovery) phase
  # These must be resolved or explicitly deferred during EXPLORE (v2) and FINALIZE (v4) phases

  risks:
    - id: RSK-RFC-FAC-0001
      statement: "Context firewall adoption friction causes agent failures during transition"
      impact: |
        Agents accustomed to broad file access fail frequently under OCAP containment;
        perceived as regression blocking productivity.
      likelihood: HIGH
      mitigations:
        - "Graduated rollout with warn-only phase before hard enforcement"
        - "Treat context misses as compiler defects; prioritize pack completeness fixes"
        - "Provide clear error messages with ContextRefinementRequest guidance"
        - "Monitor CONTEXT_MISS and CONTEXT_FIREWALL_DENY defect rates"
      related_prd_risk: RSK-FAC-0001
      status: ACCEPTED

    - id: RSK-RFC-FAC-0002
      statement: "Projection divergence false positives cause unnecessary factory freezes"
      impact: |
        Legitimate external changes (admin hotfixes) trigger PROJECTION_DIVERGENCE and
        InterventionFreeze, blocking all admissions until manual recovery.
      likelihood: MEDIUM
      mitigations:
        - "Document expected divergence scenarios and pre-authorize via emergency override"
        - "Implement grace period and re-check before triggering freeze"
        - "Provide expedited AdjudicationRequested(EMERGENCY_RECOVERY) path"
      related_prd_risk: RSK-FAC-0002
      status: ACCEPTED

    - id: RSK-RFC-FAC-0003
      statement: "Key management complexity leads to operational failures"
      impact: |
        Ed25519 key rotation, custody grouping, and COI enforcement add operational burden;
        misconfiguration could allow unauthorized signing or block legitimate actors.
      likelihood: MEDIUM
      mitigations:
        - "Define clear KeyPolicy artifact under CAC governance"
        - "Automate key rotation with KeyRotated event chain-of-custody"
        - "Provide tooling to audit key bindings and custody domains"
      related_prd_risk: RSK-FAC-0003
      status: ACCEPTED

    - id: RSK-RFC-FAC-0004
      statement: "AAT evidence binding increases implementation complexity"
      impact: |
        Transcript chain hashing, artifact manifest hashing, and attestation binding add significant
        implementation complexity and potential for validation bugs.
      likelihood: MEDIUM
      mitigations:
        - "Use chunked hashing with streaming digests"
        - "Define clear schema validation at each stage"
        - "Extensive property-based testing for evidence invariants"
      related_prd_risk: RSK-FAC-0008
      status: ACCEPTED

    - id: RSK-RFC-FAC-0005
      statement: "Terminal verifier policy drift causes false PASS or blocking"
      impact: |
        If verifier predicates become lax, AAT becomes spoofable; if too strict,
        AAT blocks safe refactors.
      likelihood: MEDIUM
      mitigations:
        - "Version verifier policies with policy_hash"
        - "Use holdout suites to detect false negatives (Phase 2)"
        - "Require invariants-first specs"
      related_prd_risk: RSK-FAC-0009
      status: ACCEPTED

  open_questions:
    # These are "Known Unknowns" that must be resolved during EXPLORE and FINALIZE phases

    - id: Q-RFC-FAC-0001
      question: |
        Canonical proto placement for new gate/projection/intervention events:
        extend kernel_events.proto with GateEvent and ProjectionEvent payloads
        vs create new fac_events.proto?
      decision_needed_by: "v2 (EXPLORE phase)"
      resolution_plan: |
        During EXPLORE phase, examine existing proto structure in proto/kernel_events.proto
        and determine if extension is feasible without breaking existing event handling.
        Prefer typed payload extension if existing event families support it.
      status: RESOLVED
      resolution: |
        EXTEND kernel_events.proto. Council SA-1 analysis confirmed proto uses oneof payload
        pattern with 8 existing event families. GateLease extends LeaseEvent oneof (tag 6);
        GateRunCompleted and MergeReceipt extend EvidenceEvent oneof (tags 3, 4).
        Evidence: proto/kernel_events.proto:43-54 shows extensible structure.
        Creating fac_events.proto would create architectural asymmetry and add maintenance burden.
      resolved_by: COUNCIL-RFC-0015-EXPLORE-20260129
      resolved_date: "2026-01-29"
      confidence: HIGH
      blocking_tickets:
        - TG-FAC-001
      related_prd_question: Q-FAC-0001

    - id: Q-RFC-FAC-0002
      question: |
        Context firewall integration point: daemon protocol layer or core library?
        Should the firewall be in apm2-daemon/src/protocol/ or apm2-core/src/context/?
      decision_needed_by: "v2 (EXPLORE phase)"
      resolution_plan: |
        During EXPLORE phase, examine existing tool mediation path and determine where
        ContextPackManifest allowlist checking can be most cleanly integrated.
      status: RESOLVED
      resolution: |
        CORE LIBRARY via ContextAwareValidator middleware at tool validation layer.
        Council SA-2 analysis evaluated 3 options:
        - Option A (Protocol Layer): Single point but couples layers - 0.65 probability
        - Option B (Tool Handlers): Late binding, scattered logic - 0.45 probability
        - Option C (Validator Middleware): Non-breaking, composable, testable - 0.75 probability

        Selected Option C: Create ContextAwareValidator trait in crates/apm2-core/src/tool/
        that wraps existing Validator with manifest checking. Integration point:
        crates/apm2-core/src/tool/mod.rs:66-75. Emit ToolDecided=DENY with rule_id
        "CTX-ALLOWLIST-001" on manifest miss.
      resolved_by: COUNCIL-RFC-0015-EXPLORE-20260129
      resolved_date: "2026-01-29"
      confidence: HIGH
      blocking_tickets:
        - TG-FAC-002

    - id: Q-RFC-FAC-0003
      question: |
        Formal COI grouping policy and KeyPolicy artifact definition:
        How should custody domains be defined and validated?
      decision_needed_by: "v2 (EXPLORE phase)"
      resolution_plan: |
        During EXPLORE phase, examine existing KeyManager implementation and define
        KeyPolicy schema with custody domain grouping. Implement COI validation in
        lease issuance path.
      status: RESOLVED
      resolution: |
        DEFINE KeyPolicy artifact with custody domain grouping (SA-1 FINALIZE).

        KeyPolicy schema includes:
        - policy_id, policy_hash
        - custody_domains with key_bindings and coi_group_id
        - coi_rules with enforcement at LEASE_ISSUANCE or ADMISSION
        - delegation_rules for cross-domain scope allowances

        Validation path:
        1. KeyPolicy committed under CAC governance
        2. Lease issuance checks: executor_key.coi_group_id != author.coi_group_id
        3. UNAUTHORIZED_EXECUTOR on COI violation
        4. Waiver via AdjudicationRequested(WAIVER) with bounded scope
        Reference: FAC-CONTRACT-008
      resolved_by: COUNCIL-RFC-0015-FINALIZE-20260129
      resolved_date: "2026-01-29"
      confidence: HIGH
      blocking_tickets:
        - TG-FAC-001
      related_prd_question: Q-FAC-0003

    - id: Q-RFC-FAC-0004
      question: |
        How to obtain stable runner image digests from hosted CI for L1+ attestation?
        May require self-hosted runners for full attestation.
      decision_needed_by: "v4 (FINALIZE phase)"
      resolution_plan: |
        Survey hosted CI providers for environment attestation capabilities.
        Document self-hosted runner requirements for L1+. Define fallback policy
        for hosted runners with explicit attestation level documentation.
      status: DEFERRED
      resolution: |
        DEFER to Phase 2 for L2/L3; Phase 1 requires L1 minimum for CI-gated transitions.

        Phase 1 Policy:
        - L0 attestation is insufficient for readiness gating
        - CI_EVENTS_ENABLED remains fail-closed by default; enable only when L1 evidence is available
        - For hosted runners without L1, require manual re-run in controlled environment

        Phase 2 Resolution Plan:
        - Survey hosted CI providers for environment attestation APIs
        - Define self-hosted runner requirements for L2/L3
        - Create migration path from L1 -> L2/L3

        Rationale: Hosted CI provider landscape is evolving. Requiring L1 for gated transitions
        keeps admission fail-closed while allowing controlled environments to proceed.
      resolved_by: COUNCIL-RFC-0015-FINALIZE-20260129
      resolved_date: "2026-01-29"
      confidence: MEDIUM
      blocking_tickets:
        - TG-FAC-004
      related_prd_question: Q-FAC-0004

    - id: Q-RFC-FAC-0005
      question: |
        AAT transcript schema: should we use existing TranscriptChunk from CAC
        or define new FAC-specific transcript types?
      decision_needed_by: "v2 (EXPLORE phase)"
      resolution_plan: |
        During EXPLORE phase, examine existing transcript handling in PRD-0007 CAC
        implementation and determine if existing types can be reused or extended.
      status: RESOLVED
      resolution: |
        REUSE TranscriptChunk from CAC module with FAC-specific wrapper.
        Council SA-2 analysis confirmed CAC module already handles transcript chunking
        with streaming hashing. Create AATTranscriptBinding wrapper:
        ```rust
        pub struct AATTranscriptBinding {
            pub transcript_chunks: Vec<TranscriptChunk>,  // Imported from CAC
            pub transcript_chain_root_hash: Hash,
            pub run_transcript_hashes: Vec<Hash>,
        }
        ```
        Reuse rate >= 80% from existing crates/apm2-core/src/cac/pack_spec.rs.
        Avoids duplication, maintains PRD-0007 conformance.
      resolved_by: COUNCIL-RFC-0015-EXPLORE-20260129
      resolved_date: "2026-01-29"
      confidence: MEDIUM
      blocking_tickets:
        - TG-FAC-005

    - id: Q-RFC-FAC-0006
      question: |
        Determinism envelope run count by risk tier: what is N for stability checks
        by risk tier, and when should deterministic enforcement expand beyond AAT?
      decision_needed_by: "v4 (FINALIZE phase)"
      resolution_plan: |
        Start with N=3 for AAT in T3 (HIGH risk); evaluate throughput impact and expand
        to other gates only after stability and cost metrics meet targets.
      status: RESOLVED
      resolution: |
        DEFINE determinism envelope run count (N) by risk tier (SA-1 FINALIZE):

        | Risk Tier | N (Run Count) | Rationale |
        |-----------|---------------|-----------|
        | HIGH      | 3             | Full stability check; latency acceptable for security |
        | MED       | 2             | Reduced stability check; balance throughput and safety |
        | LOW       | 1             | No stability check; nightly full AAT provides coverage |

        Expansion Policy:
        - Phase 1: N-run envelope for AAT gates only (schema ships)
        - Phase 2: Enforcement enabled; expand to other gates if GATE_NONDETERMINISTIC >1%

        Flake Classification:
        - DETERMINISTIC_FAIL: verdict=FAIL with determinism_status=STABLE (not a mismatch)
        - HARNESS_FLAKE: Runner/infra nondeterminism
        - ENVIRONMENT_DRIFT: Toolchain/runner environment drift
        - TEST_NONSEMANTIC: Semantically equivalent but different format
        - CODE_NONSEMANTIC: Non-semantic diff due to tooling/formatting
        - UNKNOWN: Unclassified mismatch; needs input
      resolved_by: COUNCIL-RFC-0015-FINALIZE-20260129
      resolved_date: "2026-01-29"
      confidence: HIGH
      blocking_tickets:
        - TG-FAC-007
      related_prd_question: Q-FAC-0006

    - id: Q-RFC-FAC-0007
      question: |
        Risk tier classification model: which signals (diff scope, module criticality,
        policy profile) determine HIGH/MED/LOW for AAT selection?
      decision_needed_by: "v4 (FINALIZE phase)"
      resolution_plan: |
        Start with policy-defined critical domains (auth/crypto/ledger/tool mediation)
        and expand with impact expansion heuristics; revise based on escape-rate metrics.
      status: RESOLVED
      resolution: |
        DEFINE risk tier classification model (SA-1 FINALIZE):

        PRIMARY SIGNALS (Policy-Defined):
        - Module criticality: auth/*, crypto/*, ledger/*, tool/*, kernel/*
        - File patterns: *_secret*, *credentials*, *policy*
        - Impact domain: DOMAIN_SECURITY, DOMAIN_KERNEL

        SECONDARY SIGNALS (Impact-Derived):
        - Diff scope: >500 lines or >10 files -> raise tier
        - Dependency fanout: >20 transitive dependents -> raise tier
        - Test coverage delta: <0% coverage change on critical path -> raise tier

        CLASSIFICATION ALGORITHM:
        - touches_critical_module OR matches_sensitive_pattern -> HIGH
        - large_scope OR high_fanout -> MED
        - otherwise -> LOW

        TIER DEFINITIONS:
        - HIGH: Always requires AAT for all impacted modules
        - MED: Requires AAT for sensitive domains; sampled otherwise
        - LOW: 1-in-10 sampling + nightly full AAT on main

        ESCAPE METRICS: Track escapes by tier; >1% escape rate triggers review.
      resolved_by: COUNCIL-RFC-0015-FINALIZE-20260129
      resolved_date: "2026-01-29"
      confidence: MEDIUM
      blocking_tickets:
        - TG-FAC-006
      related_prd_question: Q-FAC-0008

    - id: Q-RFC-FAC-0008
      question: |
        Where should policy resolution be recorded (PolicyResolved event vs embedded
        in FAC-00 run receipt)?
      decision_needed_by: "v2 (EXPLORE phase)"
      resolution_plan: |
        During EXPLORE phase, examine existing policy handling and determine canonical
        location for resolved_policy_hash and policy tuple.
      status: RESOLVED
      resolution: |
        EMBEDDED in FAC-00 changeset ingestion event (ChangeSetIngested).
        SA-1 analysis: Policy resolution is part of FAC-00 stage outputs. Include
        resolved_policy_hash, resolved_risk_tier, resolved_determinism_class as
        fields in ChangeSetIngested event payload. This binds policy to changeset
        before any gate execution (CON-FAC-003: CAS-at-commit ordering).
        Evidence: Policy pinning follows DD-FAC-0009 anti-downgrade design.
      resolved_by: COUNCIL-RFC-0015-EXPLORE-20260129
      resolved_date: "2026-01-29"
      confidence: MEDIUM
      blocking_tickets:
        - TG-FAC-001
      related_prd_question: Q-FAC-0009

    - id: Q-RFC-FAC-0009
      question: |
        Should AAT reuse be allowed for LOW risk only, or for MED with explicit waiver?
      decision_needed_by: "v4 (FINALIZE phase)"
      resolution_plan: |
        Start with LOW-only reuse; expand based on cache integrity metrics and
        escape rate. MED reuse may require explicit waiver and audit.
      status: RESOLVED
      resolution: |
        ALLOW AAT reuse for LOW risk only; MED requires waiver (SA-1 FINALIZE):

        | Risk Tier | AAT Reuse | Conditions |
        |-----------|-----------|------------|
        | HIGH      | NEVER     | Always fresh AAT required |
        | MED       | WAIVER    | AdjudicationRequested(AAT_REUSE) with bounded HTF window (TIME_TBD) |
        | LOW       | ALLOWED   | Exact provenance tuple match required |

        PROVENANCE TUPLE:
        - changeset_digest (content hash)
        - view_commitment_hash
        - rcp_profile_id
        - verifier_policy_hash
        - determinism_class (must indicate deterministic class, e.g., class=0)

        REUSE EVENT: AATResultReused with original_receipt_id, provenance_tuple_hash
        CACHE INVALIDATION: Any verifier_policy_hash change invalidates all cached results
        REUSE WINDOW: HTF window (TIME_TBD) for LOW reuse (nightly AAT refreshes cache)

        WAIVER CEREMONY (MED): AdjudicationRequested -> AUTH_SECURITY approval -> HTF waiver window (TIME_TBD)
      resolved_by: COUNCIL-RFC-0015-FINALIZE-20260129
      resolved_date: "2026-01-29"
      confidence: HIGH
      blocking_tickets:
        - TG-FAC-008
      related_prd_question: Q-FAC-0010

    - id: Q-RFC-FAC-0010
      question: |
        GitHub branch protection contract: exact settings required to ensure external
        merge paths cannot bypass FAC admission?
      decision_needed_by: "v4 (FINALIZE phase)"
      resolution_plan: |
        Document required GitHub branch protection settings. Codify in adapter
        handshake and validate on startup. Define audit for administrator bypass.
      status: RESOLVED
      resolution: |
        DEFINE required GitHub branch protection settings (SA-1 FINALIZE):

        MANDATORY SETTINGS:
        - required_status_checks.strict: true (branch must be up to date)
        - required_status_checks.contexts: ["fac/admission"]
        - enforce_admins: true (admins cannot bypass)
        - restrictions.apps: ["fac-adapter"] (only FAC can merge)
        - allow_force_pushes: false
        - allow_deletions: false
        - required_linear_history: true

        ADAPTER HANDSHAKE:
        1. On startup, query GitHub API for branch protection
        2. Compare to required settings schema
        3. If mismatch: emit DefectRecord(BRANCH_PROTECTION_MISMATCH)
        4. If critical mismatch (allow_force_pushes=true): refuse to project

        ADMIN BYPASS AUDIT:
        - Monitor GitHub audit log for bypass events
        - Emit DefectRecord(ADMIN_BYPASS_DETECTED) on detection
        - Consider InterventionFreeze if bypass merges to protected branch
      resolved_by: COUNCIL-RFC-0015-FINALIZE-20260129
      resolved_date: "2026-01-29"
      confidence: HIGH
      blocking_tickets:
        - TG-FAC-003
      related_prd_question: Q-FAC-0005

  codebase_discovery_needs:
    # Specific codebase exploration needed during EXPLORE phase

    - id: DISCOVERY-FAC-0001
      area: "Proto Event Structure"
      question: "How are kernel events currently structured? Can we extend existing event families?"
      files_to_examine:
        - "proto/kernel_events.proto"
        - "crates/apm2-core/src/ledger/"
      affects_decisions:
        - DD-FAC-0001
        - DD-FAC-0002

    - id: DISCOVERY-FAC-0002
      area: "Tool Mediation Path"
      question: "Where is tool execution mediated? Where should context firewall integrate?"
      files_to_examine:
        - "crates/apm2-daemon/src/protocol/"
        - "crates/apm2-daemon/src/session/"
        - "crates/apm2-core/src/tool/"
      affects_decisions:
        - DD-FAC-0003

    - id: DISCOVERY-FAC-0003
      area: "Existing Signature Infrastructure"
      question: "How are signatures currently used? Can we reuse Ed25519 Signer?"
      files_to_examine:
        - "crates/apm2-core/src/crypto/sign.rs"
        - "crates/apm2-core/src/crypto/keys.rs"
      affects_decisions:
        - DD-FAC-0001

    - id: DISCOVERY-FAC-0004
      area: "Lease Implementation"
      question: "How are leases currently implemented? Can we extend for gate leases?"
      files_to_examine:
        - "crates/apm2-core/src/lease/"
        - "crates/apm2-daemon/src/session/"
      affects_decisions:
        - DD-FAC-0002

    - id: DISCOVERY-FAC-0005
      area: "GitHub Adapter"
      question: "How is GitHub integration currently implemented? Where is projection logic?"
      files_to_examine:
        - "crates/apm2-daemon/src/github/"
        - "crates/apm2-daemon/src/adapter/"
      affects_decisions:
        - DD-FAC-0004

    - id: DISCOVERY-FAC-0006
      area: "Context Pack Handling"
      question: "How are ContextPacks used? Where is manifest allowlist checked?"
      files_to_examine:
        - "crates/apm2-core/src/context/"
        - "crates/apm2-daemon/src/protocol/"
      affects_decisions:
        - DD-FAC-0003

    - id: DISCOVERY-FAC-0007
      area: "Transcript and Evidence"
      question: "How are transcripts and evidence currently handled? Can we extend for AAT?"
      files_to_examine:
        - "crates/apm2-core/src/evidence/"
        - "crates/apm2-core/src/transcript/"
      affects_decisions:
        - DD-FAC-0006
        - DD-FAC-0007

  council_discovered_findings:
    session_id: COUNCIL-RFC-0015-20260129-130000
    timestamp: "2026-01-29T13:00:00Z"
    verdict: APPROVED_WITH_REMEDIATION

    blocker_findings:
      - id: SA2-RFC0015-F001
        source_agent: SA-2
        source_mode: 11  # Bayesian
        title: "GateLease Schema Incompatible with Existing LeaseIssued Event"
        description: |
          RFC specifies GateLease with gate_id, changeset_digest, executor_actor_id, policy_hash
          and AAT extensions. Existing LeaseIssued has different fields. Bayesian probability
          of clean extension is ~0.25. Requires explicit proto placement decision.
        resolution_action: "Resolve Q-RFC-FAC-0001 as first EXPLORE task"
        blocks: [TG-FAC-001]

      - id: SA2-RFC0015-F002
        source_agent: SA-2
        source_mode: 44  # Means-End
        title: "OCAP Context Firewall Integration Point Unresolved"
        description: |
          No existing firewall infrastructure for content-hash validation at file read time.
          CapabilityManifest has OCAP patterns but scope differs from RCP manifest allowlist.
          Neither existing option provides clean path.
        resolution_action: "Resolve Q-RFC-FAC-0002 during EXPLORE"
        blocks: [TG-FAC-002]

      - id: F-SA3-008
        source_agent: SA-3
        source_mode: 65  # Deontic
        title: "Open Question Q-FAC-0003 Blocks COI Enforcement"
        description: |
          Formal COI grouping policy and KeyPolicy artifact definition not specified.
          The obligation "Executor must not be author" cannot be enforced without
          formal definition of how keys map to actors/COI groups.
        resolution_action: "Resolve Q-RFC-FAC-0003 before Phase 1 completion"
        blocks: [TG-FAC-001, TB-0007]

    major_security_findings:
      - id: F-SA3-001
        source_agent: SA-3
        source_mode: 8  # Counterexample-Guided
        title: "Lease Revocation Mechanism Not Specified"
        description: |
          If executor key is compromised mid-lease, there is no way to invalidate
          the lease before expiry. Adversary can issue valid GateRunCompleted.
        recommendation: "Add LeaseRevoked event type; enforce short HTF lease window (TIME_TBD)"
        phase_to_resolve: EXPLORE

      - id: F-SA3-002
        source_agent: SA-3
        source_mode: 49  # Robust/Worst-Case
        title: "Context Firewall WARN Mode Security Gap"
        description: |
          During FAC-R-01 (HTF WARN window; TIME_TBD), context violations logged but not enforced.
          Malicious agent can exfiltrate data during this window.
        recommendation: "Shorter WARN window via HTF (TIME_TBD); scope limitation for WARN mode"
        phase_to_resolve: FINALIZE

      - id: F-SA3-004
        source_agent: SA-3
        source_mode: 80  # Adversarial/Red-Team
        title: "Projection Read Path Enforcement Not Runtime-Verified"
        description: |
          TB-0003 enforcement is 'code architecture' only. Code modification could inject
          GitHub status reads without runtime detection.
        recommendation: "Add runtime policy enforcement; consider network-level isolation"
        phase_to_resolve: EXPLORE

      - id: F-SA3-012
        source_agent: SA-3
        source_mode: 80  # Adversarial/Red-Team
        title: "Adversary ADV-0005 (Insider) Not Modeled"
        description: |
          Threat model does not cover malicious insider with kernel or coordinator access.
          No compensating controls for insider threat documented.
        recommendation: "Add ADV-0005 to threat model; consider dual-control for kernel ops"
        phase_to_resolve: EXPLORE

    implementation_findings:
      - id: SA2-RFC0015-F003
        source_agent: SA-2
        source_mode: 53  # Heuristic
        title: "Terminal Verifier Enforcement Has No Existing Pattern"
        description: |
          No existing terminal verifier infrastructure. Requires entirely new:
          TerminalVerifier trait, VerifierPolicy schema, predicate evaluation engine.
        phase_to_resolve: EXPLORE

      - id: SA2-RFC0015-F005
        source_agent: SA-2
        source_mode: 29  # Supervaluationism
        title: "Domain Separator Prefix Format Underdetermined"
        description: |
          Multiple valid interpretations for domain separation: concat vs length-prefix.
          Without precise specification, independent implementations may diverge.
        recommendation: "Create domain_separator.rs module specification before implementation"
        phase_to_resolve: EXPLORE

    positive_findings:
      - id: SA1-RFC0015-v0-008
        source_agent: SA-1
        source_mode: 17  # Inductive Generalization
        title: "Protocol stages generalize well from existing patterns"
        assessment: "7 protocol stages (FAC-00 through FAC-06) follow established patterns"

      - id: SA1-RFC0015-v0-009
        source_agent: SA-1
        source_mode: 42  # Root Cause Analysis
        title: "All failure modes have explicit mitigations"
        assessment: "All 5 failure modes have corresponding solutions in design decisions"

    next_phase_guidance:
      phase: EXPLORE
      priority_order:
        - "P0: Resolve Q-RFC-FAC-0001 (proto placement) - blocks all ticket groups"
        - "P0: Resolve Q-RFC-FAC-0002 (context firewall integration)"
        - "P0: Resolve Q-RFC-FAC-0003 (COI grouping policy)"
        - "P1: Complete component mapping for all 21 requirements"
        - "P1: Add lease revocation mechanism to DD-FAC-0002"
        - "P1: Specify domain separator format precisely"
        - "P2: Add ADV-0005 (insider threat) to threat model"

  # ============================================================================
  # FINALIZE COUNCIL FINDINGS (v2 -> v4)
  # ============================================================================

  finalize_council_findings:
    session_id: COUNCIL-RFC-0015-FINALIZE-20260129
    timestamp: "2026-01-29T14:00:00Z"
    verdict: APPROVED_FOR_V4
    subagent: SA-1
    role: "Structural Rigorist"
    modes: [3, 16, 42, 58, 74]

    security_finding_resolutions:
      - finding_id: F-SA3-001
        title: "Lease Revocation Gap"
        resolution_status: RESOLVED
        resolution: |
          ADD LeaseRevoked event type to kernel_events.proto with lease_id,
          revoked_by, revoked_at (observational), reason, issuer_signature fields.
          SET HTF lease windows (TIME_TBD) for AAT-scoped leases and other gate leases.
          Revocation is immediate (no grace period).

      - finding_id: F-SA3-002
        title: "WARN Mode Security Gap"
        resolution_status: RESOLVED
        resolution: |
          SET FAC-R-01 WARN HTF window (TIME_TBD).
          ADD sensitive module exclusion: auth/*, crypto/*, ledger/* denied even in WARN.
          ADD rate limiting: Max 100 context misses per work_id before SOFT_FAIL escalation.

      - finding_id: F-SA3-004
        title: "Projection Read Path not runtime-verified"
        resolution_status: RESOLVED
        resolution: |
          IMPLEMENT runtime policy enforcement for TB-0003.
          OPTION A (RECOMMENDED): Network-level isolation via Kubernetes NetworkPolicy.
          OPTION B: Runtime policy hook in HTTP client blocking api.github.com.
          ADD integration test asserting admission cannot reach api.github.com.

      - finding_id: F-SA3-012
        title: "Insider Threat (ADV-0005) not modeled"
        resolution_status: RESOLVED
        resolution: |
          ADD ADV-0005 to threat model with attack vectors AV-0007/0008/0009.
          ADD SEC-CTRL-FAC-0009: Dual-control for kernel ops.
          ADD code review gate for kernel/*, crypto/* changes.
          ADD audit log with tamper-evident hash chain.

    decision_status_upgrades:
      - decision_id: DD-FAC-0004
        from_status: HYPOTHESIS
        to_status: VALIDATED
        conditions: ["F-SA3-004 runtime enforcement required"]

      - decision_id: DD-FAC-0005
        from_status: HYPOTHESIS
        to_status: VALIDATED
        conditions: ["Document attestation levels and minimum enforcement (L1+)"]

      - decision_id: DD-FAC-0006
        from_status: HYPOTHESIS
        to_status: VALIDATED
        conditions: []

      - decision_id: DD-FAC-0007
        from_status: HYPOTHESIS
        to_status: VALIDATED
        conditions: []

      - decision_id: DD-FAC-0008
        from_status: HYPOTHESIS
        to_status: VALIDATED
        conditions: []

      - decision_id: DD-FAC-0009
        from_status: HYPOTHESIS
        to_status: VALIDATED
        conditions: []

    remaining_gaps:
      blocking: []
      non_blocking:
        - gap_id: GAP-002
          title: "L1+ CI attestation requires self-hosted runners"
          deferred_to: Phase 2

        - gap_id: GAP-003
          title: "Determinism envelope enforcement"
          deferred_to: Phase 2

        - gap_id: GAP-004
          title: "HSM-backed key storage for T1 keys"
          deferred_to: Phase 2
      resolved_in_v4_1:
        - gap_id: GAP-001
          title: "TerminalVerifier trait and VerifierPolicy schema specified"
          resolution_ref: "FAC-CONTRACT-007"

    v4_approval_conditions:
      required:
        - "Update design decisions with validation evidence (DONE)"
        - "Update open questions with resolutions (DONE)"
        - "Add LeaseRevoked event to proto extension plan (DONE)"
        - "Add ADV-0005 to threat model in 03_trust_boundaries.yaml (DONE)"

      recommended:
        - "Add runtime policy enforcement for TB-0003"
        - "Document attestation levels and minimum enforcement (L1+)"
        - "Create integration test for admission network isolation"

    confidence_assessment:
      overall_v4_readiness: 0.85
      mean_decision_score: 4.08
      all_decisions_above_threshold: true

  # ============================================================================
  # SA-2 IMPLEMENTATION FEASIBILITY ANALYSIS (FINALIZE)
  # ============================================================================

  sa2_implementation_feasibility:
    session_id: COUNCIL-RFC-0015-FINALIZE-20260129
    timestamp: "2026-01-29T15:30:00Z"
    agent_id: SA-2
    role: "Implementation Feasibility"
    modes_applied:
      - 11  # Bayesian Reasoning
      - 39  # Counterfactual Reasoning
      - 47  # Planning/Policy Reasoning
      - 51  # Satisficing
      - 70  # Engineering Design

    artifact_reference: "documents/rfcs/RFC-0015/SA2_mock_implementation_run_report.yaml"

    executive_summary: |
      RFC-0015 FAC implementation is FEASIBLE with identified remediations.
      Applied 5-mode analysis across all 12 ticket groups using Bayesian probability
      updates, counterfactual path analysis, action sequence planning, satisficing
      constraints, and engineering trade-off evaluation.

      Key findings:
      - Implementation feasible with remediation of identified gaps.
      - Engineering estimates are intentionally omitted from this RFC artifact.

    component_feasibility_scores:
      - component: TG-FAC-001
        name: "Gate Event Infrastructure"
        feasibility: HIGH
        probability: 0.73

      - component: TG-FAC-002
        name: "OCAP Context Firewall"
        feasibility: MEDIUM
        probability: 0.66

      - component: TG-FAC-003
        name: "Projection Watchdog"
        feasibility: MEDIUM
        probability: 0.50

      - component: TG-FAC-004
        name: "CI Evidence Import"
        feasibility: MEDIUM
        probability: 0.60

      - component: TG-FAC-005
        name: "Typed AAT GateReceipt"
        feasibility: MEDIUM-HIGH
        probability: 0.67

      - component: TG-FAC-006
        name: "Risk-Tiered Selection"
        feasibility: MEDIUM
        probability: 0.53

      - component: TG-FAC-007
        name: "Determinism Envelope"
        feasibility: MEDIUM
        probability: 0.55
        phase: PHASE-2

      - component: TG-FAC-008
        name: "AAT Reuse"
        feasibility: MEDIUM
        probability: 0.60

      - component: TG-FAC-009
        name: "Quorum/Sandboxing"
        feasibility: MEDIUM
        probability: 0.55
        phase: PHASE-2

      - component: TG-FAC-010
        name: "Invariant Specs"
        feasibility: HIGH
        probability: 0.70

      - component: TG-FAC-011
        name: "Merge Receipt"
        feasibility: HIGH
        probability: 0.75

      - component: TG-FAC-012
        name: "Echo-Trap"
        feasibility: HIGH
        probability: 0.70

    critical_path:
      sequence: [TG-FAC-001, TG-FAC-005, TG-FAC-006, TG-FAC-007]

    parallelization_opportunities:
      - parallel_set_1:
          groups: [TG-FAC-002, TG-FAC-003, TG-FAC-004, TG-FAC-011, TG-FAC-012]
          parallel_with: TG-FAC-005
      - parallel_set_2:
          groups: [TG-FAC-008, TG-FAC-010]
          parallel_with: TG-FAC-006

    friction_points_summary:
      critical:
        - id: FB-001
          title: "Q-RFC-FAC-0003 COI Policy"
          status: RESOLVED_BY_FINALIZE

        - id: FB-002
          title: "Q-RFC-FAC-0007 Risk Tier Classification"
          status: RESOLVED_BY_FINALIZE

        - id: FB-003
          title: "Q-RFC-FAC-0006 Determinism N"
          status: RESOLVED_BY_FINALIZE

      major:
        - id: MF-001
          title: "Terminal Verifier Pattern Gap"
          status: DEFERRED_TO_V4
          mitigation: "Record outputs now; predicate engine in Phase 2"

        - id: MF-002
          title: "Domain Separator Format"
          status: SPEC_PROVIDED
          specification: "SPEC-FAC-001-A in artifact"

      minor:
        - id: LF-001
          title: "Q-RFC-FAC-0009 AAT Reuse Scope"
          status: RESOLVED_BY_FINALIZE

        - id: LF-002
          title: "Q-RFC-FAC-0010 Branch Protection"
          status: DEFERRED
          mitigation: "Document requirements; runtime verification Phase 2"

    go_no_go_recommendation:
      recommendation: GO_WITH_REMEDIATION
      confidence: 0.68

      required_conditions:
        - "Domain separator format documented (SPEC-FAC-001-A)"
        - "Manifest schema defined before TG-FAC-002"
        - "Terminal Verifier predicate engine deferred to Phase 2"

      success_factors:
        - "Weekly sync with CAC team on TranscriptChunk"
        - "Context miss rate monitoring (target <15%)"
        - "Escape rate tracking for risk tier calibration"
