{
  "schema": "cac.rfc_doc.v1",
  "schema_version": "1.0.0",
  "kind": "rfc.document",
  "meta": {
    "stable_id": "dcp://apm2.rfcs/RFC-0024@seed",
    "status": "SEED",
    "classification": "INTERNAL",
    "replaces": "documents/rfcs/RFC-0024/seed.md",
    "canonicalizer": {
      "canonicalizer_id": "apm2.canonicalizer.jcs",
      "canonicalizer_version": "1.0.0",
      "vectors_ref": "dcp://apm2.cac/canonicalizer/vectors@v1"
    },
    "provenance": {
      "actor_id": "HOLON-RFC-GOVERNANCE",
      "work_id": "TCK-00680-docs-overhaul"
    }
  },
  "payload": {
    "rfc_id": "RFC-0024",
    "title": "Autonomous Resource Provisioning",
    "seed_content": "# RFC-0024: Autonomous Resource Provisioning \u2014 Seed\n\n## Required context files\n\nRead all of these before generating output:\n\n- documents/theory/unified-theory-v2.json\n- documents/theory/unified-theory-v2.json\n- documents/theory/unified-theory-v2.json\n- documents/theory/unified-theory-v2.json\n- documents/strategy/MASTER_STRATEGY.json\n- documents/strategy/BUSINESS_PLAN.json\n- documents/rfcs/RFC-0020/HOLONIC_SUBSTRATE_INTERFACE.md\n- documents/rfcs/RFC-0022/PRINCIPAL_SOVEREIGNTY_INTERFACE.md\n- documents/rfcs/RFC-0023/INSTRUCTION_LIFECYCLE.md\n- proto/kernel_events.proto\n\n## Why this RFC matters\n\nWhen a new holon enters the system \u2014 whether it's a fresh agent spawned to fix a bug or an entire organizational branch joining the holarchy \u2014 it needs resources: identity, capabilities, budgets, context, trust. Today's cloud provisioning models are built around implicit trust and coarse-grained IAM policies. This RFC must invent a provisioning protocol native to holonic recursion: trust bootstrap that composes, capability delegation that narrows monotonically, resource envelopes that respect physical cost floors, and teardown that preserves evidence while revoking authority atomically. The hard problem is making this work at arbitrary nesting depth without the provisioning overhead exploding.\n\n## Priority innovation vectors\n\n- **Trust bootstrap as a protocol**: formalize the trust establishment handshake using ideas from key exchange protocols, capability bootstrapping, and verifiable delay functions for rate-limiting Sybil attacks.\n- **Recursive provisioning**: provisioning a holon that itself provisions sub-holons, with capability narrowing composed transitively \u2014 draw from the authority lattice in RFC-0020.\n- **Resource topology awareness**: budget allocation that accounts for physical locality, network topology, and data gravity rather than treating resources as fungible.\n- **Deprovisioning as first-class evidence**: teardown that produces a signed receipt proving all capabilities were revoked, all state was archived, and no dangling references remain.\n- **Identity at scale**: self-certifying identities with O(log n) verification for 10^12 holons using Merkle-based directory commitments.\n\n## Problem (PHY-04, PHY-08, INV-F-05)\n\nThe unified theory defines MECH-RELAY-HOLON, MECH-FEDERATION, MECH-HOLON-MESH-PROTOCOL, and MECH-HOLON-DIRECTORY. HSI \u00a72 specifies federation with cells, relays, and anti-entropy with Byzantine stance. HSI \u00a78 defines HolonIdV1, CellIdV1, HolonCertificate, CellCertificate. HSI \u00a710 stages S7/S7.5/S8 cover federation read-only through relay holons.\n\nBut there is no normative protocol for bootstrapping trust on a new machine, provisioning it as a functioning holon, delegating capabilities to it, managing its resource budget, or securely tearing it down. The system can theoretically federate, but it cannot grow. This RFC bridges the gap between \"federation exists\" and \"the system can assimilate a new compute node and make it do useful work.\"\n\nThis is critical for BSP_26 (INFRASTRUCTURE_SOVEREIGNTY) \u2014 the system must provision its own infrastructure rather than depending on cloud provider managed services.\n\n## What already exists\n\n| Artifact | Provides | Gap |\n|---|---|---|\n| HSI \u00a72 Federation model | Cells, relays, anti-entropy | No trust bootstrap, no provisioning workflow |\n| HolonIdV1, CellIdV1 | Self-certifying identities | No attestation of the physical machine's integrity |\n| HolonCertificate, CellCertificate | Certificate types defined | No issuance protocol |\n| CapabilityManifestV1 (HSI \u00a73) | Capability delegation framework | Not applied to machine provisioning |\n| MECH-HOLON-DIRECTORY | Directory concept | No synchronization protocol for provisioned machines |\n| BSP_26 | Infrastructure sovereignty axiom | No operational binding |\n| BSP_28 | Capital constraint ($180k) | No cost modeling for provisioning |\n| apm2d_runtime_v1.proto SpawnEpisode | Spawn mechanism | Spawns episodes, not machines |\n\n## Machine-checkable objectives\n\n**OBJ-ARP-01**: Trust bootstrap is bilateral: A new machine must prove its integrity to the existing system AND the system must prove its authority to the new machine. Unilateral trust is forbidden.\n- Predicate: `\u2200 provision: \u2203 (machine_attestation, system_authority_proof): both.verified = true`\n\n**OBJ-ARP-02**: Capability inheritance follows OCAP: A provisioned holon's capabilities must be a strict subset of the provisioning holon's capabilities. No capability amplification during delegation.\n- Predicate: `\u2200 child_holon: child_holon.capabilities \u2282 parent_holon.capabilities`\n\n**OBJ-ARP-03**: Resource budgets are bounded and metered: Every provisioned holon must have explicit compute, storage, network, and cost budgets. Budget exhaustion triggers graceful teardown, not crash.\n- Predicate: `\u2200 holon: holon.budget.remaining \u2265 0 \u2228 holon.state = TEARDOWN`\n\n**OBJ-ARP-04**: Teardown is evidence-preserving: Deprovisioning a holon must first replicate all ledger entries and evidence to a surviving cell. Loss of evidence is an S0 defect.\n- Predicate: `\u2200 teardown: pre_teardown_evidence \u2286 surviving_cells.evidence`\n\n**OBJ-ARP-05**: Provisioning is idempotent: Re-running the provisioning protocol on an already-provisioned machine must produce the same result (INV-F-06). Partial provisioning failures must be resumable.\n- Predicate: `\u2200 machine: provision(provision(machine)) = provision(machine)`\n\n**OBJ-ARP-06**: Jurisdiction compliance: No machine may be provisioned in an excluded jurisdiction (BSP_27). IP geolocation alone is insufficient; the provisioning protocol must verify physical hosting location through provider attestation.\n- Predicate: `\u2200 machine: machine.jurisdiction \u2209 {CCP, RU, DPRK, US_EXEC} \u2227 jurisdiction.attestation.verified = true`\n\n## Protocol objects (seed schemas)\n\nThese are starting points \u2014 refine, extend, or restructure as your analysis requires.\n\n```\nMachineAttestationV1 {\n    machine_id: PublicKeyIdV1,\n    platform_report: PlatformReportV1,\n    tpm_quote: Option<TpmQuoteV1>,\n    jurisdiction_attestation: JurisdictionAttestationV1,\n    network_addresses: Vec<NetworkAddress>,\n    resource_capacity: ResourceCapacityV1,\n    attestation_seal: AuthoritySealV1,\n}\n\nProvisioningRequestV1 {\n    requesting_holon: HolonIdV1,\n    machine_attestation: MachineAttestationV1,\n    requested_role: HolonRole,\n    requested_capabilities: CapabilityManifestV1,\n    resource_budget: ResourceBudgetV1,\n    principal_authorization: AuthoritySealV1,\n}\n\nProvisioningReceiptV1 {\n    request_digest: CasDigest,\n    assigned_holon_id: HolonIdV1,\n    assigned_cell_id: CellIdV1,\n    issued_certificate: HolonCertificate,\n    capability_manifest: CapabilityManifestV1,\n    resource_budget: ResourceBudgetV1,\n    parent_holon: HolonIdV1,\n    provisioned_at: TimeEnvelopeRef,\n    principal_seal: AuthoritySealV1,\n}\n\nResourceBudgetV1 {\n    compute_cpu_seconds: Quantity,\n    compute_gpu_seconds: Quantity,\n    storage_bytes: Quantity,\n    network_egress_bytes: Quantity,\n    cost_usd_cents: Quantity,\n    valid_until: TimeEnvelopeRef,\n    on_exhaustion: ExhaustionPolicy,\n}\n\nResourceMeteringEventV1 {\n    holon_id: HolonIdV1,\n    epoch: TimeEnvelopeRef,\n    consumed: ResourceBudgetV1,\n    remaining: ResourceBudgetV1,\n    metering_seal: AuthoritySealV1,\n}\n\nTeardownRequestV1 {\n    holon_id: HolonIdV1,\n    reason: TeardownReason,\n    evidence_replication_target: CellIdV1,\n    principal_seal: Option<AuthoritySealV1>,\n}\n\nTeardownReceiptV1 {\n    holon_id: HolonIdV1,\n    evidence_replicated: bool,\n    evidence_digest: CasDigest,\n    resources_released: ResourceBudgetV1,\n    torn_down_at: TimeEnvelopeRef,\n    replication_proof: ReceiptMultiProofV1,\n}\n\nHolonRole { BUILD_WORKER | PENTEST_SANDBOX | SERVICE_HOST | RELAY | GENERAL_COMPUTE }\n```\n\n## Trust boundaries and threat model\n\nTrust boundary: The provisioning protocol straddles two trust domains \u2014 the existing system (trusted, after RFC-0022 sovereignty) and the new machine (UNTRUSTED until attested and provisioned). The machine transitions from UNTRUSTED to CONSTRAINED-TRUSTED upon successful provisioning, with capabilities strictly bounded by the provisioning receipt.\n\nThreats:\n1. **Rogue machine injection (PHY-05)**: Adversary presents a compromised machine for provisioning. Mitigation: bilateral attestation, principal must approve every new machine, capability ceiling strictly bounded.\n2. **Resource exhaustion attack (PHY-04)**: Provisioned holon consumes resources beyond budget. Mitigation: metering is external to the provisioned holon; budget enforcement at the parent.\n3. **Evidence loss during teardown (PHY-04)**: Machine fails before evidence replication completes. Mitigation: evidence replication is a precondition of teardown completion; teardown is a two-phase protocol.\n4. **Jurisdiction evasion (BSP_27)**: Machine claims to be in an allowed jurisdiction but isn't. Mitigation: provider attestation + network-path analysis, not just IP geolocation.\n5. **Capability amplification (PHY-05)**: Child holon somehow gains more capabilities than parent granted. Mitigation: OCAP strict subset rule, verified at every capability check.\n\n## Theory bindings\n\n- LAW-05 (Dual-Axis Containment): Provisioned holons are contained along both integrity and authority axes\n- LAW-11 (Idempotent Actuation): Provisioning is idempotent (OBJ-ARP-05)\n- LAW-12 (Bounded Search): Resource budgets are termination envelopes for provisioned work\n- LAW-16 (Closure Under Composition): Provisioned holons compose holonically \u2014 a provisioned holon can provision sub-holons (with strictly reduced capabilities)\n- INV-F-01 (Append-only truth): Provisioning and teardown receipts are append-only\n- INV-F-05 (Default-deny, least-privilege, time-bounded): Every provisioned capability is time-bounded\n- INV-F-12 (Compaction preserves auditability): Evidence compaction during teardown preserves audit trail\n- PRIN-030 (OCAP): No ambient authority for provisioned machines\n\n## Rollout\n\n- S0: Define MachineAttestationV1, implement for local-machine-only (same host, different namespace)\n- S1: Provisioning protocol for BUILD_WORKER role \u2014 spawn build agents on a second machine\n- S2: Resource budgeting and metering \u2014 track CPU/storage/network per provisioned holon\n- S3: Teardown protocol with evidence replication \u2014 two-phase commit\n- S4: Jurisdiction verification \u2014 integrate provider attestation\n- S5: Multi-role provisioning (PENTEST_SANDBOX, SERVICE_HOST)\n- S6: Recursive provisioning \u2014 provisioned holons can provision sub-holons\n- S7: RELAY role \u2014 provisioned machine acts as federation relay (HSI S8 prerequisite)\n- S8: Cost optimization \u2014 budget-aware scheduling across provisioned fleet\n",
    "notes": ""
  }
}