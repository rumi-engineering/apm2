requirement:
  schema_version: "2026-02-09"
  id: "REQ-0004"
  title: "Budgeted anti-entropy, risk-aware queueing, and HTF-bounded backpressure"
  category: "RELIABILITY"
  priority: "P0"
  status: "PROPOSED"
  statement: |
    Anti-entropy MUST remain pull-only and budget-bound in explicit HTF windows
    (`W_htf_control`, `W_htf_replay`, `W_htf_anti_entropy`) with queueing/backpressure
    policies that prioritize stop/revocation/high-assurance control traffic over
    low-priority bulk traffic.

    Queue control MUST enforce `tick_floor_met` invariants and deny promotion if
    temporal authority (`TimeAuthorityEnvelopeV1`) is stale/unsigned/missing/invalid.
    Canonical temporal predicates for this requirement are `TP-EIO29-001`,
    `TP-EIO29-002`, and `TP-EIO29-003`.
  rationale: |
    Unbounded or risk-agnostic queueing allows adversarial traffic to starve critical controls.
  acceptance_criteria:
    - "Budget exceedance triggers deterministic throttle/deny behavior with defect emission."
    - "Critical control classes preserve service under load with bounded tick-floor guarantees."
    - "Recursion amplification is bounded by policy caps."
    - "Stop/revocation lanes cannot be delayed past declared tick floors during sink outage or replay pressure."
    - "Anti-entropy convergence satisfies declared `anti_entropy_convergence_horizon_ref`."
    - "Unknown window resolution or invalid time-authority envelope fails closed."
  imported_dependencies:
    - "RFC-0020::REQ-0035"
    - "RFC-0020::REQ-0034"
    - "RFC-0018::REQ-HEF-0018"
    - "RFC-0019::REQ-0011"
    - "RFC-0016::REQ-HTF-0003"
  evidence_ids:
    - "EVID-0004"
