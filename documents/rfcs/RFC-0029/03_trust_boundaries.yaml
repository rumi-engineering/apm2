rfc_trust_boundaries:
  schema_version: "2026-02-09"

  trust_model:
    summary: |
      RFC-0029 assumes adversarial projection and federation conditions while
      preserving truth-plane authority semantics. Efficiency controls are
      admissible only when authority inputs remain truth-plane-bound and temporal
      contracts are fail-closed.

  trust_boundaries:
    - id: "TB-EIO29-0001"
      name: "Truth-plane vs projection-plane authority boundary"
      description: "Authoritative inputs are restricted to CAS, ledger, policy roots, and signed time authority; projection sink state is never an authority input."
      assets:
        - "CAS root"
        - "ledger head"
        - "policy roots"
        - "TimeAuthorityEnvelopeV1"
      failure_modes:
        - "projection sink state used as authority input"
        - "authority_inputs escapes truth_plane_inputs"

    - id: "TB-EIO29-0002"
      name: "Byzantine projection worker boundary"
      description: "Projection workers are bounded by n >= 3f + 1 assumptions and quorum-certified effect constraints."
      assets:
        - "projection worker pool P"
        - "quorum certificate chain"
        - "projection target digests"
      failure_modes:
        - "insufficient worker cardinality for Byzantine bound"
        - "invalid quorum certificate"
        - "worker disagreement without fail-closed response"

    - id: "TB-EIO29-0003"
      name: "Sink identity and DNS/key rotation boundary"
      description: "Sink identity, endpoint digest, keyset digest, DNS binding proof, and validity window are enforced via SinkIdentitySnapshotV1."
      assets:
        - "sink_id"
        - "endpoint digest"
        - "signing key set digest"
        - "DNS binding proof digest"
        - "validity window"
      failure_modes:
        - "unsigned endpoint manifest update"
        - "key rotation without overlap"
        - "DNS proof failure"
        - "endpoint mismatch"

    - id: "TB-EIO29-0004"
      name: "Federation partition and split-brain boundary"
      description: "Partition topology and split-brain handling enforce revocation-wins merge semantics and deny promotion under unresolved frontier conflicts."
      assets:
        - "revocation frontiers"
        - "partition topology verdicts"
        - "cross-cell anti-entropy state"
      failure_modes:
        - "truth-plane quorum loss"
        - "divergent truth planes"
        - "unresolved cross-cell frontier conflict"

    - id: "TB-EIO29-0005"
      name: "Human/operator authority-input boundary"
      description: "Operator inputs to authority-critical fields are typed and constrained; free-form wall-clock strings are forbidden."
      assets:
        - "typed HTF refs"
        - "signed diff preview"
        - "dual confirmation workflow"
        - "TP-EIO29 verdict vector display"
      failure_modes:
        - "misconfigured window reference"
        - "wrong boundary_id or authority_clock"
        - "stale policy snapshot deployment"
        - "display-clock routed into authority field"
        - "incorrect sink identity mapping"

    - id: "TB-EIO29-0006"
      name: "Physical infrastructure authority-clock boundary"
      description: "Hardware/runtime anomalies affecting authority clock validity are first-class failure scenarios and must deny authority-bearing external I/O on ambiguity."
      assets:
        - "monotonic clock source"
        - "NTP and time-sync subsystem"
        - "power/network/storage integrity signals"
        - "HardwareTierEnvelopeV1"
      failure_modes:
        - "monotonic clock hardware fault"
        - "VM pause/resume skew"
        - "NTP turbulence"
        - "leap-second/leap-smear mismatch"
        - "power brownout"
        - "network brownout/packet reordering storms"
        - "partial storage corruption"

  threats:
    - id: "TH-EIO29-0001"
      name: "Projection-state authority contamination"
      mechanism: "Projection sink observations are incorrectly consumed as authority inputs for promotion-critical decisions."
      impact: "False authority admission and integrity loss."
      mitigation: "projection_sink_independence_valid predicate and INTERLOCK gate enforcement."

    - id: "TH-EIO29-0002"
      name: "Byzantine projection worker divergence"
      mechanism: "Compromised workers emit inconsistent receipts or target digests under quorum-threshold pressure."
      impact: "Unsafe projection certification and replay drift."
      mitigation: "n >= 3f + 1, q >= 2f + 1 quorum policy, disagreement receipts, and fail-closed promotion denial."

    - id: "TH-EIO29-0003"
      name: "Sink identity takeover via DNS/key churn"
      mechanism: "Endpoint/DNS/key mismatch during update windows allows adversarial sink impersonation."
      impact: "Projection writes diverted to untrusted endpoint."
      mitigation: "Signed overlap key rotation, endpoint manifest update requirements, and immediate quarantine on mismatch."

    - id: "TH-EIO29-0004"
      name: "Split-brain revocation rollback"
      mechanism: "Partitioned frontiers reintroduce stale authorization during merge/rejoin."
      impact: "Revoked authority may be resurrected."
      mitigation: "rf_merge(scope)=max(rf_a(scope),rf_b(scope)), no promotion on unresolved conflicts, and revocation-wins rule."

    - id: "TH-EIO29-0005"
      name: "Replay/idempotency failure under backlog stress"
      mechanism: "Deferred replay under outage pressure duplicates effects or violates dedup identity closure."
      impact: "Double-actuation and authoritative inconsistency."
      mitigation: "TP-EIO29-004/007 enforcement, replay convergence receipts, and queue budget slicing."

    - id: "TH-EIO29-0006"
      name: "Operator misconfiguration of temporal/boundary fields"
      mechanism: "Wrong boundary_id, authority_clock, or stale policy fields pass into critical gate paths."
      impact: "Incorrect temporal inference and unsafe admission."
      mitigation: "Typed authority fields, dual confirmation, signed diff preview, and ambiguity fail-closed behavior."

    - id: "TH-EIO29-0007"
      name: "Physical clock and infrastructure disturbance"
      mechanism: "Clock faults, skew events, storage corruption, or network turbulence invalidate temporal authority assumptions."
      impact: "Temporal predicates become ambiguous or unverifiable."
      mitigation: "Ambiguous authority-clock validity denies authority-bearing I/O; recovery drills must include signed scenario receipts."

    - id: "TH-EIO29-0008"
      name: "Evidence freshness liveness collapse"
      mechanism: "Evidence expiry rate outruns generation throughput during degraded states."
      impact: "Gate states block promotion and can cascade toward freeze/halt."
      mitigation: "Evidence throughput dominance invariant, constrained degrade prioritization, and bounded recovery budgets."

  controls_and_enforcement:
    fail_closed_policy:
      - "All unknown or ambiguous authority-critical inputs deny."
      - "Gate failure at temporal authority, monotonicity, or interlock boundaries blocks promotion-critical decisions."
      - "Tier2+ CAC defects force D3 freeze pending adjudication deadline."
    monotone_safety_controls:
      - "revocation_frontier_monotone across adjacent windows"
      - "replay_idempotency_monotone across adjacent windows"
      - "frontier_merge_monotone under split-brain merge"
    bounded_escalation_controls:
      - "freeze_duration bounded by max_fail_closed_freeze_windows"
      - "freeze budget exhaustion escalates to D4 emergency halt"
      - "halt receipts and recovery plans are mandatory for D4"
    diagnostics_requirements:
      - "failure mode classification receipts for erasure/BFT reconstruction paths"
      - "temporal disagreement and arbitration receipts for TP-EIO29 ambiguity handling"
      - "projection worker disagreement receipts for Byzantine divergence"
