rfc_design_decisions:
  schema_version: "2026-02-09"

  formal_model:
    symbols_and_domains:
      windows:
        symbol: "W"
        definition: "Set of HTF windows"
        element_symbol: "w"
        element_fields:
          - "boundary_id"
          - "authority_clock"
          - "tick_start"
          - "tick_end"
      sinks:
        symbol: "S"
        definition: "Set of projection sinks"
      revocation_scopes:
        symbol: "R"
        definition: "Set of revocation scopes"
      queue_lanes:
        symbol: "L"
        definition: "{stop_revoke, control, consume, replay, projection_replay, bulk}"
      artifact_tiers:
        symbol: "T"
        definition: "{TIER-CONTROL, TIER-EVIDENCE-HOT, TIER-EVIDENCE-BULK}"
      lifecycle_cost_vector:
        symbol: "C"
        definition: "C = (C_join, C_revalidate, C_consume, C_effect, C_replay, C_recovery)"
      total_cost:
        symbol: "C_total"
        definition: "C_total = sum(C)"
      verdict_domain:
        symbol: "Verdict"
        definition: "{allow, deny, freeze, escalate}"
      unknown_state_guard:
        unknown_definition: "unknown(x) is true when x is missing, parse-invalid, stale, unsigned where signature is mandatory, or semantically unresolved."
        fail_closed_macro: "fc(p) = deny when unknown(p)"

    window_algebra:
      operators:
        - "contains(w_i, t) := w_i.tick_start <= t <= w_i.tick_end"
        - "adjacent(w_i, w_j) := w_i.tick_end + 1 == w_j.tick_start"
        - "disjoint(w_i, w_j) := w_i.tick_end < w_j.tick_start or w_j.tick_end < w_i.tick_start"
        - "partial_overlap(w_i, w_j) := !disjoint(w_i, w_j) and !(w_i == w_j) and !adjacent(w_i, w_j)"
      admissibility_rule: "Temporal comparisons are admissible only for windows with equal (boundary_id, authority_clock). Cross-boundary or cross-clock comparisons are non-computable and fail closed."

  temporal_predicate_contract:
    predicates:
      - id: "TP-EIO29-001"
        name: "time_authority_envelope_valid"
        inputs:
          - "TimeAuthorityEnvelopeV1 e"
          - "expected (boundary_id, authority_clock)"
          - "evaluation window w_eval"
        predicate:
          - "verify_signature_set(e.signature_set)"
          - "e.boundary_id == w_eval.boundary_id"
          - "e.authority_clock == w_eval.authority_clock"
          - "e.tick_start <= w_eval.tick_start and e.tick_end >= w_eval.tick_end"
          - "ttl_fresh(e.ttl, w_eval)"
          - "e.deny_on_unknown == true"
        falsification: "Any accepted gate with stale/invalid/missing envelope."
        fail_closed: "unknown(e) -> deny"

      - id: "TP-EIO29-002"
        name: "freshness_horizon_satisfied"
        inputs:
          - "freshness_horizon_ref"
          - "current window w_now"
          - "revocation frontier snapshot rf_now"
        predicate:
          - "window_resolves(freshness_horizon_ref)"
          - "w_now.tick_end <= freshness_horizon_ref.tick_end"
          - "revocation_frontier_current(rf_now)"
        falsification: "Admission when w_now exceeds freshness horizon or frontier is stale."
        fail_closed: "Unresolved freshness_horizon_ref or frontier uncertainty denies."

      - id: "TP-EIO29-003"
        name: "anti_entropy_convergence_horizon_satisfied"
        inputs:
          - "anti_entropy_convergence_horizon_ref"
          - "required authority-critical sets A_required"
          - "convergence receipts R_converge"
        predicate:
          - "forall a in A_required, converged(a, anti_entropy_convergence_horizon_ref, R_converge)"
        falsification: "Any required set non-converged beyond horizon."
        fail_closed: "Missing receipts or unresolved required set denies."

      - id: "TP-EIO29-004"
        name: "replay_convergence_horizon_satisfied"
        inputs:
          - "replay_convergence_horizon_ref"
          - "backlog state B"
          - "ReplayConvergenceReceiptV1"
        predicate:
          - "replay_converges_idempotently_within(B, replay_convergence_horizon_ref)"
        falsification: "Backlog remains unresolved or diverges after horizon end."
        fail_closed: "Missing replay receipt fields denies."

      - id: "TP-EIO29-005"
        name: "projection_multi_sink_continuity_valid"
        inputs:
          - "sink set S"
          - "scenario generator sink_failure_set(S)"
          - "ProjectionSinkContinuityProfileV1"
        predicate:
          - "forall scenario in sink_failure_set(S), authoritative_truth_plane_progress(scenario) and bounded_projection_backlog(scenario)"
        falsification: "Any scenario halts authoritative truth-plane progression."
        fail_closed: "Unknown scenario verdict denies."

      - id: "TP-EIO29-006"
        name: "revocation_frontier_monotone"
        inputs:
          - "adjacent windows w_t, w_t1"
          - "revocation frontiers rf_t, rf_t1"
        predicate:
          - "adjacent(w_t, w_t1)"
          - "forall r in R, rf_t1[r] >= rf_t[r]"
        falsification: "Any scope regresses in later window."
        fail_closed: "Non-adjacent comparison or missing scope entry denies."

      - id: "TP-EIO29-007"
        name: "replay_idempotency_monotone"
        inputs:
          - "adjacent windows w_t, w_t1"
          - "admitted effect sets E_t, E_t1"
          - "revoked set Rev_t1"
        predicate:
          - "adjacent(w_t, w_t1)"
          - "forall e in Rev_t1, e notin E_t1"
          - "effects_in_later_window_do_not_duplicate_authoritative_outcome(E_t, E_t1)"
        falsification: "Replay in w_t1 resurrects revoked or already-accounted effect."
        fail_closed: "Unresolved effect identity or dedup evidence denies."

      - id: "TP-EIO29-008"
        name: "promotion_temporal_ambiguity == false"
        inputs:
          - "verdict bundle over TP-EIO29-001..007"
          - "window resolution status"
          - "evaluator disagreement status"
        predicate:
          - "no unknown temporal fields"
          - "no unresolved window reference"
          - "no unresolved evaluator disagreement"
        falsification: "Any promotion pass with unknown temporal state."
        fail_closed: "Unresolved ambiguity denies promotion."

    evaluator_and_disagreement:
      ownership_boundary:
        - "Canonical semantic anchor: RFC-0016 temporal substrate semantics."
        - "Canonical cross-profile contract anchor: RFC-0019 snapshot/matrix temporal contract surfaces."
        - "RFC-0029 defines efficiency-plane evaluation and economics coupling for TP-EIO29-* and does not override security-plane temporal ownership."
      canonical_evaluator_tuple:
        - "evaluator_id"
        - "predicate_id"
        - "contract_digest_set"
        - "time_authority_ref"
        - "window_ref"
        - "verdict"
        - "deny_reason"
      required_evaluator_id: "temporal_predicate_evaluator_v1"
      determinism_contract:
        - "For fixed tuple inputs, independent verifiers MUST return identical verdict and deny_reason."
        - "Equality target is byte-identical canonicalized output payload bytes."
        - "Promotion-critical temporal predicate execution is integer/tick-space only; floating-point arithmetic is non-admissible."
      disagreement_contract:
        definition: "Let D = set of verifier verdicts."
        trigger: "if |D| > 1"
        mandatory_actions:
          - "Emit TemporalDisagreementReceiptV1."
          - "Set temporal_disagreement = true."
          - "Tier2+ behavior: freeze."
          - "Run cross-profile temporal arbitration and emit TemporalArbitrationReceiptV1."
        arbitration_outcomes:
          - "ARBITRATION_AGREED_ALLOW"
          - "ARBITRATION_AGREED_DENY"
          - "ARBITRATION_DISAGREEMENT_TRANSIENT"
          - "ARBITRATION_DISAGREEMENT_PERSISTENT"
        deadline_rule: "Adjudication deadline is bounded by adjudication_deadline_window_ref; unresolved expiration escalates to deny for promotion."

    boundary_case_truth_table:
      - case: "Exact match"
        condition: "w_i == w_j"
        allowed_temporal_inference: "full comparison"
        gate_outcome: "continue"
      - case: "Adjacent forward leap"
        condition: "adjacent(w_i, w_j)"
        allowed_temporal_inference: "monotonic checks allowed"
        gate_outcome: "continue"
      - case: "Partial overlap"
        condition: "partial_overlap(w_i, w_j)"
        allowed_temporal_inference: "only overlap-safe predicates"
        gate_outcome: "deny Tier2+ promotion unless explicitly modeled"
      - case: "Disjoint gap"
        condition: "disjoint(w_i, w_j)"
        allowed_temporal_inference: "no continuity inference"
        gate_outcome: "deny"
      - case: "Cross-boundary mismatch"
        condition: "boundary_id differs"
        allowed_temporal_inference: "none"
        gate_outcome: "deny"
      - case: "Cross-clock mismatch"
        condition: "authority_clock differs"
        allowed_temporal_inference: "none"
        gate_outcome: "deny"
      - case: "Unresolved window ref"
        condition: "lookup failure"
        allowed_temporal_inference: "none"
        gate_outcome: "deny"

    overlap_safe_set:
      rule: "For partial_overlap(w_i, w_j), only predicates that do not require adjacency/disjoint continuity assumptions are overlap-safe."
      safe_predicates:
        - id: "TP-EIO29-001"
          name: "time_authority_envelope_valid"
        - id: "TP-EIO29-002"
          name: "freshness_horizon_satisfied"
      non_overlap_safe_examples:
        - id: "TP-EIO29-006"
          reason: "Requires adjacent-window monotonicity assumptions."
        - id: "TP-EIO29-007"
          reason: "Requires adjacent-window replay continuity assumptions."
      policy: "Non-overlap-safe predicates must deny under partial overlap unless separately modeled."

    predicate_cac_bindings:
      tuple_contract:
        - "predicate_id"
        - "required_cac_inputs[]"
        - "contract_digest_set"
        - "canonicalizer_tuple"
        - "time_authority_ref"
        - "window_ref"
        - "verdict"
        - "deny_reason"
      canonicalizer_tuple: "(canonicalizer_id, canonicalizer_version, canonicalizer_vectors_ref)"
      predicates:
        - id: "TP-EIO29-001"
          required_cac_inputs:
            - kind: "time.envelope"
              schema_id: "apm2.time_authority_envelope.v1"
          binding_rule: "Envelope digest MUST be present in contract_digest_set; missing/stale/invalid signature denies."

        - id: "TP-EIO29-002"
          required_cac_inputs:
            - kind: "revocation.frontier.snapshot"
              schema_id: "apm2.revocation_frontier_snapshot.v1"
            - kind: "temporal.slo.profile"
              schema_id: "apm2.temporal_slo_profile.v1"
          binding_rule: "Freshness horizon and frontier digests MUST resolve for w_now; unresolved digest denies."

        - id: "TP-EIO29-003"
          required_cac_inputs:
            - kind: "anti_entropy.convergence.receipt"
              schema_id: "apm2.anti_entropy_convergence_receipt.v1"
          binding_rule: "Required authority-set convergence digests MUST all be present; any missing digest denies."

        - id: "TP-EIO29-004"
          required_cac_inputs:
            - kind: "replay.convergence.receipt"
              schema_id: "apm2.replay_convergence_receipt.v1"
          binding_rule: "Replay receipt digest MUST prove bounded idempotent convergence for referenced window."

        - id: "TP-EIO29-005"
          required_cac_inputs:
            - kind: "projection.continuity.window"
              schema_id: "apm2.projection_continuity_window.v1"
            - kind: "projection.sink.continuity.profile"
              schema_id: "apm2.projection_sink_continuity_profile.v1"
            - kind: "sink.identity.snapshot"
              schema_id: "apm2.sink_identity_snapshot.v1"
          binding_rule: "Scenario set digest, outage window digest, and sink identity digest MUST be jointly bound in one contract_digest_set."

        - id: "TP-EIO29-006"
          required_cac_inputs:
            - kind: "revocation.frontier.snapshot"
              schema_id: "apm2.revocation_frontier_snapshot.v1"
            - kind: "time.envelope"
              schema_id: "apm2.time_authority_envelope.v1"
          binding_rule: "Adjacent-window frontier digests MUST be present and monotone; non-adjacent or missing scope entries deny."

        - id: "TP-EIO29-007"
          required_cac_inputs:
            - kind: "replay.convergence.receipt"
              schema_id: "apm2.replay_convergence_receipt.v1"
            - kind: "authority.kernel.decision"
              schema_id: "apm2.authority_kernel_decision.v1"
          binding_rule: "Effect identity digests and replay dedup digests MUST be present; unresolved effect identity denies."

        - id: "TP-EIO29-008"
          required_cac_inputs:
            - kind: "temporal.arbitration.receipt"
              schema_id: "apm2.temporal_arbitration_receipt.v1"
            - kind: "temporal.disagreement.receipt"
              schema_id: "apm2.temporal_disagreement_receipt.v1"
            - kind: "temporal.evaluator"
              schema_id: "apm2.temporal_predicate_evaluator.v1"
          binding_rule: "Ambiguity verdict MUST be digest-bound to TP-EIO29-001..007 verdict bundle and arbitration outcome; any unknown digest entry denies promotion."
      preconditions: "Schema resolution, digest checks, and canonicalizer checks are mandatory preconditions to predicate evaluation."

    deterministic_compute_model:
      mandatory_rules:
        - "Use integer/tick-space arithmetic for temporal and budget computations."
        - "Use canonicalized payload bytes for equality checks; semantic-only equality is insufficient."
        - "Use schema/domain-separated hashing including schema_id and schema_major."
      fail_closed_ambiguity_classes:
        - "digest collision ambiguity"
        - "non-canonical string encoding ambiguity"
        - "non-replayable evaluator output ambiguity"
      policy: "Any ambiguity class above is non-admissible for promotion-critical outcomes."

  degraded_mode_and_halt:
    mode_ladder:
      - mode: "D0"
        name: "Nominal"
        semantics:
          - "All temporal/security predicates valid."
          - "Full gate path enabled."
      - mode: "D1"
        name: "Constrained Degrade"
        semantics:
          - "Bounded non-critical optimization features disabled."
          - "Truth-plane and stop/revoke lanes fully active."
          - "Projection replay may be rate-limited."
      - mode: "D2"
        name: "Continuity-Only"
        semantics:
          - "Authoritative truth-plane progression only."
          - "External projection writes blocked except explicitly approved emergency sink."
          - "Replay allowed only within control-safe slices."
      - mode: "D3"
        name: "Fail-Closed Freeze"
        semantics:
          - "Promotion-critical operations frozen."
          - "Only revocation propagation, stop orders, and recovery diagnostics allowed."
          - "Bounded evidence-regeneration/time-authority-recovery workflows are admissible when they cannot authorize new external effects."
      - mode: "D4"
        name: "Emergency Halt"
        semantics:
          - "Explicit halt of authority-bearing admissions."
          - "Requires HaltStateReceiptV1 and bounded recovery plan."

    transition_and_escalation:
      transition_predicate: "mode_next = f(mode_current, predicate_vector, freeze_budget, halt_risk_budget)"
      mandatory_bounds:
        - "max_fail_closed_freeze_windows is profile-declared."
        - "if freeze_duration > max_fail_closed_freeze_windows, automatic escalation to D4 plus adjudication workflow."
      halt_risk_budget: "(max_freeze_windows, max_blocked_promotions, max_control_path_delay_ticks)"
      denial_rule: "Promotion is denied if halt risk budget is consumed even when some efficiency KPIs improve."
      joint_state_arbitration:
        - "Operational state is evaluated as (S_i, D_j), where S_i is security mode and D_j is efficiency mode."
        - "Arbitration uses typed dominance comparator mode_dominance_select over (profile_id, mode_symbol, severity_class) tuples."
        - "Unresolved comparator state is fail-closed deny."
        - "Security constraints dominate when policy interpretations differ; efficiency policy may only add restrictions."
        - "This two-profile arbitration is a specialization of RFC-0019 multi-profile composition algebra."

    halt_deadlock_distinction:
      halt_detected:
        - "explicit stop order"
        - "hard gate deny"
        - "freeze budget exhaustion"
      deadlock_detected:
        - "halt_detected == false"
        - "enabled workset non-empty"
        - "no authoritative progress for deadlock_detection_window_ref"
      required_behavior:
        - "halt_detected -> deterministic halt receipts and recovery workflow"
        - "deadlock_detected -> escalation to scheduler remediation; no silent stall allowed"

  economics_queue_anti_entropy:
    constrained_objective:
      objective: "min C_total"
      hard_constraints:
        - "pcac_receipt_completeness == 1.0"
        - "pcac_consume_deny_correctness == 1.0"
        - "pcac_revocation_dominant == true"
        - "pcac_single_consume_enforced == true"
        - "boundary_flow_admissible == true"
        - "disclosure_control_policy_preserved == true (phase-qualified policy mode; current default mode: trade-secret-only)"
        - "projection_isolation_non_regression == true"
        - "rolespec_context_injection_deterministic == true"
        - "rolespec_context_minimality_enforced == true"
        - "TP-EIO29-001..008 all true"
      non_admissible_rule: "Any optimization with reduced C_total is non-admissible when any hard constraint regresses."

    admission_math:
      lane_symbols:
        - "arrival rate lambda_l"
        - "service rate mu_l"
        - "utilization rho_l = lambda_l / mu_l"
        - "lane budget B_l"
      temporal_lane_admit: "temporal_lane_admit(req, l) = if l == stop_revoke then (TP-EIO29-001 or local_monotonic_emergency_time_valid(req)) else TP-EIO29-001"
      admission_predicate: "admit(req, l) = temporal_lane_admit(req, l) and role_context_injection_admissible(req.role_spec_hash, req.context_pack_manifest_hash, req.required_selector_digest_set) and tokens(l) >= cost(req) and backlog(l) <= B_l and rho_l <= rho_max(l)"
      containment_priority_carve_out:
        - "local_monotonic_emergency_time_valid(req) is admissible only for stop_revoke lane operations that reduce authority (revoke/stop) and MUST NOT authorize new external effects."
        - "If full envelope validity is unavailable, stop/revoke operations remain fail-closed to authority expansion and fail-open only to authority reduction actions."
      service_discipline:
        - "Strict priority for stop_revoke."
        - "Weighted deficit round robin for remaining lanes."
        - "reservation(stop_revoke) >= R_stop_min"
        - "reservation(control) >= R_control_min"

    anti_starvation_obligations:
      invariants:
        - "tick_floor_met(stop_revoke_lane, control_window_ref)"
        - "critical_path_reservation_enforced == true"
        - "wait_ticks(stop_revoke) <= W_stop_max"
        - "wait_ticks(control) <= W_control_max"
        - "replay dispatch respects queue_budget.replay_slice_ticks"
      mandatory_negative_tests:
        - "replay flood with sustained sink outage"
        - "mixed control + replay adversarial bursts"
        - "low-rate attacker traffic designed for defender-cost exhaustion"

    pull_only_anti_entropy_bound:
      rules:
        - "No unsolicited authority acceptance from pushed data-plane payloads."
        - "Oversized proof ranges or proof bytes are denied."
        - "Bounded decoding applies pre-decode and post-decode."

    rolespec_context_injection:
      definitions:
        - "ctx_injected(r, w): context atom set injected into role runtime"
        - "ctx_required(r, w): deterministic selector closure from hash-addressed CAC artifacts"
      deterministic_selector_closure_inputs:
        - "role_spec_hash"
        - "context_pack_spec_hash"
        - "context_pack_manifest_hash"
        - "reasoning_selector_hash"
        - "budget_profile_hash"
      admissibility_predicate: "role_context_injection_admissible(r, w) = (ctx_injected(r, w) == ctx_required(r, w)) and digest_set_complete(ctx_required) and canonicalizer_tuple_consistent(ctx_required) and no_unplanned_context_reads(r, w)"
      cost_formula: "C_context(r, w) = bytes(ctx_injected(r, w)) + retrieval_cost(ctx_injected(r, w)) + verifier_cost(ctx_injected(r, w))"
      optimization_rule: "Optimization is admissible only when delta(C_context) < 0 and role_context_injection_admissible remains true."
      fail_closed:
        - "Unresolved selector digest denies."
        - "Unresolved context artifact hash denies."
        - "Any ambient read outside selector closure is non-admissible for promotion-critical paths."

  projection_and_federation_model:
    sink_independence_and_bft:
      trust_plane_separation:
        - "Authoritative decision inputs must be truth-plane only."
        - "truth-plane = CAS + ledger + policy roots + signed time authority"
        - "projection sink state is never an authority input"
      predicate: "projection_sink_independence_valid = authority_inputs subseteq truth_plane_inputs"
      byzantine_projection_worker_assumptions:
        - "|P| = n projection workers with Byzantine bound f"
        - "n >= 3f + 1"
        - "projection effect certification quorum q >= 2f + 1 over receipt chain and sink target digest"
        - "worker disagreement emits ProjectionWorkerDisagreementReceiptV1 and fails closed for promotion-critical flows"
      model_scope:
        - "Network model for liveness claims: partial synchrony with eventual synchrony."
        - "Adversary model: static Byzantine up to f per declared window and failure-domain envelope."
        - "Safety under persistent partitions remains fail-closed deny/freeze; no global liveness claim under permanent partition."
        - "Concrete protocol family must be declared by policy object and evidenced before Tier2+ promotion-critical admission."
      property_first_admissibility:
        - "Canonical requirement is property-level, not protocol-name-level."
        - "Required properties: quorum safety, replayable certificate validation, bounded liveness assumptions under declared network/adversary model."
      current_reference_implementation_profile:
        - "Implementation instance: Chained HotStuff for quorum-certificate progression."
        - "Safety evidence instance: 3-chain commit rule verification with valid quorum certificates over Ed25519 signer set."
        - "Liveness assumption instance: eventual synchrony with bounded view-change progression under active pacemaker."
        - "Complexity profile instance: steady-state linear message fanout O(n) in validator set size for proposal/prepare/commit propagation."
      sink_identity_rotation_dns_rules:
        - "SinkIdentitySnapshotV1 includes sink_id, endpoint digest(s), signing key set digest, DNS binding proof digest, and validity window."
        - "Key rotation requires signed overlap window with old and new key sets."
        - "DNS changes require signed endpoint manifest update before actuation."
        - "Endpoint mismatch or DNS proof failure marks sink compromised and quarantines projection lane."

    partition_and_split_brain:
      partition_topology_truth_table:
        - topology: "A: projection-only partition"
          truth_plane_quorum: "intact"
          projection_sinks: "partitioned"
          admissible_operations: "truth-plane progression, backlog buffering"
          promotion: "blocked if continuity predicates unresolved"
        - topology: "B: cross-cell anti-entropy lag"
          truth_plane_quorum: "intact local, delayed remote"
          projection_sinks: "mixed"
          admissible_operations: "local authoritative actions with bounded import restrictions"
          promotion: "blocked for cross-cell promotion"
        - topology: "C: truth-plane quorum loss"
          truth_plane_quorum: "lost"
          projection_sinks: "any"
          admissible_operations: "stop/revoke only, diagnostics"
          promotion: "deny"
        - topology: "D: split-brain truth planes"
          truth_plane_quorum: "divergent"
          projection_sinks: "any"
          admissible_operations: "freeze + revocation propagation + adjudication"
          promotion: "deny"
        - topology: "E: full outage with recoverable logs"
          truth_plane_quorum: "unknown temporary"
          projection_sinks: "down"
          admissible_operations: "continuity-only mode if temporal authority remains valid"
          promotion: "deny promotion until recovery proof"
      revocation_under_split_brain:
        merge_law: "rf_merge(scope) = max(rf_a(scope), rf_b(scope))"
        safety_rules:
          - "Revocation wins over stale authorization."
          - "No promotion while any scope has unresolved frontier conflict."
        predicate: "split_brain_revocation_safe = frontier_merge_monotone and no_revoked_revival"

  recoverability_and_reconstruction:
    tiered_redundancy:
      tier_contract: "Each tier declares (k, n, failure_domains, repair_slo, p_unrecoverable_max)."
      required_policy:
        - "TIER-CONTROL: replication-first + low-latency retrieval"
        - "TIER-EVIDENCE-HOT: hybrid replication + erasure"
        - "TIER-EVIDENCE-BULK: erasure-preferred with bounded repair envelope"
      disclosure_interaction_rule:
        - "cross-trust-boundary fragment placement requires redundancy_purpose_declassification_valid == true with scoped receipt evidence"
        - "if active disclosure policy mode forbids required fragment placement, redundancy plan MUST stay trust-boundary-local or is non-admissible"

    erasure_bft_admissibility:
      criterion:
        - "erasure_decode_valid == true"
        - "recovered_digest == expected_digest_from_source_trust_snapshot"
        - "bft_quorum_recovery_valid == true"
        - "RecoveryAdmissibilityReceiptV1.time_authority_ref resolves to valid TP-EIO29-001"
      chained_hotstuff_additional_requirements:
        - "quorum certificate signer cardinality >= 2f + 1 for declared validator set"
        - "3-chain commit linkage is verifier-replayable from certified block ancestry"
        - "quorum certificate signature set verifies against active validator keyset and epoch"
      failure_mode_classification:
        - code: "ERASURE_UNAVAILABLE_BFT_VALID"
          meaning: "data unavailable but trust quorum intact"
          remediation_priority: "redundancy repair"
        - code: "ERASURE_VALID_BFT_INVALID"
          meaning: "data available but integrity/trust disagreement"
          remediation_priority: "quorum/integrity re-verification and trust-root checks"
        - code: "ERASURE_UNAVAILABLE_BFT_INVALID"
          meaning: "data unavailable and untrusted"
          remediation_priority: "repair and trust reconstruction workflow"
      fail_closed_rule: "Any missing component is fail-closed deny."

  cryptography_and_compromise:
    agility_and_downgrade:
      policy_object: "CryptoAgilityPolicyV1"
      required_fields:
        - "allowed signature algorithms by epoch"
        - "minimum security class by risk tier"
        - "forbidden downgrade transitions"
      negotiation_rule:
        - "choose strongest mutually admissible algorithm for the current epoch"
        - "unknown or unlisted algorithm for authority paths denies"

    compromise_windows:
      timeline_windows:
        - "W_detect: max ticks to detect and classify suspected key compromise"
        - "W_revoke: max ticks from detection to revocation publication"
        - "W_reseal: max ticks to reseal mandatory artifacts under clean keys"
      slo_predicate: "key_compromise_slo_met = detect_within(W_detect) and revoke_within(W_revoke) and reseal_within(W_reseal)"

    recovery_and_retrust:
      compromise_rule: "If key K is compromised at compromise_epoch"
      post_compromise_trust:
        - "artifacts signed only by K after compromise_epoch are non-trusted until re-proven"
        - "artifacts before compromise_epoch remain conditionally trusted only with independent non-compromised verifier corroboration"
        - "post-compromise promotion requires replay under clean key epoch"

  security_economics_model:
    repeated_game_formulation:
      strategies:
        - "attacker strategy at step t: a_t"
        - "defender policy at step t: d_t"
      per_window_costs:
        - "A_t = attacker_cost_lower_bound_estimate(a_t, observed_signals_t)"
        - "D_t = defender_cost(d_t, a_t)"
        - "ACR_t = D_t / max(A_t, epsilon)"
        - "A_conf_t = confidence(attacker_cost_lower_bound_estimate) in [0.0, 1.0]"
      required_horizon:
        - "thresholds are enforced on sequence {ACR_t} over H windows, not one-shot snapshots"
        - "slope(ACR_t over H) is computed using declared estimator profile (ols baseline) and minimum sample-size contract"
        - "epsilon MUST be policy-declared and evidence-bound for active epoch"
        - "when A_conf_t < A_conf_min, policy MUST apply conservative bound inflation or freeze promotion-critical optimization decisions until confidence recovers"
      non_admissible_conditions:
        - "sustained attacker-favorable trend: slope(ACR_t over H) > 0 beyond policy threshold"
        - "defender-cost exhaustion risk above threshold under low-rate prolonged attacks"
        - "economically safe but operationally brittle state where ACR passes but stop/revoke tick floors, freeze budgets, or temporal predicates regress"
        - "unresolved attacker-cost confidence below policy minimum for H_conf consecutive windows"

  semantic_drift_contract:
    contract_surfaces:
      - "RFC-0016: TimeAuthorityEnvelopeV1 semantics"
      - "RFC-0019: snapshot and gate-order contracts"
      - "RFC-0028: security interlock predicates"
      - "RFC-0029: economics and temporal predicates"
    diff_classes:
      - "NON_SEMANTIC"
      - "SEMANTIC_SAFE"
      - "SEMANTIC_RISKY"
      - "AMBIGUOUS"
    policy:
      - "SEMANTIC_RISKY and AMBIGUOUS are non-promotable"
      - "AMBIGUOUS requires adjudication before semantic_drift_deadline_window_ref; timeout is fail-closed deny"

  key_design_decisions:
    - decision_id: "DD-EIO29-0001"
      title: "Fail-closed efficiency profile constrained by security correctness"
      status: "ACCEPTED"
      statement: "Optimization is admissible only if all non-regressible safety/correctness constraints remain satisfied while minimizing C_total."
      rationale: "Cost reduction cannot justify weakening lifecycle security correctness or temporal integrity."
      requirement_ids:
        - "REQ-0001"
        - "REQ-0006"

    - decision_id: "DD-EIO29-0002"
      title: "Contract-ID temporal predicates with canonical evaluator semantics"
      status: "ACCEPTED"
      statement: "Temporal contracts are encoded as TP-EIO29-001..008 and evaluated by TemporalPredicateEvaluatorV1 with deterministic canonical tuple behavior."
      rationale: "Predicate identity and deterministic evaluation are required for replayable cross-verifier conformance."
      requirement_ids:
        - "REQ-0004"
        - "REQ-0005"
        - "REQ-0006"

    - decision_id: "DD-EIO29-0003"
      title: "Overlap-safe inference restrictions"
      status: "ACCEPTED"
      statement: "Partial-overlap windows allow only overlap-safe predicates (TP-EIO29-001/002); non-safe continuity predicates deny unless separately modeled."
      rationale: "Prevents invalid continuity inference under ambiguous temporal overlap conditions."
      requirement_ids:
        - "REQ-0004"

    - decision_id: "DD-EIO29-0004"
      title: "Degraded-mode ladder with bounded freeze and halt-risk budgets"
      status: "ACCEPTED"
      statement: "Efficiency operations transition through D0..D4 with bounded freeze windows, explicit halt receipts, and fail-closed escalation rules."
      rationale: "Degrade behavior must remain policy-bounded and auditable under sustained failures."
      requirement_ids:
        - "REQ-0004"
        - "REQ-0006"

    - decision_id: "DD-EIO29-0005"
      title: "Queue admission prioritizes stop/revoke under temporal authority"
      status: "ACCEPTED"
      statement: "Admission math enforces lane budgets, temporal authority, and reservation guarantees, with stop/revoke authority-reduction carve-out under emergency local monotonic proof."
      rationale: "Containment-critical control lanes must remain serviceable under adversarial load without enabling authority expansion."
      requirement_ids:
        - "REQ-0004"

    - decision_id: "DD-EIO29-0006"
      title: "RoleSpec context injection as deterministic efficiency-quality contract"
      status: "ACCEPTED"
      statement: "Context injection is admissible only when injected atoms equal deterministic selector closure with complete digest and canonicalizer consistency."
      rationale: "Primary efficiency savings must preserve deterministic context completeness and replay verifiability."
      requirement_ids:
        - "REQ-0002"
        - "REQ-0006"

    - decision_id: "DD-EIO29-0007"
      title: "Projection sink independence and Byzantine continuity"
      status: "ACCEPTED"
      statement: "Authority inputs are truth-plane only; projection continuity requires property-level BFT evidence and bounded replay under sink failure scenarios."
      rationale: "Public projection instability must not corrupt authoritative admission decisions."
      requirement_ids:
        - "REQ-0008"
        - "REQ-0009"

    - decision_id: "DD-EIO29-0008"
      title: "Recoverability requires erasure plus BFT digest-trust closure"
      status: "ACCEPTED"
      statement: "Reconstruction is admissible only with valid erasure decode, source-trust digest match, quorum-certified integrity, and valid temporal authority reference."
      rationale: "Availability without trust closure is insufficient for promotion-critical recovery."
      requirement_ids:
        - "REQ-0005"
        - "REQ-0010"

    - decision_id: "DD-EIO29-0009"
      title: "Crypto agility and compromise-window obligations"
      status: "ACCEPTED"
      statement: "Algorithm negotiation is epoch/risk-tier constrained with explicit compromise detection/revocation/reseal windows and post-compromise replay requirements."
      rationale: "Efficiency profile must remain resilient to downgrade and compromise economics."
      requirement_ids:
        - "REQ-0006"

    - decision_id: "DD-EIO29-0010"
      title: "Semantic drift blocks promotion on risky or ambiguous classes"
      status: "ACCEPTED"
      statement: "Cross-RFC semantic drift is classified by SemanticDiffReportV1 and promotion is blocked for SEMANTIC_RISKY or AMBIGUOUS classes."
      rationale: "Inter-RFC compatibility drift must fail closed when economic/security contract interpretation is uncertain."
      requirement_ids:
        - "REQ-0006"
