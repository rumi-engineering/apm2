rfc_trust_boundaries:
  schema_version: "2026-02-05"
  template_version: "2026-01-23"

  boundaries:
    - id: "TB-0001"
      name: "Session Identity Boundary"
      description: "Transition from discovery to authority-bearing session requires proof-carrying identity and freshness witness."
      actors: ["apm2-cli", "apm2-daemon", "relay holon"]
      entrypoints: ["hsi.session.open", "hsi.session.info"]
      data_flows:
        - "client holon_id + identity_proof_hash -> daemon verification"
        - "daemon cell_certificate_hash + holon_directory_head_hash + epoch_seal_hash -> client verification"
      authn_authz:
        authn: "Self-certifying identities + directory proof verification"
        authz: "Capability manifest and episode envelope bindings"
      risks:
        - "identity replay with stale directory head"
        - "parser differential on identity text forms"
      evidence_ids: ["EVID-0101", "EVID-0102"]

    - id: "TB-0002"
      name: "Capsule Containment Boundary"
      description: "Agent runtime executes without ambient OS authority; only daemon-mediated actuation crosses boundary."
      actors: ["agent capsule", "tool broker", "kernel runtime"]
      entrypoints: ["hsi.tool.*", "hsi.context.*"]
      data_flows:
        - "context selectors -> bounded context reads"
        - "ToolIntentV1 -> broker mediation -> receipt"
      authn_authz:
        authn: "session-bound identity + optional session key delegation"
        authz: "capability scopes + context firewall + stop checks"
      risks:
        - "capsule escape or path traversal"
        - "adapter bypass of broker mediation"
      evidence_ids: ["EVID-0103"]

    - id: "TB-0003"
      name: "Permeability Delegation Boundary"
      description: "Cross-holon authority entry is legal only through PermeabilityReceiptV1 with meet-validated narrowing."
      actors: ["delegator holon", "delegatee holon", "relay"]
      entrypoints: ["HSI.PERMEABILITY.GRANT", "hsi.episode.spawn"]
      data_flows:
        - "permeability_receipt_hash -> fetch/verify -> authority meet"
      authn_authz:
        authn: "delegator authority seal under admitted trust root"
        authz: "strict-subset meet across risk/capability/budget/expiry/taint/classification"
      risks:
        - "capability laundering"
        - "expiry or stop weakening"
      evidence_ids: ["EVID-0104"]

    - id: "TB-0004"
      name: "Directory Convergence Boundary"
      description: "Signed CRDT updates converge under revocation-wins law; truth requires head commitment + admission anchor."
      actors: ["cell policy root", "directory replicator", "verifier"]
      entrypoints: ["HSI.DIRECTORY.ANNOUNCE", "HSI.ANTI_ENTROPY.*"]
      data_flows:
        - "CRDT delta -> signed update -> head commitment"
        - "IdentityProofV1 pointer -> proof verification"
      authn_authz:
        authn: "issuer identity must be admitted and replay-protected"
        authz: "revocation/re-admission policy with monotone anchor checks"
      risks:
        - "resurrection-by-race"
        - "proof amplification DoS"
      evidence_ids: ["EVID-0105", "EVID-0106"]

    - id: "TB-0005"
      name: "Federation Relay Boundary"
      description: "Relays route digests and bounded evidence requests; relays are never global authority kernels."
      actors: ["relay holon", "peer cell", "local verifier"]
      entrypoints: ["EVIDENCE channel", "GOVERNANCE channel"]
      data_flows:
        - "anti-entropy offer/compare/request/deliver"
        - "admission receipt emission for imported facts"
      authn_authz:
        authn: "cell certificates + quorum/auth seals"
        authz: "channel budgets, fanout caps, pull-only anti-entropy"
      risks:
        - "Byzantine relay equivocation"
        - "unsolicited payload flooding"
      evidence_ids: ["EVID-0107"]

    - id: "TB-0006"
      name: "Proof Compression Boundary"
      description: "Receipt authentication transitions from direct signatures to batch proofs without changing observable semantics."
      actors: ["receipt issuer", "verifier", "auditor"]
      entrypoints: ["ReceiptPointerV1", "ReceiptMultiProofV1"]
      data_flows:
        - "receipt_hash -> batch proof -> authority seal or FactRoot QC path"
      authn_authz:
        authn: "AuthoritySealV1 or QC-authenticated FactRootV1"
        authz: "risk-tier-specific attestation floor and freshness policy"
      risks:
        - "free-floating batch signatures"
        - "proof structure ambiguity"
      evidence_ids: ["EVID-0108", "EVID-0109"]

    - id: "TB-0007"
      name: "HTF Freshness Boundary"
      description: "Authorization freshness uses ledger lag and HTF envelopes; wall time remains non-authoritative."
      actors: ["policy evaluator", "verifier", "governance loop"]
      entrypoints: ["FreshnessPolicyV1", "EpochSealV1"]
      data_flows:
        - "directory head anchor + local admitted anchor -> lag check"
        - "epoch_seal monotonicity checks"
      authn_authz:
        authn: "epoch authority seal + quorum anchor verification"
        authz: "risk-tier staleness actions"
      risks:
        - "stale identity reuse"
        - "epoch rollback"
      evidence_ids: ["EVID-0110"]

    - id: "TB-0008"
      name: "Compaction/Summary Boundary"
      description: "Lossy transformations are admissible only with selector coverage and explicit loss profiles."
      actors: ["summarizer", "auditor", "supervisor holon"]
      entrypoints: ["SummaryReceipt", "CompactionReceipt", "ToolLogIndexV1"]
      data_flows:
        - "source indices -> lossy artifact -> selector-backed claims"
      authn_authz:
        authn: "receipt bindings and authority seal requirements by risk tier"
        authz: "high-risk operations require terminal verifier evidence"
      risks:
        - "unverifiable narrative compression"
        - "selector omission hides material claims"
      evidence_ids: ["EVID-0111"]

  trust_posture:
    byzantine_assumption: "Cross-cell peers and relays are Byzantine by default unless proven otherwise."
    precedence_order: "containment_security > verification_correctness > liveness_progress"
    fail_closed_default: true

  source_bindings:
    section_refs:
      - "HOLONIC_SUBSTRATE_INTERFACE.md §0.1"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §1.7"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §1.8"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §2.3"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §2.4"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §4"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §8"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §9.3"
