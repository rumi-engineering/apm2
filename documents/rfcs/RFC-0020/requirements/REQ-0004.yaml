requirement:
  schema_version: "2026-02-05"
  id: "REQ-0004"
  title: "Episode envelope and receipt binding completeness"
  category: "FUNCTIONAL"
  priority: "P0"
  status: "PROPOSED"
  statement: |
    All authoritative effects MUST bind EpisodeEnvelopeV1 hash, capability_manifest_hash, and ViewCommitmentV1 hash (`view_commitment_hash`) in receipts; EpisodeEnvelopeV1 MUST bind freshness_pinset_hash (or equivalent deterministic pinned-snapshot commitment), and delegated episodes MUST bind permeability_receipt_hash; spawn or resume without valid envelope bindings MUST be denied.

    Primary delivery ticket: TCK-00350
  rationale: |
    Proof-carrying effects require immutable commitment roots for replay and audit correctness.
  acceptance_criteria:
    - "Tool receipts always carry envelope/capability/view bindings"
    - "Episode envelopes bind a deterministic freshness pinset commitment hash"
    - "Spawn/resume denied when envelope absent or malformed"
    - "Replay harness can resolve and verify bindings from CAS + ledger"
    - "Primary implementation ticket TCK-00350 is completed with linked evidence."
  evidence_ids:
    - "EVID-0004"
  source_refs:
    - "HOLONIC_SUBSTRATE_INTERFACE.md §1.3"
    - "HOLONIC_SUBSTRATE_INTERFACE.md §1.8.1"
    - "HOLONIC_SUBSTRATE_INTERFACE.md §3.3"
    - "HOLONIC_SUBSTRATE_INTERFACE.md §8.3.3"
    - "HOLONIC_SUBSTRATE_INTERFACE.md §10 Stage 1"
