requirement:
  schema_version: "2026-02-05"
  id: "REQ-0002"
  title: "Handshake contract hash and canonicalizer binding"
  category: "SECURITY"
  priority: "P0"
  status: "PROPOSED"
  statement: |
    Session handshake MUST exchange and persist cli_contract_hash and canonicalizer id/version; risk-tier mismatch policy MUST implement Tier0-1 warn/waive and Tier2+ deny-by-default behavior.

    Primary delivery ticket: TCK-00348
  rationale: |
    Early contract mismatch detection prevents confused-deputy execution under incompatible syscall semantics.
  acceptance_criteria:
    - "Handshake fails closed for Tier2+ contract/canonicalizer mismatch"
    - "SessionStarted binds contract hash and canonicalizer metadata"
    - "Mismatch counters emitted with risk-tier labels"
    - "Primary implementation ticket TCK-00348 is completed with linked evidence."
  evidence_ids:
    - "EVID-0002"
  source_refs:
    - "HOLONIC_SUBSTRATE_INTERFACE.md ยง3.1.2"
    - "HOLONIC_SUBSTRATE_INTERFACE.md ยง3.1.3"
    - "HOLONIC_SUBSTRATE_INTERFACE.md ยง10 Stage 0"
