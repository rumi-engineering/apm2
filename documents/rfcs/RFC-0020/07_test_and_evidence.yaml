rfc_test_and_evidence:
  schema_version: "2026-02-05"
  template_version: "2026-01-23"
  test_plan:
    unit:
      - id: "UT-0001"
        name: "HSI contract manifest deterministic generation"
        description: "Verifies route semantics annotations, canonical bytes, and stable contract hash."
        coverage_target: "REQ-0001, REQ-0002"
      - id: "UT-0002"
        name: "Session decode hardening"
        description: "Verifies bounded decode/collection checks and fail-closed enum behavior."
        coverage_target: "REQ-0003"
      - id: "UT-0003"
        name: "Envelope binding completeness"
        description: "Verifies all authoritative receipts carry envelope/capability/view bindings."
        coverage_target: "REQ-0004"
      - id: "UT-0004"
        name: "Stop/budget precondition ordering"
        description: "Verifies stop and budget evaluation always precedes actuation."
        coverage_target: "REQ-0005"
      - id: "UT-0005"
        name: "Identity ID canonical grammar"
        description: "Rejects mixed encodings and enforces stable text/binary round-trips."
        coverage_target: "REQ-0007, REQ-0008, REQ-0009"
      - id: "UT-0006"
        name: "Directory proof verifier bounds"
        description: "Verifies pre-decode and post-decode proof bounds with malformed negatives."
        coverage_target: "REQ-0010, REQ-0011"
      - id: "UT-0007"
        name: "Identity proof profile pinning"
        description: "Verifies profile hash mismatch and unknown profile fail-closed behavior."
        coverage_target: "REQ-0012, REQ-0013"
      - id: "UT-0008"
        name: "AuthoritySeal direct and batch modes"
        description: "Verifies direct signatures and Merkle-batch authentication under one abstraction."
        coverage_target: "REQ-0016, REQ-0017"
      - id: "UT-0009"
        name: "Freshness policy evaluator"
        description: "Verifies HTF/ledger-lag authority inputs and staleness actions by risk tier."
        coverage_target: "REQ-0018, REQ-0019"
      - id: "UT-0010"
        name: "Delegation meet algorithm"
        description: "Verifies strict-subset meet semantics over all authority vector dimensions."
        coverage_target: "REQ-0027"
      - id: "UT-0011"
        name: "Context firewall TOCTOU checks"
        description: "Verifies context selection hash consistency and deny/terminate behavior."
        coverage_target: "REQ-0029"
      - id: "UT-0012"
        name: "ToolKind argument and idempotency rules"
        description: "Verifies typed argument validation, path/ref rules, and idempotency guards."
        coverage_target: "REQ-0031"
      - id: "UT-0013"
        name: "Dual lattice propagation rules"
        description: "Verifies taint/confidentiality lattice joins/meets and declassification controls."
        coverage_target: "REQ-0032"
      - id: "UT-0014"
        name: "HMP class invariants"
        description: "Verifies WORK/EVIDENCE/GOVERNANCE channel semantics and digest-first payload policy."
        coverage_target: "REQ-0034"
      - id: "UT-0015"
        name: "Anti-entropy bounded protocol checks"
        description: "Verifies offer/compare/request/deliver pull-only and bounded resource handling."
        coverage_target: "REQ-0035"

    integration:
      - id: "IT-0001"
        name: "Session-open proof-carrying identity path"
        description: "End-to-end handshake using identity_proof_hash, directory head, and certificate artifacts."
        coverage_target: "REQ-0008, REQ-0009, REQ-0015"
      - id: "IT-0002"
        name: "Episode actuation proof obligations E2E"
        description: "Spawn/resume with envelope + manifest + preconditions; verify receipt chain from CAS+ledger."
        coverage_target: "REQ-0004, REQ-0005, REQ-0006"
      - id: "IT-0003"
        name: "Permeability delegation E2E"
        description: "Delegator->delegatee flow with strict-subset meet checks and consumption bindings."
        coverage_target: "REQ-0027"
      - id: "IT-0004"
        name: "AuthoritySeal and ReceiptPointer interoperability"
        description: "Verifies direct and batched acceptance paths produce equivalent acceptance decisions."
        coverage_target: "REQ-0016, REQ-0017, REQ-0024"
      - id: "IT-0005"
        name: "Batch proof hierarchy path"
        description: "Receipt -> batch root -> epoch root -> checkpoint/qc verification path."
        coverage_target: "REQ-0024, REQ-0025, REQ-0026"
      - id: "IT-0006"
        name: "Capsule + firewall hardening E2E"
        description: "Validates no ambient authority and context firewall denial/termination for Tier3+."
        coverage_target: "REQ-0028, REQ-0029, REQ-0030"
      - id: "IT-0007"
        name: "ToolKinds hardened execution path"
        description: "Validates typed tool routing, allowlists, and attestation floor checks."
        coverage_target: "REQ-0031, REQ-0033"
      - id: "IT-0008"
        name: "Federation read-only convergence"
        description: "Cross-cell imports with admission receipts and CRDT revocation-wins convergence."
        coverage_target: "REQ-0014, REQ-0034, REQ-0035"
      - id: "IT-0009"
        name: "Epoch seal authority admission path"
        description: "Tier2+ cross-cell authority denied when epoch seals are invalid/stale/missing."
        coverage_target: "REQ-0019, REQ-0020"
      - id: "IT-0010"
        name: "Stop-path governance across cells"
        description: "Cross-cell stop/rotation via governance channel with authenticated receipts."
        coverage_target: "REQ-0036"
      - id: "IT-0011"
        name: "Advisory objective cannot authorize effects"
        description: "Verifies EFE/planner outputs are advisory-only and cannot bypass capability, stop, freshness, or attestation gates."
        coverage_target: "REQ-0023"

    fuzz:
      - id: "FZ-0001"
        name: "Identity parser differential fuzzing"
        description: "Fuzzes canonical grammar and parser edge cases across implementations."
        coverage_target: "REQ-0007, REQ-0008, REQ-0009"
      - id: "FZ-0002"
        name: "Directory proof parser fuzzing"
        description: "Fuzzes proof nodes/depth/encodings against decode bounds and verifier correctness."
        coverage_target: "REQ-0010, REQ-0011, REQ-0012"
      - id: "FZ-0003"
        name: "Capability and permeability laundering fuzzing"
        description: "Fuzzes scope expansion attempts and authority meet constraint bypasses."
        coverage_target: "REQ-0006, REQ-0027"
      - id: "FZ-0004"
        name: "Tool argument injection fuzzing"
        description: "Fuzzes ToolKind argument validators and structured shell bridge allowlists."
        coverage_target: "REQ-0031"
      - id: "FZ-0005"
        name: "Receipt multiproof structure fuzzing"
        description: "Fuzzes multiproof structure reconstruction and malformed proof nodes."
        coverage_target: "REQ-0017, REQ-0024, REQ-0025"

    perf:
      - id: "PF-0001"
        name: "Identity verification economics benchmark"
        description: "Measures proof verification work class and cache amortization with 10^12 namespace model."
        coverage_target: "REQ-0011, REQ-0013"
      - id: "PF-0002"
        name: "Attestation batching overhead harness"
        description: "Measures CPU and network deltas against baseline quorum-certified path."
        coverage_target: "REQ-0026"
      - id: "PF-0003"
        name: "Multiproof bandwidth and verifier cost benchmark"
        description: "Compares independent inclusion proofs vs multiproof under realistic FAC fanout."
        coverage_target: "REQ-0017, REQ-0024, REQ-0025"
      - id: "PF-0004"
        name: "Backpressure and evidence budget benchmark"
        description: "Measures enforcement of per-episode/per-cell/per-relay budgets under burst load."
        coverage_target: "REQ-0035"
      - id: "PF-0005"
        name: "Stop-path latency SLO benchmark"
        description: "Measures stop propagation p99 and stop uncertainty deny deadlines."
        coverage_target: "REQ-0036"

    chaos:
      - id: "CH-0001"
        name: "CAS partial unavailability"
        description: "Verifies fail-closed behavior and recovery during CAS degradation."
        coverage_target: "REQ-0004, REQ-0005, REQ-0036"
      - id: "CH-0002"
        name: "Ledger append latency injection"
        description: "Verifies freshness and checkpoint-dependent flows under lag and jitter."
        coverage_target: "REQ-0018, REQ-0019, REQ-0036"
      - id: "CH-0003"
        name: "Byzantine relay behavior drill"
        description: "Simulates drop/duplicate/reorder/equivocation and validates convergence + denial rules."
        coverage_target: "REQ-0034, REQ-0035"
      - id: "CH-0004"
        name: "Epoch replay and rollback drill"
        description: "Simulates stale seal replay, conflicting seals, and non-monotone sequences."
        coverage_target: "REQ-0019, REQ-0020"
      - id: "CH-0005"
        name: "Capsule escape and context-poisoning drill"
        description: "Runs adversarial filesystem traversal and prompt-injection scenarios."
        coverage_target: "REQ-0028, REQ-0029, REQ-0032"

    formal:
      - id: "FM-0001"
        name: "Session state-machine model"
        description: "Machine model for handshake/work/evidence/governance ordering invariants."
        coverage_target: "REQ-0003, REQ-0004, REQ-0005"
      - id: "FM-0002"
        name: "Bisimulation artifact N<=12"
        description: "Proof artifact for observational equivalence under flattening for bounded recursion depth."
        coverage_target: "REQ-0021"
      - id: "FM-0003"
        name: "Functorial observation law model"
        description: "Proof obligations for admitted optimization rewrites and composition preservation."
        coverage_target: "REQ-0022"
      - id: "FM-0004"
        name: "Anti-entropy safety model"
        description: "Model proving pull-based boundedness and no unsigned authority acceptance."
        coverage_target: "REQ-0034, REQ-0035"
      - id: "FM-0005"
        name: "Freshness and staleness safety model"
        description: "Proves Tier2+ actuation implies non-stale identity and stop state."
        coverage_target: "REQ-0018, REQ-0019"
      - id: "FM-0006"
        name: "Revocation-wins convergence model"
        description: "Proves revoked identities cannot resurrect absent explicit re-admission anchor."
        coverage_target: "REQ-0014"

  evidence_bundle:
    root: "evidence/rfc/RFC-0020/"
    artifact_registry:
      mode: "FILE_PER_ARTIFACT"
      local_root: "evidence_artifacts/"
      local_artifacts:
        - id: "EVID-0001"
          file_ref: "evidence_artifacts/EVID-0001.yaml"
          description: "HSI contract manifest determinism evidence"
        - id: "EVID-0002"
          file_ref: "evidence_artifacts/EVID-0002.yaml"
          description: "Handshake contract-hash binding evidence"
        - id: "EVID-0003"
          file_ref: "evidence_artifacts/EVID-0003.yaml"
          description: "Session decode fail-closed hardening evidence"
        - id: "EVID-0004"
          file_ref: "evidence_artifacts/EVID-0004.yaml"
          description: "Episode envelope and receipt binding evidence"
        - id: "EVID-0005"
          file_ref: "evidence_artifacts/EVID-0005.yaml"
          description: "Stop and budget precondition evidence"
        - id: "EVID-0006"
          file_ref: "evidence_artifacts/EVID-0006.yaml"
          description: "Policy-only capability minting evidence"
        - id: "EVID-0007"
          file_ref: "evidence_artifacts/EVID-0007.yaml"
          description: "Canonical key identifier conformance evidence"
        - id: "EVID-0008"
          file_ref: "evidence_artifacts/EVID-0008.yaml"
          description: "Stable genesis-derived ID evidence"
        - id: "EVID-0009"
          file_ref: "evidence_artifacts/EVID-0009.yaml"
          description: "Certificate and session-key delegation evidence"
        - id: "EVID-0010"
          file_ref: "evidence_artifacts/EVID-0010.yaml"
          description: "Directory head and identity proof artifact evidence"
        - id: "EVID-0011"
          file_ref: "evidence_artifacts/EVID-0011.yaml"
          description: "O(log n) verifier bound evidence"
        - id: "EVID-0012"
          file_ref: "evidence_artifacts/EVID-0012.yaml"
          description: "IdentityProofProfile pinning evidence"
        - id: "EVID-0013"
          file_ref: "evidence_artifacts/EVID-0013.yaml"
          description: "Verifier cache amortization and invalidation evidence"
        - id: "EVID-0014"
          file_ref: "evidence_artifacts/EVID-0014.yaml"
          description: "Revocation-wins CRDT convergence evidence"
        - id: "EVID-0015"
          file_ref: "evidence_artifacts/EVID-0015.yaml"
          description: "Session-open identity freshness enforcement evidence"
        - id: "EVID-0016"
          file_ref: "evidence_artifacts/EVID-0016.yaml"
          description: "AuthoritySeal direct/batch mode evidence"
        - id: "EVID-0017"
          file_ref: "evidence_artifacts/EVID-0017.yaml"
          description: "ReceiptPointer and multiproof interoperability evidence"
        - id: "EVID-0018"
          file_ref: "evidence_artifacts/EVID-0018.yaml"
          description: "FreshnessPolicy HTF authority evidence"
        - id: "EVID-0019"
          file_ref: "evidence_artifacts/EVID-0019.yaml"
          description: "EpochSeal monotonicity evidence"
        - id: "EVID-0020"
          file_ref: "evidence_artifacts/EVID-0020.yaml"
          description: "Optional VDF profile evidence"
        - id: "EVID-0021"
          file_ref: "evidence_artifacts/EVID-0021.yaml"
          description: "Bisimulation artifact evidence"
        - id: "EVID-0022"
          file_ref: "evidence_artifacts/EVID-0022.yaml"
          description: "Functorial law rewrite evidence"
        - id: "EVID-0023"
          file_ref: "evidence_artifacts/EVID-0023.yaml"
          description: "Advisory-only active inference evidence"
        - id: "EVID-0024"
          file_ref: "evidence_artifacts/EVID-0024.yaml"
          description: "FactRoot + QC composition evidence"
        - id: "EVID-0025"
          file_ref: "evidence_artifacts/EVID-0025.yaml"
          description: "BatchEpochRoot hierarchical forest evidence"
        - id: "EVID-0026"
          file_ref: "evidence_artifacts/EVID-0026.yaml"
          description: "Attestation overhead contract evidence"
        - id: "EVID-0027"
          file_ref: "evidence_artifacts/EVID-0027.yaml"
          description: "Permeability meet algorithm evidence"
        - id: "EVID-0028"
          file_ref: "evidence_artifacts/EVID-0028.yaml"
          description: "Capsule profile hardening evidence"
        - id: "EVID-0029"
          file_ref: "evidence_artifacts/EVID-0029.yaml"
          description: "Context firewall TOCTOU evidence"
        - id: "EVID-0030"
          file_ref: "evidence_artifacts/EVID-0030.yaml"
          description: "No-bypass enforcement evidence"
        - id: "EVID-0031"
          file_ref: "evidence_artifacts/EVID-0031.yaml"
          description: "Typed ToolKinds hardening evidence"
        - id: "EVID-0032"
          file_ref: "evidence_artifacts/EVID-0032.yaml"
          description: "Dual lattice propagation evidence"
        - id: "EVID-0033"
          file_ref: "evidence_artifacts/EVID-0033.yaml"
          description: "Attestation floor tightening evidence"
        - id: "EVID-0034"
          file_ref: "evidence_artifacts/EVID-0034.yaml"
          description: "HMP digest-first and admission receipt evidence"
        - id: "EVID-0035"
          file_ref: "evidence_artifacts/EVID-0035.yaml"
          description: "Anti-entropy and Byzantine relay evidence"
        - id: "EVID-0036"
          file_ref: "evidence_artifacts/EVID-0036.yaml"
          description: "Business continuity and governance stop/rotation evidence"
        - id: "EVID-0101"
          file_ref: "evidence_artifacts/EVID-0101.yaml"
          description: "Trust boundary TB-0001 identity/session evidence"
        - id: "EVID-0102"
          file_ref: "evidence_artifacts/EVID-0102.yaml"
          description: "Trust boundary TB-0001 freshness/replay evidence"
        - id: "EVID-0103"
          file_ref: "evidence_artifacts/EVID-0103.yaml"
          description: "Trust boundary TB-0002 capsule containment evidence"
        - id: "EVID-0104"
          file_ref: "evidence_artifacts/EVID-0104.yaml"
          description: "Trust boundary TB-0003 permeability delegation evidence"
        - id: "EVID-0105"
          file_ref: "evidence_artifacts/EVID-0105.yaml"
          description: "Trust boundary TB-0004 convergence safety evidence"
        - id: "EVID-0106"
          file_ref: "evidence_artifacts/EVID-0106.yaml"
          description: "Trust boundary TB-0004 proof-amplification resistance evidence"
        - id: "EVID-0107"
          file_ref: "evidence_artifacts/EVID-0107.yaml"
          description: "Trust boundary TB-0005 relay boundary evidence"
        - id: "EVID-0108"
          file_ref: "evidence_artifacts/EVID-0108.yaml"
          description: "Trust boundary TB-0006 proof-compression equivalence evidence"
        - id: "EVID-0109"
          file_ref: "evidence_artifacts/EVID-0109.yaml"
          description: "Trust boundary TB-0006 free-floating signature rejection evidence"
        - id: "EVID-0110"
          file_ref: "evidence_artifacts/EVID-0110.yaml"
          description: "Trust boundary TB-0007 HTF freshness evidence"
        - id: "EVID-0111"
          file_ref: "evidence_artifacts/EVID-0111.yaml"
          description: "Trust boundary TB-0008 selector coverage evidence"
        - id: "EVID-0201"
          file_ref: "evidence_artifacts/EVID-0201.yaml"
          description: "Contract family CTR-0001 evidence"
        - id: "EVID-0202"
          file_ref: "evidence_artifacts/EVID-0202.yaml"
          description: "Contract family CTR-0002 evidence"
        - id: "EVID-0203"
          file_ref: "evidence_artifacts/EVID-0203.yaml"
          description: "Contract family CTR-0003 evidence"
        - id: "EVID-0204"
          file_ref: "evidence_artifacts/EVID-0204.yaml"
          description: "Contract family CTR-0004 evidence"
        - id: "EVID-0205"
          file_ref: "evidence_artifacts/EVID-0205.yaml"
          description: "Contract family CTR-0005 evidence"
        - id: "EVID-0206"
          file_ref: "evidence_artifacts/EVID-0206.yaml"
          description: "Contract family CTR-0006 evidence"
        - id: "EVID-0207"
          file_ref: "evidence_artifacts/EVID-0207.yaml"
          description: "Contract family CTR-0007 evidence"
        - id: "EVID-0208"
          file_ref: "evidence_artifacts/EVID-0208.yaml"
          description: "Contract family CTR-0008 evidence"
        - id: "EVID-0301"
          file_ref: "evidence_artifacts/EVID-0301.yaml"
          description: "Rollout phase S0 evidence"
        - id: "EVID-0302"
          file_ref: "evidence_artifacts/EVID-0302.yaml"
          description: "Rollout phase S0.5 evidence"
        - id: "EVID-0303"
          file_ref: "evidence_artifacts/EVID-0303.yaml"
          description: "Rollout phase S0.75 evidence"
        - id: "EVID-0304"
          file_ref: "evidence_artifacts/EVID-0304.yaml"
          description: "Rollout phase S0.9 evidence"
        - id: "EVID-0305"
          file_ref: "evidence_artifacts/EVID-0305.yaml"
          description: "Rollout phase S1/S2 evidence"
        - id: "EVID-0306"
          file_ref: "evidence_artifacts/EVID-0306.yaml"
          description: "Rollout phase S2.5/S2.6 evidence"
        - id: "EVID-0307"
          file_ref: "evidence_artifacts/EVID-0307.yaml"
          description: "Rollout phase S3/S3.5 evidence"
        - id: "EVID-0308"
          file_ref: "evidence_artifacts/EVID-0308.yaml"
          description: "Rollout phase S4-S6.5 evidence"
        - id: "EVID-0309"
          file_ref: "evidence_artifacts/EVID-0309.yaml"
          description: "Rollout phase S7-S8 evidence"
        - id: "EVID-0401"
          file_ref: "evidence_artifacts/EVID-0401.yaml"
          description: "Formal verification gate artifact bundle"
        - id: "EVID-0402"
          file_ref: "evidence_artifacts/EVID-0402.yaml"
          description: "Business continuity drill and stop-path SLO bundle"
      imports: []
