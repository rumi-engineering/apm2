rfc_contracts_and_versioning:
  schema_version: "2026-02-05"
  template_version: "2026-01-23"

  contracts:
    - id: "CTR-0001"
      name: "HSIContractManifestV1"
      type: "ARTIFACT_SCHEMA"
      versioning:
        scheme: "SEMVER + CONTENT_HASH"
        current_version: "1.0.0"
        compatibility_rules:
          - "semantic change requires contract hash change"
          - "missing route semantics annotations fail build"
      schemas:
        - id: "SCH-0001"
          path: "apm2.hsi_contract.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Static syscall inventory and semantics obligations"
      evidence_ids: ["EVID-0201"]

    - id: "CTR-0002"
      name: "Capability + Episode Commitments"
      type: "ARTIFACT_SCHEMA"
      versioning:
        scheme: "SEMVER + HASH_PIN"
        current_version: "1.0.0"
        compatibility_rules:
          - "envelope/manifest hash bindings mandatory in authoritative receipts"
      schemas:
        - id: "SCH-0002"
          path: "apm2.capability_manifest.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Delegated capability handles, scopes, allowlists, expiry"
        - id: "SCH-0003"
          path: "apm2.episode_envelope.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Immutable execution commitment"
      evidence_ids: ["EVID-0202"]

    - id: "CTR-0003"
      name: "Identity + certificate artifact family"
      type: "ARTIFACT_SCHEMA"
      versioning:
        scheme: "SEMVER + DOMAIN_SEPARATED_HASH"
        current_version: "1.0.0"
        compatibility_rules:
          - "text and binary identity forms must round-trip losslessly"
          - "root/operational/session key roles must remain non-overlapping"
      schemas:
        - id: "SCH-0004"
          path: "apm2.cell_genesis.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Stable cell id derivation input"
        - id: "SCH-0005"
          path: "apm2.cell_certificate.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Cell trust binding"
        - id: "SCH-0006"
          path: "apm2.holon_genesis.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Stable holon id derivation input"
        - id: "SCH-0007"
          path: "apm2.holon_certificate.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Holon identity/operational key binding"
        - id: "SCH-0008"
          path: "apm2.session_key_delegation.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Session key binding to operational identity"
        - id: "SCH-0008A"
          path: "apm2.keyset_descriptor.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Canonical quorum verifier set descriptor resolved by *_quorum_id"
      evidence_ids: ["EVID-0203"]

    - id: "CTR-0004"
      name: "Directory proof artifact family"
      type: "ARTIFACT_SCHEMA"
      versioning:
        scheme: "SEMVER + PROFILE_HASH"
        current_version: "1.0.0"
        compatibility_rules:
          - "proofs must be bounded before decode"
          - "profile-hash mismatch denies actuation at Tier2+"
      schemas:
        - id: "SCH-0009"
          path: "apm2.holon_directory_head.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Directory head commitment and authority seal binding"
        - id: "SCH-0010"
          path: "apm2.identity_proof.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Identity membership/non-membership proof pointer object"
        - id: "SCH-0011"
          path: "apm2.directory_proof.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Typed bounded ADS proof payload"
        - id: "SCH-0012"
          path: "apm2.identity_proof_profile.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Verifier economics contract"
        - id: "SCH-0013"
          path: "apm2.identity_multiproof.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Shared multiproof for high fanout identity checks"
      evidence_ids: ["EVID-0204"]

    - id: "CTR-0005"
      name: "Authority and freshness artifact family"
      type: "ARTIFACT_SCHEMA"
      versioning:
        scheme: "SEMVER + SECURITY_RATCHET"
        current_version: "1.0.0"
        compatibility_rules:
          - "ledger_anchor required in all AuthoritySealV1"
          - "time_envelope_ref required for governance and Tier2+ actuation facts"
      schemas:
        - id: "SCH-0014"
          path: "apm2.authority_seal.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Unified authenticated fact envelope"
        - id: "SCH-0015"
          path: "apm2.freshness_policy.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Policy for staleness handling by risk tier"
        - id: "SCH-0016"
          path: "apm2.epoch_seal.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "HTF/quorum anchored freshness epoch object"
        - id: "SCH-0016A"
          path: "apm2.freshness_pinset.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Pinned reproducibility inputs bound by episode envelopes"
      evidence_ids: ["EVID-0205"]

    - id: "CTR-0006"
      name: "Federation messaging and anti-entropy contracts"
      type: "PROTOCOL_SURFACE"
      versioning:
        scheme: "VERSIONED_MESSAGE_CLASS"
        current_version: "1.0.0"
        compatibility_rules:
          - "channel-class semantics must remain invariant"
          - "governance messages require replay protection"
      schemas:
        - id: "SCH-0017"
          path: "apm2.hmp_message.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Digest-first inter-holon envelope"
        - id: "SCH-0018"
          path: "apm2.receipt_pointer.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Receipt pointer with batch or FactRoot proof path"
        - id: "SCH-0019"
          path: "apm2.receipt_multi_proof.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Merkle multiproof for batch receipt verification"
        - id: "SCH-0019A"
          path: "apm2.admission_receipt.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Typed acceptance receipt for imported authoritative cross-cell facts"
        - id: "SCH-0019B"
          path: "apm2.import_receipt.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Alias-compatible import acceptance receipt schema"
      evidence_ids: ["EVID-0206"]

    - id: "CTR-0007"
      name: "Batch economics and BFT composition contracts"
      type: "ARTIFACT_SCHEMA"
      versioning:
        scheme: "SEMVER + CHECKPOINT_COMPOSITION"
        current_version: "1.0.0"
        compatibility_rules:
          - "BFT cells must support FactRoot checkpoint composition path"
          - "overhead gates (<1% p99) are normative for production ratchet"
      schemas:
        - id: "SCH-0020"
          path: "apm2.fact_root.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Checkpoint fact aggregation root"
        - id: "SCH-0021"
          path: "apm2.receipt_batch_descriptor.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Canonical batch descriptor and hash/order rules"
        - id: "SCH-0022"
          path: "apm2.batch_epoch_root.v1"
          format: "PROTOBUF_OR_CANONICAL_JSON"
          description: "Root-of-roots commitment for exabyte traversal"
      evidence_ids: ["EVID-0207"]

    - id: "CTR-0008"
      name: "Syscall families and ToolKinds"
      type: "ABI_SURFACE"
      versioning:
        scheme: "ROUTE_ID + SCHEMA_ID"
        current_version: "1.0.0"
        compatibility_rules:
          - "authoritative routes cannot accept raw untyped command strings"
          - "idempotency + precondition guards required for side-effectful ToolKinds"
      schemas:
        - id: "SCH-0023"
          path: "hsi.session.*"
          format: "ROUTE_SET"
          description: "Session and identity routes"
        - id: "SCH-0024"
          path: "hsi.context.*"
          format: "ROUTE_SET"
          description: "Context malloc/delta and context firewall semantics"
        - id: "SCH-0025"
          path: "hsi.tool.*"
          format: "ROUTE_SET"
          description: "Tool actuation and receipt binding routes"
      evidence_ids: ["EVID-0208"]

  outputs:
    artifacts_produced:
      - "HSIContractManifestV1"
      - "CapabilityManifestV1"
      - "EpisodeEnvelopeV1"
      - "ViewCommitmentV1"
      - "FreshnessPinsetV1"
      - "AgentAdapterProfileV1 / RoleSpecV1"
      - "ContextDeltaV1 / ContextIndexV1 / EvidenceIndexV1"
      - "ContextRefinementRequestV1 / CapabilityUpgradeRequestV1 / OracleRequestV1"
      - "Cell/holon certificates and directory artifacts"
      - "AuthoritySealV1 / EpochSealV1"
      - "AdmissionReceiptV1 / ImportReceiptV1"
      - "ReceiptPointerV1 / ReceiptMultiProofV1 / ReceiptBatchDescriptorV1 / BatchEpochRootV1"
      - "PermeabilityReceiptV1 and delegation chain commitments"

    failure_modes:
      - "contract_hash_mismatch"
      - "identity_proof_unverifiable"
      - "freshness_policy_missing_or_ambiguous"
      - "delegation_not_strict_subset"
      - "proof_bytes_exceeded"
      - "batch_root_not_checkpoint_composed_in_bft_mode"
      - "authoritative_import_missing_admission_receipt"
      - "selector_coverage_violation"

  source_bindings:
    section_refs:
      - "HOLONIC_SUBSTRATE_INTERFACE.md §1.5"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §1.7"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §1.8"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §1.9"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §3"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §5"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §6"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §7.3"
      - "HOLONIC_SUBSTRATE_INTERFACE.md §9.5"
