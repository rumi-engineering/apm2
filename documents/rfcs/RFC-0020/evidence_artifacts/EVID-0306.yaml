evidence_artifact:
  schema_version: "2026-02-10"
  id: "EVID-0306"
  title: "Rollout phase S2.5/S2.6 attestation batching and fallback benchmark evidence"
  category: "PERF_BENCHMARK"
  status: "PASS"
  description: |
    Rollout evidence for RFC-0020 phase S2.5/S2.6 (attestation batching and
    overhead gating), delivered by TCK-00372.

    This artifact captures measured benchmark outputs for batched attestation
    verification against direct verification, including:
    - direct measurements at `10^3`, `10^4`, and `10^5` effects,
    - bootstrap-modeled `10^6` and `10^8` p99 envelopes,
    - `10^12` projection from the modeled high-scale points,
    - `<1%` p99 CPU/network overhead gate compliance,
    - automatic fallback to direct verification when degradation/integrity/
      freshness failures occur,
    - fail-closed behavior when fallback material is unavailable or invalid.
  requirement_ids:
    - "REQ-0026"
  source_refs:
    - "documents/rfcs/RFC-0020/requirements/REQ-0026.yaml"
    - "crates/apm2-core/src/consensus/attestation_overhead.rs"
    - "crates/apm2-daemon/src/identity/receipt_pointer.rs"
    - "crates/apm2-daemon/tests/tck_00372_attestation_overhead.rs"
  artifacts:
    - type: "benchmark_output"
      description: |
        Integrated attestation overhead benchmark + projection output:
        - `batch_size=256` benchmark run
        - direct-measurement scales (`10^3`, `10^4`, `10^5`)
        - bootstrap-modeled p99 envelopes for `10^6` and `10^8`
        - projected overhead ratios for `10^12`
      ref:
        - "cargo test -p apm2-daemon --test tck_00372_attestation_overhead -- --nocapture"
        - "evidence/rfc/RFC-0020/perf/tck_00372/tck_00372_attestation_overhead.log"
        - "evidence/rfc/RFC-0020/perf/tck_00372/measurement_snapshot.json"
    - type: "test_output"
      description: |
        Fallback trigger coverage in the integrated TCK harness:
        - integrity failure triggers automatic direct fallback
        - freshness failure triggers automatic direct fallback
        - degradation (overhead gate breach) triggers direct fallback
        - quorum batch path preserves fail-closed semantics under mismatched direct fallback material
      ref:
        - "cargo test -p apm2-daemon --test tck_00372_attestation_overhead -- --nocapture"
    - type: "test_output"
      description: |
        Additional unit-level fallback assertions (fail-closed):
        - verify_batch_falls_back_to_direct_on_integrity_failure
        - verify_batch_falls_back_to_direct_on_freshness_failure
        - verify_batch_falls_back_to_direct_on_degradation_overhead_gate
        - verify_batch_fail_closed_when_fallback_is_unavailable
        - verify_batch_fail_closed_when_fallback_receipt_mismatches
      ref:
        - "cargo test -p apm2-daemon identity::receipt_pointer::tests::verify_batch_falls_back_to_direct_on_ -- --nocapture"
        - "cargo test -p apm2-daemon identity::receipt_pointer::tests::verify_batch_fail_closed_when_ -- --nocapture"
    - type: "log_bundle"
      description: "Captured fallback activation and fail-closed logs for S2.5/S2.6 rollout evidence."
      ref:
        - "evidence/rfc/RFC-0020/perf/tck_00372/tck_00372_fallback_activation.log"
        - "evidence/rfc/RFC-0020/perf/tck_00372/tck_00372_fail_closed_fallback.log"
        - "evidence/rfc/RFC-0020/perf/tck_00372/fallback_summary.json"
