evidence_artifact:
  schema_version: "2026-02-05"
  id: "EVID-0303"
  title: "Rollout phase S0.75 evidence"
  category: "UNIT_TEST_RESULT"
  status: "PASS"
  description: |
    Evidence for rollout phase S0.75 gate: canonical key identifier types
    (PublicKeyIdV1 and KeySetIdV1) are implemented with strict grammar
    enforcement, lossless binary/text round-trips, and cross-language
    conformance vectors (TCK-00353). Stable genesis-derived identity types
    (CellIdV1 and HolonIdV1) derive deterministically from CellGenesisV1 and
    HolonGenesisV1 commitments with CAS hash-addressing round-trip evidence
    (TCK-00354). Certificate hierarchy and session-key delegation are enforced
    via CellCertificateV1, HolonCertificateV1, and SessionKeyDelegationV1 with
    explicit root/operational/session role separation (TCK-00355, REQ-0009).
  requirement_ids:
    - "REQ-0007"
    - "REQ-0008"
    - "REQ-0009"
  source_refs:
    - "crates/apm2-daemon/src/identity/mod.rs"
    - "crates/apm2-daemon/src/identity/public_key_id.rs"
    - "crates/apm2-daemon/src/identity/keyset_id.rs"
    - "crates/apm2-daemon/src/identity/cell_id.rs"
    - "crates/apm2-daemon/src/identity/holon_id.rs"
    - "crates/apm2-daemon/src/identity/certificate.rs"
    - "crates/apm2-daemon/src/identity/session_delegation.rs"
    - "crates/apm2-daemon/src/cas/mod.rs"
    - "crates/apm2-daemon/src/identity/conformance.rs"
    - "documents/rfcs/RFC-0020/evidence_artifacts/EVID-0009.yaml"
  artifacts:
    - type: "test_output"
      description: |
        Canonical key identifier conformance tests (TCK-00353) covering:
        - 5 valid PublicKeyIdV1 vectors (ed25519 algorithm)
        - 4 valid KeySetIdV1 vectors (multisig and threshold modes)
        - 32 invalid input vectors (mixed case, whitespace, padding, wrong prefix,
          truncated, invalid hex, too long, percent-encoding, Unicode normalization)
        - Parser differential tests (text vs binary parsers agree)
        - Binary-text-binary lossless round-trip verification (merkle-root level
          for KeySetIdV1 since text form does not encode the set tag)
        - Descriptor validation tests (empty members, threshold bounds, weights alignment)
        - Deterministic canonicalization (weighted keyset order independence)
      ref: "cargo test -p apm2-daemon identity::conformance"
    - type: "test_output"
      description: |
        Stable genesis-derived identity conformance tests (TCK-00354) covering:
        - CellIdV1: deterministic derivation, collision resistance
          (ledger hash, policy root, policy root variant), trust-domain
          invariants, key rotation preservation, genesis canonical bytes
          determinism, text/binary/text-then-binary round-trips, grammar
          enforcement, fail-closed rejection vectors, and genesis artifact CAS
          round-trip + deduplication via DurableCas
        - HolonIdV1: deterministic derivation, collision resistance
          (cell ID, genesis key), metadata invariants, key rotation preservation,
          genesis canonical bytes determinism, text/binary/text-then-binary
          round-trips, grammar enforcement, fail-closed rejection vectors,
          public key and anchor validation, HolonPurpose parsing, and genesis
          artifact CAS round-trip + deduplication via DurableCas
      ref: "cargo test -p apm2-daemon identity::"
    - type: "test_output"
      description: |
        Certificate hierarchy and session delegation tests (TCK-00355) covering:
        - CellCertificateV1 / HolonCertificateV1 binding verification
        - fail-closed trust-domain, purpose-tag, revocation-pointer, and key-length validation
        - root/operational/session key role overlap rejection
        - SessionKeyDelegationV1 HTF validity windows and operational-key signature verification
        - deterministic length-prefixed canonical bytes and CAS round-trip
        - key-role conformance vectors in identity::conformance
      ref: "cargo test -p apm2-daemon identity::certificate identity::session_delegation identity::conformance::tests::key_role_conformance_vectors_pass"
