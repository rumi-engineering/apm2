evidence_artifact:
  schema_version: "2026-01-23"
  id: "EVID-0035"
  title: "Pull-only anti-entropy boundedness and Byzantine relay resistance evidence"
  category: "UNIT_TEST_RESULT"
  status: "PASS"
  description: |
    Evidence that RFC-0020 anti-entropy wire negotiation and enforcement
    satisfies REQ-0035:
    - Offer/compare/request/deliver negotiation is pull-only and bounded.
    - Unsolicited deliveries are denied with structured defects.
    - Relay budgets enforce per-session events/bytes, fanout caps, and
      concurrent session limits.
    - Replay protection rejects duplicate/non-monotone issuer messages using
      HLC + monotone sequence checks.
    - Byzantine tampering (hash/digest mismatch, reorder, replay, fanout
      amplification) is detected and denied.
    - Partition/rejoin simulation converges under revocation-wins CRDT merge
      semantics and keeps revoked entries revoked after rejoin.

    This artifact is the primary evidence for REQ-0035 and complements
    EVID-0309 (epoch-seal policy wiring evidence) without redefining it.
  requirement_ids:
    - "REQ-0035"
  source_refs:
    - "crates/apm2-core/src/consensus/hsi_anti_entropy.rs"
    - "crates/apm2-core/src/consensus/convergence.rs"
    - "documents/rfcs/RFC-0020/evidence_artifacts/EVID-0309.yaml"
  artifacts:
    - type: "test_output"
      description: |
        Offer/compare/request/deliver conformance and pull-only enforcement:
        - tck_00381_offer_compare_request_deliver_happy_path
        - tck_00381_pull_only_unsolicited_deliver_rejected
        - tck_00381_invalid_attestation_denied
      ref: "cargo test -p apm2-core consensus::hsi_anti_entropy::tests::tck_00381_offer_compare_request_deliver_happy_path -- --exact"
    - type: "test_output"
      description: |
        Replay, budget, and Byzantine relay attack resistance:
        - tck_00381_budget_enforcement_denies_after_exhaustion
        - tck_00381_replay_protector_rejects_duplicate_offers_and_delivers
        - tck_00381_byzantine_detector_tampered_and_fanout_caught
        - tck_00381_byzantine_relay_simulation_drop_duplicate_reorder_lie
        - tck_00381_budget_exhaustion_under_adversarial_load
      ref: "cargo test -p apm2-core consensus::hsi_anti_entropy::tests::tck_00381_ -- --test-threads=1"
    - type: "test_output"
      description: |
        Partition/rejoin convergence under revocation-wins semantics:
        - tck_00381_partition_rejoin_revocation_wins
        - tck_00381_partition_rejoin_admissions_converge_bounded_rounds
        - tck_00381_pull_round_is_bounded
      ref: "cargo test -p apm2-core consensus::convergence::tests::tck_00381_ -- --test-threads=1"
    - type: "linked_artifact"
      description: |
        Existing epoch-seal and policy integration evidence referenced by this
        requirement set (no changes in this ticket).
      ref: "documents/rfcs/RFC-0020/evidence_artifacts/EVID-0309.yaml"
