evidence_artifact:
  schema_version: "2026-01-23"
  id: "EVID-0032"
  title: "Dual lattice taint/classification propagation correctness evidence"
  category: "UNIT_TEST_RESULT"
  status: "PASS"
  description: |
    Evidence that the dual-lattice taint/classification propagation engine
    correctly enforces RFC-0020 Section 5 security properties:
    - TaintLevel join lattice laws (commutative, associative, idempotent, identity, absorbing, monotone)
    - ConfidentialityLevel join and meet lattice laws (full lattice axioms including absorption)
    - DataLabel join propagation (both dimensions elevate correctly)
    - BoundaryPolicy enforcement (taint ceiling, confidentiality clearance, fail-closed)
    - DualLatticePolicy boundary crossing (deny-all default, tier-gated actuators)
    - Taint propagation via free functions (monotonic, identity on empty)
    - Duplicate boundary/rule ID rejection at policy construction time
    - RFC/schema confidentiality taxonomy mapping (lossless roundtrip, fail-closed on unmapped)

    141 unit tests + 26 proptest property-based tests covering lattice axioms.
    Includes mandatory 32-byte BLAKE3 digest enforcement for effect-binding
    hashes and expiry-based anti-replay eviction.
  requirement_ids:
    - "REQ-0032"
  source_refs:
    - "crates/apm2-core/src/policy/taint.rs"
  artifacts:
    - type: "test_output"
      description: |
        Taint propagation correctness tests (141 unit + 26 proptest):
        TaintLevel lattice:
        - taint_join_is_commutative: join(a,b) == join(b,a) for all pairs
        - taint_join_is_associative: join(join(a,b),c) == join(a,join(b,c)) for all triples
        - taint_join_is_idempotent: join(a,a) == a for all levels
        - taint_join_selects_higher: join picks least trusted
        - taint_within_ceiling: within_ceiling boundary check
        - taint_from_ordinal_roundtrip: ordinal encoding lossless
        - taint_ordering: total order Untainted < LowTaint < MediumTaint < HighTaint < Toxic
        - taint_default_is_untainted: default is identity element
        ConfidentialityLevel lattice:
        - conf_meet_is_commutative/associative/idempotent: meet lattice laws
        - conf_meet_selects_lower: meet picks lower clearance
        - conf_join_selects_higher/is_commutative: join lattice laws
        - conf_within_clearance: clearance boundary check
        - conf_from_ordinal_roundtrip: ordinal encoding lossless
        - conf_ordering: total order Public < Internal < Confidential < Secret < TopSecret
        DataLabel:
        - data_label_join_propagates_both: both dimensions elevate
        - data_label_join_is_commutative: join commutative over pairs
        BoundaryPolicy:
        - boundary_allows_clean_data: below-threshold data passes
        - boundary_rejects_high_taint: taint ceiling enforced
        - boundary_rejects_high_confidentiality: clearance enforced
        - boundary_at_exact_limits: edge-case at exact threshold passes
        - boundary_rejects_empty_id/long_id: input validation
        DualLatticePolicy:
        - dual_policy_tier3/4 enforcement: tier-gated actuator checks
        - dual_policy_unknown_boundary_fails_closed: fail-closed on unknown
        - dual_policy_deny_all_rejects_everything: empty policy denies all
        - actuator_tier_below_3_passes_without_boundary: low tiers not gated
        - duplicate_boundary_id_rejected: rejects duplicate boundary IDs
        - duplicate_rule_id_rejected: rejects duplicate rule IDs
        - unique_boundary_and_rule_ids_accepted: unique IDs pass
        Propagation:
        - propagate_taint/classification functions: monotone, identity on empty
        - propagation_denies_over_confidential_without_receipt: no implicit declassification
        - adversarial_propagation_denies_implicit_declassification: comprehensive implicit deny
        RFC taxonomy:
        - rfc_from_level_roundtrip: all RFC levels round-trip losslessly
        - rfc_top_secret_has_no_mapping: TopSecret fail-closed
        - rfc_from_str_valid_levels/unknown_rejected: string parsing fail-closed
        - rfc_cross_layer_compatibility: cross-layer mapping for ordinals 0-3
        Proptest (26 property-based tests):
        - Lattice axioms verified over random inputs for TaintLevel, ConfidentialityLevel, DataLabel
        - Absorption law verified for ConfidentialityLevel meet/join interaction
        - Propagation function correctness and monotonicity
      ref: "cargo test -p apm2-core taint"
