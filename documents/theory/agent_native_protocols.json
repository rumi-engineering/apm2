{
  "schema": "cac.protocol_bundle.v1",
  "meta": {
    "title": "Agent-Native Software Factory: Protocols & Doctrine",
    "version": "1.0.0",
    "created_at": "2026-02-04T22:27:53.975717Z",
    "description": "Normative definitions, architectural doctrines, and implementation protocols for the durable, auditable work substrate."
  },
  "payload": {
    "doctrines": [
      {
        "id": "DOC-SPEC-STATE-SEP",
        "name": "Spec/State Separation",
        "rule": "Strict separation between specification content (schema-validated YAML) and workflow state (derived from event record). Workflow state MUST NOT be inferred from filesystem scans or branch names."
      },
      {
        "id": "DOC-EVENT-AUTHORITY",
        "name": "Event Authority",
        "rule": "Append-only event log is the authoritative record. Projections are computed by deterministic reducers."
      },
      {
        "id": "DOC-INTERNAL-FORGE",
        "name": "Internal Forge Model",
        "rule": "Forge semantics (proposal, review, acceptance) are native work semantics. ChangeSets are not synonymous with branches. Merges are governed state transitions yielding Merge Receipts."
      },
      {
        "id": "DOC-GATE-PROTOCOL",
        "name": "Gate Protocol",
        "rule": "Verification gates are protocols with evidence contracts. Decisions must be backed by EvidenceBundles stored in CAS. AAT is an independent gate."
      },
      {
        "id": "DOC-RECURRENCE-LOOP",
        "name": "Recurrence Loop",
        "rule": "Repeated issues indicate factory control failure. Normalized FindingSignatures drive recurrence metrics, triggering Countermeasure work to improve guardrails."
      },
      {
        "id": "DOC-HARDENING-CYCLE",
        "name": "Hardening Cycle",
        "rule": "Lifecycle includes post-implementation hardening cycles for refactoring, simplification, and integration coherence. Stopping condition is measurable reduction of complexity."
      }
    ],
    "protocols": [
      {
        "id": "PROTO-GATE-EXEC",
        "steps": [
          "Load rubric and evidence schema.",
          "Instantiate runner with allowed tools and budget.",
          "Execute checks/tests.",
          "Emit Findings with signatures.",
          "Publish EvidenceBundle (raw outputs, digests, provenance).",
          "Emit GateRun event with decision (Pass/Fail/Escalate)."
        ]
      },
      {
        "id": "PROTO-MERGE",
        "steps": [
          "Acquire lease (exclusive authority).",
          "Verify input digests (Plan-of-Record, ChangeSet, GateRuns, Decisions).",
          "Verify repository state digest.",
          "Apply patch/update refs.",
          "Emit Merge Receipt event binding inputs to output state.",
          "Release lease."
        ]
      },
      {
        "id": "PROTO-RECURRENCE",
        "steps": [
          "Normalize Finding fields.",
          "Compute FindingSignature.",
          "Reducer updates recurrence counts/rates.",
          "If threshold exceeded: Schedule Countermeasure.",
          "Implement Countermeasure (guardrail update).",
          "Verify Countermeasure (corpus replay evidence).",
          "Deploy Countermeasure with rollback plan."
        ]
      }
    ],
    "prescriptions": {
      "language": "Rust",
      "serialization": "prost (Protocol Buffers) for events, serde_yaml/schemars for specs",
      "hashing": "blake3",
      "signing": "ed25519-dalek",
      "storage": "rusqlite (SQLite with WAL) for local durability",
      "git_interaction": "gix (gitoxide) for deterministic inspection",
      "secrets": "secrecy, zeroize, chacha20poly1305 for sensitive artifacts",
      "observability": "tracing for structured instrumentation",
      "policy": "cedar-policy for authority rules"
    }
  }
}