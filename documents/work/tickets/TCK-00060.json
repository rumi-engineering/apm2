{
  "schema": "apm2.ticket.v1",
  "ticket_meta": {
    "schema_version": "2026-01-24",
    "template_version": "2026-01-24",
    "ticket": {
      "id": "TCK-00060",
      "title": "Add Historical Issue Patterns to Security Review Prompt"
    },
    "binds": {
      "prd_id": "NONE",
      "rfc_id": "RFC-0006",
      "requirements": [
        {
          "requirement_id": "MAINT-008",
          "requirement_ref": "documents/rfcs/RFC-0006/01_problem_and_imports.yaml#rfc_local_requirements.requirements[2]"
        }
      ],
      "evidence_artifacts": []
    },
    "custody": {
      "agent_roles": [
        "AGENT_IMPLEMENTER"
      ],
      "responsibility_domains": [
        "DOMAIN_SECURITY"
      ]
    },
    "dependencies": {
      "tickets": []
    },
    "scope": {
      "in_scope": [
        "Add 'Historical Issue Patterns (Check First)' section to SECURITY_REVIEW_PROMPT.md",
        "Document state machine restart logic patterns (session ID collision, missing state tracking fields, monotonicity violations)",
        "Document temp file handling patterns (predictable names, world-readable permissions, missing cleanup)",
        "Document shell/process spawning patterns (argument escaping with markdown, env inheritance, headless mode failures)",
        "Document struct field addition patterns (incomplete pattern matches, missing field handling in all match arms)",
        "Position the section early in the document for high visibility during reviews",
        "Reference actual findings from PR #58 and #59 as concrete examples"
      ],
      "out_of_scope": [
        "Changes to other review prompts (code quality, etc.)",
        "Modifying the security review workflow or tooling",
        "Adding automated pattern detection (covered by MAINT-012)"
      ]
    },
    "plan": {
      "steps": [
        "Read the current SECURITY_REVIEW_PROMPT.md to understand structure and positioning",
        "Identify the optimal location for the historical patterns section (after section 0 Inputs, before section 1 SCP determination)",
        "Create new section '0.5) Historical Issue Patterns (Check First)' with introduction explaining purpose",
        "Add subsection for state machine restart logic patterns with B1/B2/B3 issues from RFC-0006",
        "Add subsection for temp file handling patterns with A3 issue from RFC-0006",
        "Add subsection for shell/process spawning patterns with A1/A2 issues from RFC-0006",
        "Add subsection for struct field addition patterns with C1 issue from RFC-0006",
        "For each pattern, include: what to look for, why it's a problem, and how to verify the fix",
        "Ensure patterns reference concrete PR examples (PR #58, #59) for credibility",
        "Run verification: grep 'Historical Issue Patterns' documents/reviews/SECURITY_REVIEW_PROMPT.md"
      ]
    },
    "definition_of_done": {
      "evidence_ids": [],
      "criteria": [
        "SECURITY_REVIEW_PROMPT.md contains 'Historical Issue Patterns (Check First)' section",
        "Section includes state machine restart logic patterns (session ID collision, state tracking fields, monotonicity)",
        "Section includes temp file handling patterns (predictable names, permissions, cleanup)",
        "Section includes shell/process spawning patterns (argument escaping, env inheritance, headless mode)",
        "Section includes struct field addition patterns (incomplete pattern matches)",
        "Each pattern category includes what to look for, why it's a problem, and verification approach",
        "Patterns reference actual PR findings for concrete examples",
        "grep 'Historical Issue Patterns' documents/reviews/SECURITY_REVIEW_PROMPT.md succeeds",
        "Document renders correctly as markdown"
      ]
    },
    "notes": {
      "security": "This ticket enhances security review by codifying learned patterns from actual incidents",
      "context": "Patterns derived from issues discovered during PR #58 (crash detection/restart logic) and PR #59",
      "issue_categories": "A1/A2/A3 (tool reliability), B1/B2/B3 (state machine bugs), C1/C2/C3 (compile/lint errors)"
    }
  }
}
