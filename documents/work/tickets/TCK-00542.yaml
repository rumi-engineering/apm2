ticket_meta:
  schema_version: "2026-01-29"
  template_version: "2026-01-29"
  ticket:
    id: "TCK-00542"
    title: "Evidence bundle schemas in code: manifest+envelope + hashing + bounded parsing + export/import integration"
    status: "OPEN"
  binds:
    prd_id: "PRD-PLACEHOLDER"
    rfc_id: "RFC-0019"
    requirements: []
    evidence_artifacts: []
  custody:
    agent_roles: ["AGENT_IMPLEMENTER"]
    responsibility_domains: ["DOMAIN_SECURITY", "DOMAIN_RUNTIME"]
  dependencies:
    tickets:
      - ticket_id: "TCK-00527"
        reason: "Export/import commands need formal schemas and validation."
  scope:
    in_scope:
      - "Define `apm2.fac.evidence_bundle_manifest.v1` and `apm2.fac.evidence_bundle_envelope.v1` structs with deny_unknown_fields."
      - "Implement canonical hashing rules and b3-256 addressing."
      - "Implement bounded parsing for import; fail-closed on unknown/malformed fields."
      - "Ensure `channel_boundary_check` is required for import/export operations."
    out_of_scope:
      - "Network transport."
  plan:
    steps:
      - "Define structs and hashing helpers."
      - "Refactor export/import to use them."
  definition_of_done:
    evidence_ids: []
    criteria:
      - "Bundle import refuses malformed or oversized manifests/envelopes."
      - "Bundle hashes are stable and deterministic."
