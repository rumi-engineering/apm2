ticket_meta:
  schema_version: "2026-01-29"
  template_version: "2026-01-29"
  ticket:
    id: "TCK-00529"
    title: "System-mode execution path: run jobs without user-bus dependency (broker-managed transient units)"
    status: "OPEN"
  binds:
    prd_id: "PRD-PLACEHOLDER"
    rfc_id: "RFC-0019"
    requirements: []
    evidence_artifacts: []
  custody:
    agent_roles: ["AGENT_IMPLEMENTER"]
    responsibility_domains: ["DOMAIN_RUNTIME", "DOMAIN_SECURITY"]
  dependencies:
    tickets:
      - ticket_id: "TCK-00528"
        reason: "Needs service deployment model for broker/worker."
      - ticket_id: "TCK-00515"
        reason: "Needs lanes and lane profiles."
  scope:
    in_scope:
      - "Add an execution backend that does NOT require `systemd-run --user`."
      - "Broker (or worker) creates system-scoped transient units (or uses a system service template) for job execution."
      - "Jobs run as a dedicated low-privilege service user, with KillMode=control-group."
      - "Preserve the same semantics: lane lease -> bounded unit -> streaming logs -> receipts."
      - "Auto-select backend: prefer system-mode if configured, otherwise user-mode with explicit failure messaging."
    out_of_scope:
      - "Containers/VM sandboxing."
  plan:
    steps:
      - "Implement systemd D-Bus integration or a safe wrapper for system transient units."
      - "Implement backend selection + clear diagnostic errors."
      - "Add kill/stop support used by cancellation and lane reset."
  definition_of_done:
    evidence_ids: []
    criteria:
      - "On a headless VPS without a working user-bus, FAC jobs can still run bounded via system-mode backend."
      - "Cgroup membership is correct (child processes remain inside the job unit)."
