ticket_meta:
  schema_version: "2026-01-29"
  template_version: "2026-01-29"
  ticket:
    id: "TCK-00521"
    title: "FacPolicyV1: implement authoritative policy object + hashing + policy binding for RFC-0028"
    status: "OPEN"
  binds:
    prd_id: "PRD-PLACEHOLDER"
    rfc_id: "RFC-0019"
    requirements: []
    evidence_artifacts: []
  custody:
    agent_roles: ["AGENT_IMPLEMENTER"]
    responsibility_domains: ["DOMAIN_SECURITY"]
  dependencies:
    tickets:
      - ticket_id: "TCK-00510"
        reason: "Broker must admit/publish policy digests used for RFC-0028 policy binding."
  scope:
    in_scope:
      - "Implement `FacPolicyV1` struct, canonicalization, and `FacPolicyHash` computation (b3-256)."
      - "Persist policy to `$APM2_HOME/private/fac/policy/fac_policy.v1.json` (inspection) and record hash in receipts."
      - "Include env clear/allowlist/denylist prefixes; enforced env_set for CARGO_HOME/CARGO_TARGET_DIR/etc."
      - "Bind RFC-0028 channel boundary checks to admitted policy digest; deny if mismatch."
    out_of_scope:
      - "User-facing policy editor UI."
  plan:
    steps:
      - "Define policy schema + default policy for current host class."
      - "Integrate policy hash into gate attestation and receipts."
      - "Broker publishes admitted policy digest; worker validates binding."
  definition_of_done:
    evidence_ids: []
    criteria:
      - "Changing policy changes FacPolicyHash and invalidates cache reuse."
      - "Authorization tokens fail validation if policy digest binding mismatches."
