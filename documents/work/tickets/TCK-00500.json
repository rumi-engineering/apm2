{
  "schema": "apm2.ticket.v1",
  "ticket_meta": {
    "schema_version": "2026-01-29",
    "template_version": "2026-01-29",
    "ticket": {
      "id": "TCK-00500",
      "title": "Ledger trust stack: RootTrustBundle, trusted seals, checkpoint-bounded startup, and governance-derived PolicyRootResolver",
      "status": "CLOSED"
    },
    "binds": {
      "prd_id": "PRD-0010",
      "rfc_id": "RFC-0019",
      "requirements": [
        {
          "requirement_id": "REQ-0028",
          "requirement_ref": "documents/rfcs/RFC-0019/requirements/REQ-0028.yaml#requirement"
        }
      ],
      "evidence_artifacts": [
        {
          "evidence_id": "EVID-0023",
          "artifact_ref": "documents/rfcs/RFC-0019/evidence_artifacts/EVID-0023.yaml#evidence_artifact"
        }
      ]
    },
    "custody": {
      "agent_roles": [
        "AGENT_IMPLEMENTER",
        "AGENT_REVIEWER",
        "AGENT_QA"
      ],
      "responsibility_domains": [
        "DOMAIN_SECURITY",
        "DOMAIN_RUNTIME",
        "DOMAIN_GOVERNANCE"
      ]
    },
    "dependencies": {
      "tickets": [
        {
          "ticket_id": "TCK-00487",
          "reason": "Addendum defines trust-stack semantics."
        },
        {
          "ticket_id": "TCK-00499",
          "reason": "Crypto-agility hardening is required for algorithm-id dispatch and signature verification policy."
        }
      ]
    },
    "scope": {
      "in_scope": [
        "Implement RootTrustBundle loading and crypto-agile key dispatch for ledger + governance verification.",
        "Implement trusted seal/checkpoint mechanism:",
        "  - seal event payload commits to LedgerAnchorV1 (ledger_id + hash + height + HT),",
        "  - seal signature provenance chains to RootTrustBundle.",
        "Implement checkpoint-bounded startup validation from trusted seal to tip; enforce max seal-to-tip distance policy.",
        "Implement LedgerTrustVerifier interface returning ValidatedLedgerStateV1 (validated_anchor + tip_anchor + keyset digests).",
        "Implement PolicyRootResolver that derives PolicyRootStateV1 deterministically from governance-class events up to a given LedgerAnchorV1.",
        "Implement fork/divergence detection required by ยง2.3 (validated anchor must chain to tip).",
        "Implement key rotation/revocation semantics as-of anchor/epoch (no 'always latest keyset' behavior)."
      ],
      "out_of_scope": [
        "Anti-rollback external anchoring (TCK-00502).",
        "Changing the ledger storage format (unless required to add seals)."
      ]
    },
    "plan": {
      "steps": [
        "Define RootTrustBundle schema (bounded, deny_unknown_fields) including algorithm ids + kids.",
        "Add governance-signed seal event type and store emission path (admin/automation triggered).",
        "Implement startup verifier: verify seal, then verify chain+signatures+HT monotonicity from seal to tip.",
        "Implement PolicyRootResolver with caching keyed by (policy_root_epoch, ledger_anchor).",
        "Add tests: tamper detection, fork/divergence detection, seal distance bound enforcement, key rotation semantics."
      ]
    },
    "definition_of_done": {
      "evidence_ids": [
        "EVID-0023"
      ],
      "criteria": [
        "Authoritative mode refuses startup or denies admission if ledger trust cannot be established.",
        "PolicyRootResolver is governance-only and signature-verified.",
        "Startup validation is checkpoint-bounded and fails closed when bounds are exceeded.",
        "Tamper/fork tests exist and pass in CI.",
        "Key rotation semantics are anchor/epoch correct and tested."
      ]
    },
    "notes": {
      "security": "This ticket makes 'ledger below PCAC' real. Without it, `as_of_ledger_anchor` is a paper promise.\nRollback resistance requires external anchoring and is handled in TCK-00502.\n",
      "verification": "Evidence includes unit + integration tests for seal verification, chain validation, and governance-only policy root derivation.\n"
    }
  }
}
