{
  "schema": "apm2.ticket.v1",
  "ticket_meta": {
    "schema_version": "2026-01-29",
    "template_version": "2026-01-29",
    "ticket": {
      "id": "TCK-00290",
      "title": "Session dispatcher viability: RequestTool execution + real EmitEvent/PublishEvidence",
      "status": "CLOSED"
    },
    "binds": {
      "prd_id": "PRD-0009",
      "rfc_id": "RFC-0018",
      "requirements": [
        {
          "requirement_id": "REQ-HEF-0010",
          "requirement_ref": "documents/rfcs/RFC-0018/requirements/REQ-HEF-0010.yaml#rfc_requirement"
        }
      ],
      "evidence_artifacts": [
        {
          "evidence_id": "EVID-HEF-0010",
          "artifact_ref": "documents/rfcs/RFC-0018/evidence_artifacts/EVID-HEF-0010.yaml#rfc_evidence_artifact"
        }
      ]
    },
    "custody": {
      "agent_roles": [
        "AGENT_IMPLEMENTER"
      ],
      "responsibility_domains": [
        "DOMAIN_RUNTIME",
        "DOMAIN_SECURITY"
      ]
    },
    "dependencies": {
      "tickets": [
        {
          "ticket_id": "TCK-00287",
          "reason": "ProtocolServer routing cutover is required for session dispatcher reachability."
        },
        {
          "ticket_id": "TCK-00286",
          "reason": "Context firewall fail-closed fixes must land before enabling session tool execution."
        },
        {
          "ticket_id": "TCK-00292",
          "reason": "RequestTool decisions must use real policy engine (no stub allow)."
        },
        {
          "ticket_id": "TCK-00293",
          "reason": "PublishEvidence must store artifacts in durable CAS."
        }
      ]
    },
    "scope": {
      "in_scope": [
        "Wire RequestTool to ToolBroker execution (no stub Allow path).",
        "Require manifest store; deny when unavailable (fail-closed).",
        "Implement real EmitEvent and PublishEvidence (ledger + CAS).",
        "Make StreamTelemetry real or explicitly disabled until implemented."
      ],
      "out_of_scope": [
        "HEF pulse subscription handling."
      ]
    },
    "plan": {
      "steps": [
        "Replace stub RequestTool allow with ToolBroker execution path.",
        "Implement EmitEvent and PublishEvidence via ledger/CAS.",
        "Remove stub responses and add fail-closed tests."
      ]
    },
    "definition_of_done": {
      "evidence_ids": [
        "EVID-HEF-0010"
      ],
      "criteria": [
        "RequestTool executes via ToolBroker and returns ToolResult or Deny.",
        "EmitEvent persists ledger events (no stub response).",
        "PublishEvidence stores artifacts in CAS and returns real hashes.",
        "StreamTelemetry is real or explicitly disabled (fail-closed)."
      ]
    },
    "notes": {
      "security": "Session endpoints must be fail-closed: no stub Allow path, no stub event\nacknowledgments, and evidence must be persisted via CAS/ledger.\n",
      "verification": "IT-00290-01: cargo test -p apm2-daemon session_request_tool_exec\nIT-00290-02: cargo test -p apm2-daemon session_event_evidence_persist\n",
      "general": "This is the minimum viable session control plane for implementor/reviewer workflows.\n"
    }
  }
}
