ticket_meta:
  schema_version: "2026-01-25"
  template_version: "2026-01-25"
  ticket:
    id: "TCK-00073"
    title: "Add Configurable AI Tool Backend for AAT"
  binds:
    prd_id: "NONE"
    rfc_id: "RFC-0006"
    requirements:
      - requirement_id: "AAT-001"
        requirement_ref: "documents/rfcs/RFC-0006/01_problem_and_imports.yaml#rfc_local_requirements.requirements[14]"
    evidence_artifacts: []
  custody:
    agent_roles:
      - "AGENT_IMPLEMENTER"
    responsibility_domains:
      - "DOMAIN_BUILD_RELEASE"
  dependencies:
    tickets: []
  scope:
    in_scope:
      - "Add AAT_AI_TOOL environment variable (default: gemini)"
      - "Support values: gemini, claude-code"
      - "Create AatToolConfig struct in xtask/src/aat/tool_config.rs"
      - "Add --ai-tool CLI flag override"
    out_of_scope:
      - "Additional AI tool backends beyond gemini and claude-code"
      - "Auto-detection of available AI tools"
  plan:
    steps:
      - "Create xtask/src/aat/tool_config.rs with AatToolConfig struct"
      - "Define AiTool enum with Gemini and ClaudeCode variants"
      - "Implement AatToolConfig::from_env() to read AAT_AI_TOOL"
      - "Add Default impl returning Gemini"
      - "Add --ai-tool flag to AatArgs in main.rs"
      - "Update xtask/src/aat/mod.rs to export tool_config module"
      - "Verify cargo build succeeds"
      - "Verify cargo test passes"
      - "Verify cargo clippy passes with no warnings"
  definition_of_done:
    evidence_ids: []
    criteria:
      - "AatToolConfig struct exists with from_env() method"
      - "AAT_AI_TOOL=gemini selects Gemini backend"
      - "AAT_AI_TOOL=claude-code selects Claude Code backend"
      - "--ai-tool flag overrides environment variable"
      - "Default is gemini when no env var or flag set"
      - "cargo build succeeds"
      - "cargo test passes"
      - "cargo clippy passes with no warnings"
  notes:
    implementation_details: |
      ```rust
      // xtask/src/aat/tool_config.rs
      use std::env;

      #[derive(Debug, Clone, Copy, PartialEq, Eq, Default)]
      pub enum AiTool {
          #[default]
          Gemini,
          ClaudeCode,
      }

      impl AiTool {
          pub fn command(&self) -> &'static str {
              match self {
                  AiTool::Gemini => "gemini",
                  AiTool::ClaudeCode => "claude",
              }
          }
      }

      #[derive(Debug, Clone)]
      pub struct AatToolConfig {
          pub ai_tool: AiTool,
      }

      impl AatToolConfig {
          pub fn from_env() -> Self {
              let ai_tool = env::var("AAT_AI_TOOL")
                  .ok()
                  .and_then(|v| match v.to_lowercase().as_str() {
                      "gemini" => Some(AiTool::Gemini),
                      "claude-code" | "claude" => Some(AiTool::ClaudeCode),
                      _ => None,
                  })
                  .unwrap_or_default();
              Self { ai_tool }
          }

          pub fn with_override(mut self, ai_tool: Option<AiTool>) -> Self {
              if let Some(tool) = ai_tool {
                  self.ai_tool = tool;
              }
              self
          }
      }
      ```
    affected_files: |
      New: xtask/src/aat/tool_config.rs
      Modified: xtask/src/aat/mod.rs (add module export)
      Modified: xtask/src/main.rs (add --ai-tool CLI flag)
