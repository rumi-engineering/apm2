acceptance_criteria:
  - criterion: ProtocolServer is the only daemon control-plane listener
    verification: Startup logs show only operator.sock + session.sock listeners
  - criterion: Legacy JSON IPC startup removed
    verification: No ipc_server::run invocation in default build
  - criterion: Legacy socket path is absent
    verification: ADV-012 cannot connect to daemon.sock
implementation:
  code_examples: []
  files_to_create: []
  files_to_modify:
    - changes: |
        Replace legacy IPC startup with ProtocolServer listeners for
        operator.sock and session.sock.
      path: crates/apm2-daemon/src/main.rs
    - changes: |
        Wire accept loop for ProtocolServer connections if not already present.
      path: crates/apm2-daemon/src/protocol/server.rs
  implementation_steps:
    - "Bind ProtocolServer for operator.sock + session.sock"
    - "Remove ipc_server::run usage from main"
  summary: "Hard cutover to ProtocolServer-only daemon entrypoint (DD-009)."
notes: |
  Phase: PHASE-1
  Added by Amendment A-001 (DD-009 hard cutover).
schema_version: "2026-01-26"
template_version: "2026-01-26"
test_requirements:
  - description: ProtocolServer-only startup
    test_id: INT-00279-01
    verification_command: cargo test -p apm2-daemon protocol_only_startup
ticket:
  depends_on:
    - TCK-00248
    - TCK-00249
  id: TCK-00279
  requirement_ids:
    - REQ-DCP-0001
    - REQ-DCP-0008
  rfc_id: RFC-0017
  status: READY
  title: ProtocolServer-only daemon entrypoint
