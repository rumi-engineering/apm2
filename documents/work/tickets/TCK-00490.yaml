ticket_meta:
  schema_version: "2026-01-29"
  template_version: "2026-01-29"
  ticket:
    id: "TCK-00490"
    title: "PCAC/AJC integration guide for implementor and security reviewer agents"
    status: "OPEN"
  binds:
    prd_id: "PRD-0009"
    rfc_id: "RFC-0027"
    requirements:
      - requirement_id: "REQ-0006"
        requirement_ref: "documents/rfcs/RFC-0027/requirements/REQ-0006.yaml#requirement"
    evidence_artifacts:
      - evidence_id: "EVID-0003"
        artifact_ref: "documents/rfcs/RFC-0027/evidence_artifacts/EVID-0003.yaml#evidence_artifact"
  custody:
    agent_roles:
      - "AGENT_IMPLEMENTER"
      - "AGENT_REVIEWER"
    responsibility_domains:
      - "DOMAIN_SECURITY"
      - "DOMAIN_RUNTIME"
      - "DOMAIN_DOCUMENTATION"
  dependencies:
    tickets:
      - ticket_id: "TCK-00484"
        reason: "PrivilegedPcacInputBuilder must exist before documenting the builder pattern for new handlers."
      - ticket_id: "TCK-00485"
        reason: "Declassification receipt PCAC integration provides a concrete non-RequestTool example."
  scope:
    in_scope:
      - "Create PCAC integration reference in documents/skills/rust-standards/references/ for inclusion in implementor and reviewer agent prompts."
      - "Content must cover:"
      - "  1. What PCAC/AJC is (single-use authorization token for side effects) — 1 paragraph, no jargon"
      - "  2. The 4-step lifecycle (join → revalidate → consume → effect) with what each step does and when it denies"
      - "  3. The 7 semantic laws as a numbered checklist that reviewers can mechanically verify"
      - "  4. Code patterns: how to add PCAC to a new handler using PrivilegedPcacInputBuilder + 3 kernel calls"
      - "  5. Anti-patterns: what PCAC does NOT solve (ledger integrity, evidence production, containment state management, policy-root provenance)"
      - "  6. Concrete before/after example: DelegateSublease handler scattered checks vs PCAC kernel calls"
      - "  7. Review checklist: what a security reviewer should check for in PCAC-integrated code"
      - "Update documents/skills/rust-standards/references/28_required_actions_templates.md to include PCAC pre-commit check in handler implementation templates."
      - "Update SECURITY_REVIEW_PROMPT.md and CODE_QUALITY_PROMPT.md to include PCAC awareness (AJC presence check for authority-bearing handlers)."
    out_of_scope:
      - "Changes to PCAC kernel implementation."
      - "RFC-0027 text changes."
  plan:
    steps:
      - "Write PCAC integration reference document (~200-300 lines, concise, example-driven)."
      - "Add PCAC handler template to required_actions_templates.md."
      - "Update review prompts to include PCAC-specific review questions."
      - "Verify that /rust-standards skill loads the new reference correctly."
      - "Run mandatory pre-commit checks."
  definition_of_done:
    evidence_ids:
      - "EVID-0003"
    criteria:
      - "PCAC integration reference exists in rust-standards references."
      - "Implementor agents can find AJC integration patterns via /rust-standards skill."
      - "Security reviewer agents have a PCAC-specific review checklist in their prompts."
      - "Review prompts flag any authority-bearing handler that lacks AJC lifecycle as a MAJOR finding."
  notes:
    security: |
      This is a knowledge-distribution ticket. PCAC's value is zero if agents don't know it
      exists or don't know how to use it. The recurring security findings in PR #594 demonstrate
      what happens when security controls are implemented ad-hoc instead of through the canonical
      primitive — the same finding class (self-referential policy checks, non-durable single-use,
      fail-open defaults) recurs because each fix attempt is handler-specific rather than
      PCAC-rooted.

      Making PCAC well-known to reviewer agents is especially important: reviewers should flag
      "this handler has authority-bearing side effects but no AJC lifecycle" as a structural
      finding, not wait for the specific exploit path to manifest.
    verification: |
      Smoke test: ask a fresh implementor agent to "add PCAC to a new privileged handler"
      and verify they can find the reference, use the builder, and produce correct code.
      Smoke test: ask a fresh reviewer agent to review a handler without AJC and verify they
      flag the absence.
