{
  "schema": "apm2.ticket.v1",
  "ticket_meta": {
    "schema_version": "2026-01-25",
    "template_version": "2026-01-25",
    "ticket": {
      "id": "TCK-00077",
      "title": "Complete Anti-Gaming Pattern Detection"
    },
    "binds": {
      "prd_id": "NONE",
      "rfc_id": "RFC-0006",
      "requirements": [
        {
          "requirement_id": "AAT-005",
          "requirement_ref": "documents/rfcs/RFC-0006/01_problem_and_imports.yaml#rfc_local_requirements.requirements[18]"
        }
      ],
      "evidence_artifacts": []
    },
    "custody": {
      "agent_roles": [
        "AGENT_IMPLEMENTER"
      ],
      "responsibility_domains": [
        "DOMAIN_BUILD_RELEASE"
      ]
    },
    "dependencies": {
      "tickets": []
    },
    "scope": {
      "in_scope": [
        "Add TIMESTAMP_REGEX for ISO 8601 format detection",
        "Add AntiGamingViolation::HardcodedTimestamp variant",
        "Detect patterns like 2026-01-25T10:00:00Z in diff",
        "Add tests for timestamp detection"
      ],
      "out_of_scope": [
        "Detection of other date formats (US, European, etc.)",
        "False positive suppression for test fixtures",
        "Detection of timestamps in comments vs code"
      ]
    },
    "plan": {
      "steps": [
        "Add TIMESTAMP_REGEX constant to anti_gaming.rs",
        "Regex pattern: \\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z?",
        "Add HardcodedTimestamp variant to AntiGamingViolation enum",
        "Add check_hardcoded_timestamps() function",
        "Call from analyze_diff() function",
        "Add tests for timestamp detection",
        "Test positive case: diff contains ISO timestamp",
        "Test negative case: diff without timestamps",
        "Verify cargo build succeeds",
        "Verify cargo test passes",
        "Verify cargo clippy passes with no warnings"
      ]
    },
    "definition_of_done": {
      "evidence_ids": [],
      "criteria": [
        "TIMESTAMP_REGEX matches ISO 8601 format",
        "AntiGamingViolation::HardcodedTimestamp variant exists",
        "analyze_diff() detects hardcoded timestamps",
        "Test for positive detection passes",
        "Test for negative detection passes",
        "cargo build succeeds",
        "cargo test passes",
        "cargo clippy passes with no warnings"
      ]
    },
    "notes": {
      "implementation_details": "```rust\n// xtask/src/aat/anti_gaming.rs additions\n\nuse regex::Regex;\nuse once_cell::sync::Lazy;\n\n/// Regex for ISO 8601 timestamp format.\n///\n/// Matches patterns like:\n/// - 2026-01-25T10:00:00Z\n/// - 2026-01-25T10:00:00\nstatic TIMESTAMP_REGEX: Lazy<Regex> = Lazy::new(|| {\n    Regex::new(r\"\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z?\").unwrap()\n});\n\n/// Check for hardcoded timestamps in diff.\nfn check_hardcoded_timestamps(diff: &str) -> Vec<AntiGamingViolation> {\n    let mut violations = Vec::new();\n\n    for line in diff.lines() {\n        // Only check added lines (start with +)\n        if line.starts_with('+') && !line.starts_with(\"+++\") {\n            if TIMESTAMP_REGEX.is_match(line) {\n                violations.push(AntiGamingViolation::HardcodedTimestamp {\n                    line: line.to_string(),\n                });\n            }\n        }\n    }\n\n    violations\n}\n\n// Add to AntiGamingViolation enum:\n#[derive(Debug, Clone)]\npub enum AntiGamingViolation {\n    // ... existing variants ...\n    HardcodedTimestamp { line: String },\n}\n```\n",
      "affected_files": "Modified: xtask/src/aat/anti_gaming.rs (add timestamp detection)\nModified: xtask/src/aat/types.rs (add HardcodedTimestamp variant if enum is there)\n"
    }
  }
}
