{
  "schema": "apm2.ticket.v1",
  "ticket_meta": {
    "schema_version": "2026-01-27",
    "template_version": "2026-01-27",
    "ticket": {
      "id": "TCK-00130",
      "title": "Implement canonicalization test vectors",
      "status": "CLOSED"
    },
    "binds": {
      "prd_id": "PRD-0007",
      "rfc_id": "RFC-0011",
      "requirements": [
        {
          "requirement_id": "CAC-REQ-0009",
          "requirement_ref": "documents/prds/PRD-0007/requirements/REQ-0009.yaml#prd_requirement"
        }
      ],
      "evidence_artifacts": [
        "EVID-0001"
      ]
    },
    "custody": {
      "agent_roles": [
        "AGENT_IMPLEMENTER"
      ],
      "responsibility_domains": [
        "DOMAIN_KERNEL"
      ]
    },
    "dependencies": {
      "tickets": [
        "TCK-00127"
      ]
    },
    "scope": {
      "in_scope": [
        "Create governed test vector artifact for canonicalization",
        "Golden vectors for all edge cases (unicode, escaping, ordering)",
        "Cross-platform verification via CI",
        "Pin vectors in bootstrap bundle",
        "Version tracking for vector updates"
      ],
      "out_of_scope": [
        "Test vector governance procedures (post-Phase-1)",
        "Cross-language compatibility tests"
      ]
    },
    "plan": {
      "steps": [
        "Create crates/apm2-core/bootstrap/test_vectors/canonicalize.json",
        "Define vector schema: {input, expected_canonical, expected_hash}",
        "Add vectors for: unicode NFC, key ordering, integer boundaries",
        "Add vectors for: depth limits, array limits, escaping",
        "Add vectors for: expected failures (floats, duplicate keys)",
        "Create test harness that loads and validates vectors",
        "Add vectors to bootstrap bundle manifest",
        "Run vectors in CI across platforms (linux, macos)"
      ]
    },
    "definition_of_done": {
      "evidence_ids": [
        "EVID-0001"
      ],
      "criteria": [
        "Test vector file exists in bootstrap bundle",
        "All positive vectors produce expected canonical bytes and hash",
        "All negative vectors produce expected error types",
        "CI runs vectors on linux and macos targets",
        "Bootstrap manifest includes vector content hash",
        "All tests pass: cargo test --features test_vectors canonicalization"
      ]
    },
    "notes": {
      "security": "Test vectors ensure canonicalizer consistency across versions",
      "architecture": "Vectors are governed artifacts pinned in bootstrap bundle.\nVector file format allows incremental addition of new edge cases.\nCross-platform verification catches endianness and encoding issues.\n"
    }
  }
}
