{
  "schema": "apm2.ticket.v1",
  "ticket_meta": {
    "schema_version": "2026-01-29",
    "template_version": "2026-01-29",
    "ticket": {
      "id": "TCK-00289",
      "title": "Privileged dispatcher: replace stubs with real governance + IssueCapability",
      "status": "CLOSED"
    },
    "binds": {
      "prd_id": "PRD-0009",
      "rfc_id": "RFC-0018",
      "requirements": [
        {
          "requirement_id": "REQ-HEF-0009",
          "requirement_ref": "documents/rfcs/RFC-0018/requirements/REQ-HEF-0009.yaml#rfc_requirement"
        }
      ],
      "evidence_artifacts": [
        {
          "evidence_id": "EVID-HEF-0009",
          "artifact_ref": "documents/rfcs/RFC-0018/evidence_artifacts/EVID-HEF-0009.yaml#rfc_evidence_artifact"
        }
      ]
    },
    "custody": {
      "agent_roles": [
        "AGENT_IMPLEMENTER"
      ],
      "responsibility_domains": [
        "DOMAIN_RUNTIME",
        "DOMAIN_SECURITY"
      ]
    },
    "dependencies": {
      "tickets": [
        {
          "ticket_id": "TCK-00287",
          "reason": "Privileged dispatcher must be reachable via ProtocolServer cutover."
        }
      ]
    },
    "scope": {
      "in_scope": [
        "Replace stub policy resolver/work registry/ledger emitter/lease validator in PrivilegedDispatcher.",
        "Implement IssueCapability with HTF-compliant timestamps.",
        "Persist ClaimWork/SpawnEpisode state and emit ledger events."
      ],
      "out_of_scope": [
        "Legacy JSON privileged handlers."
      ]
    },
    "plan": {
      "steps": [
        "Wire governance policy resolver and work registry into PrivilegedDispatcher.",
        "Replace StubLedgerEventEmitter with durable ledger emitter.",
        "Implement IssueCapability with lease validation and HTF time source."
      ]
    },
    "definition_of_done": {
      "evidence_ids": [
        "EVID-HEF-0009"
      ],
      "criteria": [
        "IssueCapability returns non-zero HTF-compliant timestamps.",
        "ClaimWork/SpawnEpisode persist state and emit ledger events.",
        "Production path does not use stub dependencies."
      ]
    },
    "notes": {
      "security": "Privileged control-plane operations must be durable, signed, and enforced\nvia real governance and lease validation (no stubs).\n",
      "verification": "IT-00289-01: cargo test -p apm2-daemon privileged_dispatcher_real\n",
      "general": "Required to make orchestrator workflows authoritative before FAC v0 automation.\n"
    }
  }
}
