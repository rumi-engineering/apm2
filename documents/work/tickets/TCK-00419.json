{
  "schema": "apm2.ticket.v1",
  "ticket_meta": {
    "schema_version": "2026-01-29",
    "template_version": "2026-01-29",
    "ticket": {
      "id": "TCK-00419",
      "title": "Staged xtask demotion and instruction-plane cutover to apm2 fac",
      "status": "CLOSED"
    },
    "binds": {
      "prd_id": "PRD-0009",
      "rfc_id": "RFC-0018",
      "requirements": [
        {
          "requirement_id": "REQ-HEF-0016",
          "requirement_ref": "documents/rfcs/RFC-0018/requirements/REQ-HEF-0016.yaml#rfc_requirement"
        }
      ],
      "evidence_artifacts": [
        {
          "evidence_id": "EVID-HEF-0017",
          "artifact_ref": "documents/rfcs/RFC-0018/evidence_artifacts/EVID-HEF-0017.yaml#rfc_evidence_artifact"
        }
      ]
    },
    "custody": {
      "agent_roles": [
        "AGENT_IMPLEMENTER",
        "AGENT_REVIEWER"
      ],
      "responsibility_domains": [
        "DOMAIN_BUILD_RELEASE",
        "DOMAIN_RUNTIME",
        "DOMAIN_SECURITY"
      ]
    },
    "dependencies": {
      "tickets": [
        {
          "ticket_id": "TCK-00324",
          "reason": "Stage-1 demotion baseline from RFC-0019 is prerequisite."
        },
        {
          "ticket_id": "TCK-00411",
          "reason": "Prompt/docs status-write drift closure is prerequisite for lockstep instruction cutover."
        },
        {
          "ticket_id": "TCK-00410",
          "reason": "FAC-local deterministic gate/projection path must be available for default lifecycle path."
        }
      ]
    },
    "scope": {
      "in_scope": [
        "Implement/verify staged xtask demotion semantics across lifecycle control commands.",
        "Set default lifecycle path to daemon-backed apm2 fac commands in Stage 2.",
        "Update RoleSpec/skill executable instruction surfaces to match runtime authority path.",
        "Add CI lint preventing reintroduction of deprecated lifecycle control commands in instruction assets."
      ],
      "out_of_scope": [
        "Immediate unconditional deletion of xtask binary or all dev workflows.",
        "Projection architecture redesign outside staged demotion scope."
      ]
    },
    "plan": {
      "steps": [
        "Audit lifecycle control callsites in xtask and executable docs/prompts.",
        "Enforce explicit write override semantics where legacy write path remains.",
        "Switch default flows to apm2 fac projection-request/receipt path.",
        "Patch RoleSpec/skill surfaces and add CI lint guard for command drift.",
        "Run cargo fmt --all && cargo clippy --workspace --all-targets --all-features -- -D warnings && cargo test --workspace."
      ]
    },
    "definition_of_done": {
      "evidence_ids": [
        "EVID-HEF-0017"
      ],
      "criteria": [
        "Stage-2 default lifecycle path avoids direct write side-effects.",
        "Instruction assets and runtime behavior are lockstep and verifiable.",
        "CI fails on deprecated lifecycle control command reintroduction."
      ]
    },
    "resolution": {
      "merged_prs": [
        {
          "pr_number": 503,
          "title": "feat(TCK-00419): staged xtask demotion + instruction-plane cutover",
          "scope": "Stage-2 demotion default, instruction-plane lockstep, CI lint guard"
        },
        {
          "pr_number": 516,
          "title": "chore: remove xtask crate, replace with apm2 CLI",
          "scope": "Stage-3 xtask removal, skill document updates to apm2 fac equivalents"
        }
      ],
      "summary": "All three demotion stages complete: Stage-1 (explicit write controls, TCK-00324),\nStage-2 (projection-request/receipt default, PR #503), Stage-3 (xtask crate removal,\nPR #516). Lifecycle authority now resides entirely in apm2 fac CLI. CI lint guards\nprevent reintroduction of deprecated lifecycle commands.\n"
    },
    "notes": {
      "security": "Instruction/runtime mismatch is treated as policy bypass risk and blocked.\n",
      "verification": "Include both runtime tests and repository lint evidence.\n"
    }
  }
}
