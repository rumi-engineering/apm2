ticket_meta:
  schema_version: "2026-01-29"
  template_version: "2026-01-29"
  ticket:
    id: "TCK-00569"
    title: "Lane cleanup state machine: post-job cleanup, failure handling, CORRUPT transitions, and cleanup receipts"
    status: "OPEN"
  binds:
    prd_id: "PRD-PLACEHOLDER"
    rfc_id: "RFC-0019"
    requirements: []
    evidence_artifacts: []
  custody:
    agent_roles: ["AGENT_IMPLEMENTER"]
    responsibility_domains: ["DOMAIN_RUNTIME", "DOMAIN_SECURITY"]
  dependencies:
    tickets:
      - ticket_id: "TCK-00515"
        reason: "Lane leasing exists."
      - ticket_id: "TCK-00516"
        reason: "safe_rmtree_v1 exists for controlled deletion."
      - ticket_id: "TCK-00517"
        reason: "Lane workspace provenance exists (mirror checkout)."
  scope:
    in_scope:
      - "Implement lane lifecycle transitions with explicit cleanup phase:"
      - "  - after job execution, run cleanup: reset to SHA, git clean -ffdx, prune lane temp, enforce log quota hooks"
      - "  - if cleanup fails, mark lane CORRUPT and refuse future leases until reset"
      - "Persist CORRUPT marker and cleanup receipts."
      - "Expose in `lane status`."
    out_of_scope:
      - "Automatic lane reset without operator policy (optional later)."
  plan:
    steps:
      - "Define LaneCleanupReceiptV1 (or reuse FacJobReceiptV1(kind=lane_cleanup))."
      - "Implement cleanup runner and CORRUPT marker file."
      - "Wire worker to enforce cleanup before lane returns IDLE."
  definition_of_done:
    evidence_ids: []
    criteria:
      - "A cleanup failure prevents lane reuse and is visible via status."
      - "Cleanup actions are receipted for audit."
