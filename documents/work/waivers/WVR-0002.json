{
  "schema": "apm2.waiver.v1",
  "waiver": {
    "schema_version": "2026-02-06",
    "id": "WVR-0002",
    "title": "Temporary rollout exceptions for FAC adapter/profile hardening",
    "status": "APPROVED",
    "scope": {
      "gate_ids": [
        "GATE-HEF-FAC-V0",
        "GATE-SECURITY-REVIEW"
      ],
      "requirement_ids": [],
      "quality_dimension_ids": [
        "DEFAULT_DENY_SECURITY",
        "DATA_PRIVACY",
        "OPERATIONAL_READINESS"
      ]
    },
    "rationale": "FAC rollout requires staged enablement across adapter binding, role/profile\nattribution, and Codex execution plumbing. Three controls are temporarily\nrelaxed to avoid blocking rollout while implementation tickets land:\n\n1) role_spec_hash MAY be omitted for S0.5 rollout flows while adapter_profile_hash\n   is still required and validated against CAS.\n2) session token propagation MAY use process environment as a short-lived\n   bootstrap channel; command-line argument propagation remains disallowed.\n3) Codex bypass flag MAY be enabled only in daemon-mediated rollout paths\n   where TI1 mediation and policy engine checks remain authoritative.\n\nThis waiver is temporary and bounded. Full hardening is still required.\n",
    "mitigations": [
      {
        "description": "Require adapter_profile_hash CAS validation fail-closed in all rollout paths.",
        "type": "TECHNICAL",
        "owner": "FAC runtime maintainers"
      },
      {
        "description": "When role_spec_hash is absent, emit explicit waiver marker and absence flag in session attribution event.",
        "type": "TECHNICAL",
        "owner": "FAC runtime maintainers"
      },
      {
        "description": "Do not pass session tokens via command-line arguments; allow env-only bootstrap with TTL <= 300s.",
        "type": "TECHNICAL",
        "owner": "FAC runtime maintainers"
      },
      {
        "description": "Scrub token-bearing environment variables from logs, traces, panic payloads, and evidence artifacts.",
        "type": "TECHNICAL",
        "owner": "FAC runtime maintainers"
      },
      {
        "description": "Gate Codex bypass flag behind explicit daemon config defaulting to false.",
        "type": "TECHNICAL",
        "owner": "FAC runtime maintainers"
      },
      {
        "description": "Run Codex adapter only through daemon-mediated tool broker and TI1 framing; no direct ambient tool path.",
        "type": "PROCEDURAL",
        "owner": "Security reviewers"
      }
    ],
    "expiration_date": "2026-04-15",
    "required_signoffs": [
      "AUTH_SECURITY",
      "AUTH_ARCHITECTURE"
    ],
    "evidence_ids": [
      "EVID-WVR-0002-ROLLOUT-SECURITY"
    ],
    "references": {
      "related_tickets": [
        "TCK-00397",
        "TCK-00399",
        "TCK-00402"
      ],
      "related_rfc": "RFC-0018",
      "related_prompt": "documents/reviews/SECURITY_REVIEW_PROMPT.md"
    },
    "approval": {
      "approver": "repository_owner",
      "approval_date": "2026-02-06",
      "approval_notes": "Approved as a time-bounded rollout waiver with explicit mitigations and\nexpiration. Security hardening remains mandatory before Tier2+ broad deployment.\n"
    },
    "created_date": "2026-02-06",
    "last_updated": "2026-02-06"
  }
}
