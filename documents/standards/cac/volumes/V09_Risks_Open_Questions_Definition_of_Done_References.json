{
  "schema": "apm2.prd.volume.v1",
  "schema_version": "1.0.0",
  "sections": [
    {
      "content": {
        "open_questions": [
          {
            "id": "CAC-OQ-0001",
            "question": "Exact canonicalization spec: strict RFC 8785 JCS vs a stricter CAC profile; how to publish, pin, and version test vectors and canonicalizer IDs?"
          },
          {
            "id": "CAC-OQ-0002",
            "question": "Stable ID namespace governance: who can mint namespaces, and how are collisions prevented across org/projects?"
          },
          {
            "id": "CAC-OQ-0003",
            "question": "Do we need typed kernel events (ControlArtifactEvent) in the MVP, or is EvidencePublished metadata sufficient?"
          },
          {
            "id": "CAC-OQ-0004",
            "question": "How to represent large binary artifacts within CAC-JSON (likely via CAS refs only) and enforce policies consistently?"
          },
          {
            "id": "CAC-OQ-0005",
            "question": "Should defect records be first-class kernel events or remain evidence artifacts referenced by events?"
          },
          {
            "id": "CAC-OQ-0006",
            "question": "TargetProfile schema: what is the minimal stage taxonomy (plan/implement/review/ops) and which policies must be mandatory vs optional?"
          },
          {
            "id": "CAC-OQ-0007",
            "question": "Compaction policy: when does patch depth require snapshotting, and how are ChangeSet summaries preserved across compaction?"
          }
        ],
        "risks": [
          {
            "id": "CAC-RISK-0001",
            "impact": "Breaks CAS dedupe, provenance, and stable-ID pinning.",
            "mitigations": [
              "Golden test vectors committed and run in CI.",
              "Versioned canonicalizer; include canonicalizer_version in receipts.",
              "Cross-language compatibility tests if multiple implementations exist."
            ],
            "name": "Canonicalizer divergence causes hash drift"
          },
          {
            "id": "CAC-RISK-0002",
            "impact": "Machines may fail admission frequently during early adoption.",
            "mitigations": [
              "Bootstrap with small schema set and evolve intentionally.",
              "Provide machine-generated patch tooling that auto-validates before submission.",
              "Use staged rollout: warn -> soft fail -> hard fail."
            ],
            "name": "Schema strictness slows iteration"
          },
          {
            "id": "CAC-RISK-0003",
            "impact": "External agent tooling stops working or requires urgent changes.",
            "mitigations": [
              "Version target profiles and pin in packs.",
              "Conformance tests run in AAT; failures become defects.",
              "Maintain fallback exports for critical vendors."
            ],
            "name": "Target delivery churn breaks export pipeline"
          },
          {
            "id": "CAC-RISK-0004",
            "impact": "Tasks fail because packs are incomplete; could be perceived as regressions.",
            "mitigations": [
              "Treat failures as compiler defects and fix packs quickly.",
              "Allow limited, explicitly budgeted escape hatches early, with strong defect emission.",
              "Prioritize pack completeness for the most common workflows."
            ],
            "name": "Consumption hermeticity causes early friction"
          },
          {
            "id": "CAC-RISK-0005",
            "impact": "Stable-ID resolution and fetch becomes slow at scale.",
            "mitigations": [
              "Maintain a cached projection store (rebuildable).",
              "Shard by namespace/kind; keep hot indexes in memory.",
              "Include compaction checkpoints."
            ],
            "name": "Indexing DCP from ledger becomes performance bottleneck"
          },
          {
            "id": "CAC-RISK-0006",
            "impact": "Patch history grows unbounded; review and replay become slow or error-prone.",
            "mitigations": [
              "Define compaction thresholds (depth/time/size) per artifact kind.",
              "Require ChangeSet summaries to accompany compaction snapshots.",
              "Maintain provenance links from snapshots back to patch chains."
            ],
            "name": "Patch soup without compaction"
          },
          {
            "id": "CAC-RISK-0007",
            "impact": "TargetProfile budgets or rendering policies are miscalibrated, causing frequent failures for weaker models.",
            "mitigations": [
              "Default to conservative budgets; adjust via measured RunReceipt data.",
              "Maintain per-model profiles and gate by capability manifest.",
              "Automate profile tuning based on sufficiency metrics."
            ],
            "name": "Target profile miscalibration"
          }
        ]
      },
      "section_id": "RISKS",
      "title": "Risks and Open Questions"
    },
    {
      "content": {
        "mvp_definition": [
          "CAC-JSON canonicalizer + schema validator are integrated into the APM2 CLI/kernel toolchain and are used for all normative control artifacts.",
          "Bootstrap schema bundle is embedded and hash-pinned in the apm2 binary; bootstrap stable IDs are immutable via PatchRecord admission.",
          "Canonicalizer id/version and test-vector reference are recorded in envelopes/receipts for all normative artifacts.",
          "Machines can submit PatchRecords; kernel admits updated artifacts with replay protection and emits AdmissionReceipts to CAS + ledger provenance.",
          "Admissions include ChangeSetReport summaries that support review and compaction.",
          "DCP stable-ID resolution exists and is reconstructable from ledger; consumption holons can fetch required context via deterministic tools (ArtifactFetch).",
          "TargetProfile schema defines budgets and rendering policies; compiler produces deep-pinned ContextPack manifests with transitive closure.",
          "Consumption holons emit RunReceipts with context_pack_miss and sufficiency; misses fail runs by default unless explicitly escalated.",
          "CapabilityManifest is generated from the apm2 binary and verified by selftests; AATReceipt gates cutover and agent planning.",
          "At least one target delivery profile (claude_code/v1) exists with deterministic export and conformance tests; export is provenanced and CI-enforced as derived output.",
          "Defect records are emitted for unplanned consumption reads/tool calls and feed back into pack compiler improvements."
        ],
        "post_mvp_extensions": [
          "Optional typed kernel event families for control artifacts and DCP mappings.",
          "Two-way import from vendor ABIs into CAC (airlock) if needed.",
          "Richer semantic diff tooling for patch review at scale.",
          "Hybrid/PQ signature support for critical receipts/events."
        ]
      },
      "section_id": "DOD",
      "title": "Definition of Done"
    },
    {
      "content": {
        "references": [
          {
            "id": "REF-JSON",
            "title": "The JavaScript Object Notation (JSON) Data Interchange Format (RFC 8259)",
            "url": "https://www.rfc-editor.org/rfc/rfc8259"
          },
          {
            "id": "REF-JCS",
            "title": "JSON Canonicalization Scheme (RFC 8785)",
            "url": "https://www.rfc-editor.org/rfc/rfc8785"
          },
          {
            "id": "REF-JSONPATCH",
            "title": "JSON Patch (RFC 6902)",
            "url": "https://www.rfc-editor.org/rfc/rfc6902"
          },
          {
            "id": "REF-JSONMERGE",
            "title": "JSON Merge Patch (RFC 7396)",
            "url": "https://www.rfc-editor.org/rfc/rfc7396"
          },
          {
            "id": "REF-JSONSCHEMA",
            "title": "JSON Schema (2020-12)",
            "url": "https://json-schema.org/draft/2020-12/json-schema-core.html"
          },
          {
            "id": "REF-APM2-KERNEL",
            "title": "APM2 Kernel Event Schema (repo)",
            "url": "file:proto/kernel_events.proto"
          },
          {
            "id": "REF-APM2-TOOL",
            "title": "APM2 Tool Protocol Schema (repo)",
            "url": "file:proto/tool_protocol.proto"
          }
        ]
      },
      "section_id": "REFS",
      "title": "References"
    }
  ],
  "volume": {
    "generated_at": "2026-01-26",
    "source_prd_id": "APM2-PRD-CAC-0001",
    "title": "Risks, Open Questions, Definition of Done, References",
    "volume_id": "V09"
  }
}
