{
  "security": {
    "controls": [
      {
        "details": "Restrict CAC-JSON to integer-only numbers within 64-bit range; enforce max depth and size.",
        "id": "SEC-CTRL-0001",
        "name": "Canonical JSON profile (no floats, bounded depth)",
        "type": "preventative"
      },
      {
        "details": "Canonicalizer is a versioned component; include golden vectors and cross-platform tests; canonical bytes used for hashing.",
        "id": "SEC-CTRL-0002",
        "name": "Deterministic canonicalizer with test vectors",
        "type": "preventative"
      },
      {
        "details": "Canonicalizer id/version and test-vector reference are recorded in envelopes/receipts; vectors are governed artifacts pinned in the bootstrap bundle.",
        "id": "SEC-CTRL-0009",
        "name": "Canonicalizer governance metadata",
        "type": "preventative"
      },
      {
        "details": "Validator profile rejects unknown fields; schemas use unevaluatedProperties=false.",
        "id": "SEC-CTRL-0003",
        "name": "Schema strictness (unknown field rejection)",
        "type": "preventative"
      },
      {
        "details": "Ledger events are signed and hash-chained; artifacts are content-addressed and integrity-verified.",
        "id": "SEC-CTRL-0004",
        "name": "Signed ledger + CAS hashes",
        "type": "detective+preventative"
      },
      {
        "details": "Consumption holons run with restricted filesystem and network; only deterministic ArtifactFetch permitted for context.",
        "id": "SEC-CTRL-0005",
        "name": "Hermetic runtime sandboxing",
        "type": "preventative"
      },
      {
        "details": "Generated Markdown includes provenance frontmatter; export manifest records hashes; conformance tests gate use.",
        "id": "SEC-CTRL-0006",
        "name": "Provenance embedding in vendor exports",
        "type": "detective"
      },
      {
        "details": "Hard bounds: max bytes, max depth, max array length, max schema complexity.",
        "id": "SEC-CTRL-0007",
        "name": "DoS limits in parsers and validators",
        "type": "preventative"
      },
      {
        "details": "Bootstrap schema bundle is embedded and pinned by hash; admission rejects modifications or shadowing; validator refuses to operate if bootstrap verification fails.",
        "id": "SEC-CTRL-0008",
        "name": "Bootstrap trust root immutability",
        "type": "preventative"
      }
    ],
    "cryptography_plan": {
      "current": {
        "artifact_hashing": "BLAKE3-256",
        "ledger_signatures": "Ed25519 (per kernel_events.proto comment)"
      },
      "future": {
        "note": "This PRD requires agility and versioning; it does not mandate immediate PQ deployment.",
        "pq_readiness": [
          "Introduce algorithm agility fields in receipts/manifests (signature_algorithm_id).",
          "Support hybrid signatures for critical artifacts/events when PQ algorithms are adopted."
        ]
      }
    },
    "security_properties": [
      {
        "id": "SEC-PROP-0001",
        "name": "Fail-closed admission",
        "statement": "Artifacts cannot enter DCP or influence execution unless validated and canonicalized."
      },
      {
        "id": "SEC-PROP-0002",
        "name": "Replay protection",
        "statement": "All patch admissions require expected_base_hash matching current state."
      },
      {
        "id": "SEC-PROP-0003",
        "name": "Least privilege consumption",
        "statement": "Consumption holons have deterministic reads only; no open-ended browsing."
      },
      {
        "id": "SEC-PROP-0004",
        "name": "End-to-end provenance",
        "statement": "All state transitions are recorded as signed events referencing immutable hashes."
      },
      {
        "id": "SEC-PROP-0005",
        "name": "Algorithm agility",
        "statement": "Cryptographic mechanisms and canonicalization engines are versioned and upgradable without breaking auditability."
      }
    ],
    "threat_model": {
      "assets_to_protect": [
        "Integrity of control artifacts (policies, packs, capabilities).",
        "Integrity of ledger event chain and signatures.",
        "Confidentiality of sensitive context and secrets.",
        "Availability of admission/validation pipeline (DoS resistance)."
      ],
      "assumption": "Adversary includes state actors with advanced capabilities, including discovery and exploitation of novel zero-days and future quantum threats.",
      "attack_surfaces": [
        "Parser and canonicalizer bugs (ambiguity, crashes, differential parsing).",
        "Schema bypass via unknown fields or permissive validators.",
        "Replay attacks against patch admission or work transitions.",
        "Supply-chain injection via vendor ABI outputs or imports.",
        "Privilege escalation through tool calls and filesystem reads.",
        "Resource exhaustion via deeply nested JSON, huge arrays, or pathological schemas."
      ]
    }
  }
}
