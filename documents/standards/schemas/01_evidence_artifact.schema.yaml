evidence_artifact_schema:
  schema_version: "2026-01-23"
  schema_id: "SCHEMA_EVIDENCE_ARTIFACT_V2"
  required_keys:
    - "id"
    - "category"
    - "title"
    - "capture"
    - "verification"
    - "data"
  keys:
    id:
      type: "string"
      pattern_ref: "standards_meta.determinism.canonical_id_formats.evidence_id"
    category:
      type: "string"
      enum_ref: "standards/enums/03_evidence_categories.yaml#evidence_categories.values"
    title:
      type: "string"
      min_length: 3
    capture:
      type: "object"
      required_keys:
        - "paths"
      keys:
        paths:
          type: "array"
          item_type: "string"
          min_items: 1
          constraints:
            - "Each path MUST be relative to the evidence bundle root."
    verification:
      type: "object"
      required_keys:
        - "commands"
      keys:
        commands:
          type: "array"
          item_type: "object"
          min_items: 1
          object_required_keys:
            - "id"
            - "shell"
            - "command"
            - "network_access"
          object_keys:
            id:
              type: "string"
              pattern_ref: "standards_meta.determinism.canonical_id_formats.command_id"
            shell:
              type: "string"
              enum_ref: "standards/enums/14_command_shells.yaml#command_shells.values"
            command:
              type: "string"
              min_length: 3
            expected_exit_code:
              type: "integer"
              default: 0
            cwd:
              type: "string"
              default: "."
            timeout_seconds:
              type: "integer"
              default: 600
            network_access:
              type: "string"
              enum_ref: "standards/enums/18_network_access.yaml#network_access.values"
            allowlist_hosts:
              type: "array"
              item_type: "string"
              default: []
            constraints:
              type: "array"
              item_type: "string"
              default: []
    data:
      type: "object"
      required_keys:
        - "classification"
        - "redaction"
      keys:
        classification:
          type: "string"
          enum_ref: "standards/enums/02_data_classification.yaml#data_classification.values"
        redaction:
          type: "object"
          required_keys:
            - "required"
            - "guidance"
          keys:
            required:
              type: "boolean"
            guidance:
              type: "array"
              item_type: "string"
