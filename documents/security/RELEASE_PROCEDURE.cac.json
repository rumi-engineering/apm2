{
  "schema": "apm2.security.release_procedure_doc.v1",
  "schema_version": "1.0.0",
  "kind": "security.release_procedure_document",
  "meta": {
    "stable_id": "dcp://apm2.security/doc/release-procedure@1",
    "status": "ACTIVE",
    "classification": "INTERNAL",
    "source_of_truth_refs": [
      "documents/rfcs/RFC-0020/HOLONIC_SUBSTRATE_INTERFACE.md",
      "documents/security/SECURITY_POLICY.cac.json",
      "documents/security/INCIDENT_RESPONSE.cac.json"
    ],
    "last_aligned_rfc": "RFC-0020",
    "replaces": "documents/security/RELEASE_PROCEDURE.md",
    "created_at": "2026-02-05T00:00:00Z",
    "updated_at": "2026-02-05T00:00:00Z",
    "canonicalizer": {
      "canonicalizer_id": "apm2.canonicalizer.jcs",
      "canonicalizer_version": "1.0.0",
      "vectors_ref": "dcp://apm2.cac/canonicalizer/vectors@v1"
    },
    "provenance": {
      "actor_id": "HOLON-SECURITY-GOVERNANCE",
      "work_id": "DOC-SECURITY-RFC0020-ALIGN-20260205",
      "source_receipts": []
    }
  },
  "payload": {
    "title": "Release Procedure",
    "mode_requirement": "MODE_HIGH_ASSURANCE",
    "precondition": "If any mandatory step fails, stop, remediate, and restart the full procedure.",
    "authoritative_refs": [
      "HOLONIC_SUBSTRATE_INTERFACE.md",
      "documents/security/SECURITY_POLICY.cac.json"
    ],
    "procedure_steps": [
      {
        "step_no": 1,
        "title": "Confirm release intent and scope",
        "actions": [
          "Identify release type (patch/minor/major) and commit range.",
          "Confirm release baseline (main HEAD or designated release branch)."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 2,
        "title": "Confirm High Assurance posture",
        "actions": [
          "Ensure release workflow enforces MODE_HIGH_ASSURANCE.",
          "Do not use local developer mode behavior for release validation."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 3,
        "title": "Ensure mainline is green",
        "actions": [
          "Confirm all required CI checks are green on intended release commit.",
          "Do not proceed if any required check is failing."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 4,
        "title": "Re-validate security gates",
        "actions": [
          "Confirm cargo clippy --all-targets -- -D warnings passed.",
          "Confirm cargo deny check passed.",
          "Confirm cargo audit passed.",
          "Ensure results correspond exactly to the release commit."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 5,
        "title": "Confirm dependency policy compliance",
        "actions": [
          "Inspect Cargo.lock changes in release scope.",
          "Confirm no unexpected dependency additions or forbidden feature expansions.",
          "For upgrades, confirm deny/audit success for the exact lockfile."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 6,
        "title": "Confirm secret hygiene prerequisites",
        "actions": [
          "Review for accidental secret commits using targeted git history searches.",
          "Ensure artifacts are produced only by controlled CI pipeline."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 7,
        "title": "Prepare release metadata",
        "actions": [
          "Update version and release notes per convention.",
          "Ensure release notes contain no secrets or sensitive operational details."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 8,
        "title": "Create release tag",
        "actions": [
          "Create annotated tag at release commit.",
          "Push tag to canonical repository."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 9,
        "title": "Trigger release workflow",
        "actions": [
          "Confirm GitHub Actions release workflow runs for pushed tag.",
          "Monitor workflow to completion."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 10,
        "title": "Verify Sigstore signing outputs",
        "actions": [
          "Confirm each artifact has .sig and .pem.",
          "Confirm signing assets are published with artifacts."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 11,
        "title": "Verify SLSA provenance outputs",
        "actions": [
          "Confirm SLSA Level 3 provenance generated by slsa-github-generator.",
          "Confirm provenance attached or published in expected location."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 12,
        "title": "Verify SBOM outputs",
        "actions": [
          "Confirm syft SBOM generation succeeded.",
          "Confirm CycloneDX and SPDX outputs are published with release artifacts."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 13,
        "title": "Perform cryptographic spot-check",
        "actions": [
          "Verify at least one artifact using cosign verify-blob with issuer and identity constraints.",
          "Treat verification failure as release integrity incident and halt publication."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 14,
        "title": "Confirm artifact set completeness",
        "actions": [
          "Ensure all expected target outputs are present.",
          "Ensure each artifact has signature, certificate, provenance, and SBOMs."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 15,
        "title": "Final publication",
        "actions": [
          "Publish GitHub release if draft.",
          "Ensure notes and assets match verified artifacts."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 16,
        "title": "Post-release integrity check",
        "actions": [
          "Record tag, artifact digests, and verification evidence.",
          "Confirm no post-publication asset edits that invalidate signatures or provenance."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      },
      {
        "step_no": 17,
        "title": "Security issue discovered during or after release",
        "actions": [
          "Stop further releases.",
          "Open GitHub Security Advisory when appropriate.",
          "Classify severity and follow incident containment targets.",
          "Acknowledge within 48h and disclose publicly after patch readiness."
        ],
        "failure_behavior": "STOP_AND_REMEDIATE"
      }
    ],
    "spot_check_command_template": [
      "cosign verify-blob",
      "--certificate <artifact>.pem",
      "--signature <artifact>.sig",
      "--certificate-identity-regexp \"https://github.com/.*/apm2/.*\"",
      "--certificate-oidc-issuer \"https://token.actions.githubusercontent.com\"",
      "<artifact>"
    ],
    "incident_hook": {
      "actions": [
        "Stop releases.",
        "Open security advisory.",
        "Apply containment by severity.",
        "Coordinate responsible disclosure."
      ],
      "severity_targets": [
        {
          "severity": "Critical",
          "target": {
            "target_type": "IMMEDIATE",
            "max_duration_ms": 0
          }
        },
        {
          "severity": "High",
          "target": {
            "target_type": "WITHIN",
            "max_duration_ms": 86400000
          }
        },
        {
          "severity": "Medium",
          "target": {
            "target_type": "WITHIN",
            "max_duration_ms": 604800000
          }
        },
        {
          "severity": "Low",
          "target": {
            "target_type": "WITHIN",
            "max_duration_ms": 2592000000
          }
        }
      ],
      "acknowledgement_requirement": {
        "target_type": "WITHIN",
        "max_duration_ms": 172800000
      }
    },
    "scale_profile": {
      "capacity_target": "multi-exabyte",
      "integrity_controls": [
        "Treat release artifacts as digest-addressed immutable objects with associated signatures and provenance.",
        "Rely on identity-constrained verification and attestations instead of ad hoc trust assumptions.",
        "Use fail-closed gate behavior on missing or ambiguous verification artifacts."
      ]
    },
    "cryptography_posture": {
      "pqc_status": "DEFERRED",
      "pqc_note": "PQC migration is deferred; current release cryptography remains Sigstore keyless plus provenance and transparency controls."
    }
  }
}
