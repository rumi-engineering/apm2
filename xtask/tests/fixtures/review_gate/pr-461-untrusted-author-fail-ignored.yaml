name: "PR-461 untrusted author FAIL marker is ignored (DoS prevention)"
pr_number: 461
head_sha: "6161616161616161616161616161616161616161"
statuses:
  - context: "ai-review/security"
    state: "success"
    created_at: "2026-02-12T10:30:00Z"
  - context: "ai-review/code-quality"
    state: "success"
    created_at: "2026-02-12T10:31:00Z"
comments:
  # Trusted PASS from security bot
  - id: 46101
    user_login: "apm2-security-bot"
    updated_at: "2026-02-12T10:00:00Z"
    body: |
      ## Security Review: PASS
      <!-- apm2-review-metadata:v1:security -->
      ```json
      {
        "schema": "apm2.review.metadata.v1",
        "review_type": "security",
        "pr_number": 461,
        "head_sha": "6161616161616161616161616161616161616161",
        "verdict": "PASS",
        "severity_counts": {
          "blocker": 0,
          "major": 0,
          "minor": 0,
          "nit": 0
        },
        "reviewer_id": "apm2-codex-security"
      }
      ```
  # Untrusted attacker posts a FAIL marker — should be skipped entirely
  - id: 46102
    user_login: "malicious-attacker"
    updated_at: "2026-02-12T10:15:00Z"
    body: |
      ## Security Review: FAIL
      <!-- apm2-review-metadata:v1:security -->
      ```json
      {
        "schema": "apm2.review.metadata.v1",
        "review_type": "security",
        "pr_number": 461,
        "head_sha": "6161616161616161616161616161616161616161",
        "verdict": "FAIL",
        "severity_counts": {
          "blocker": 5,
          "major": 0,
          "minor": 0,
          "nit": 0
        },
        "reviewer_id": "apm2-codex-security"
      }
      ```
  # Trusted PASS from quality bot
  - id: 46103
    user_login: "apm2-quality-bot"
    updated_at: "2026-02-12T10:05:00Z"
    body: |
      ## Code Quality Review: PASS
      <!-- apm2-review-metadata:v1:code-quality -->
      ```json
      {
        "schema": "apm2.review.metadata.v1",
        "review_type": "code-quality",
        "pr_number": 461,
        "head_sha": "6161616161616161616161616161616161616161",
        "verdict": "PASS",
        "severity_counts": {
          "blocker": 0,
          "major": 0,
          "minor": 0,
          "nit": 0
        },
        "reviewer_id": "apm2-codex-quality"
      }
      ```
  # Untrusted attacker posts a quality FAIL marker — should also be skipped
  - id: 46104
    user_login: "malicious-attacker"
    updated_at: "2026-02-12T10:20:00Z"
    body: |
      ## Code Quality Review: FAIL
      <!-- apm2-review-metadata:v1:code-quality -->
      ```json
      {
        "schema": "apm2.review.metadata.v1",
        "review_type": "code-quality",
        "pr_number": 461,
        "head_sha": "6161616161616161616161616161616161616161",
        "verdict": "FAIL",
        "severity_counts": {
          "blocker": 3,
          "major": 0,
          "minor": 0,
          "nit": 0
        },
        "reviewer_id": "apm2-codex-quality"
      }
      ```
expected:
  # Both categories pass because attacker comments are filtered out
  overall_pass: true
  overall_pending: false
  security_pass: true
  code_quality_pass: true
