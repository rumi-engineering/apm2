{
  "schema_version": "1.0.0",
  "canonicalizer_id": "cac-json-v1",
  "canonicalizer_version": "1.0.0",
  "description": "Test vectors for CAC-JSON canonicalization (RFC 8785 JCS profile with CAC constraints)",
  "positive_vectors": [
    {
      "id": "pos-001",
      "description": "Simple object with key reordering",
      "input": "{\"z\": 1, \"a\": 2}",
      "expected_canonical": "{\"a\":2,\"z\":1}",
      "expected_hash": "bf45b62781e04b92e506fd95427f1b4b60579334474ca10bbd16317cde8dcbbb"
    },
    {
      "id": "pos-002",
      "description": "Already canonical object",
      "input": "{\"a\":1,\"b\":2}",
      "expected_canonical": "{\"a\":1,\"b\":2}",
      "expected_hash": "8e80439b77ac62d4194499edd46684c479da3aa1ac80dd5511468efae049166e"
    },
    {
      "id": "pos-003",
      "description": "Array preserves order (not sorted)",
      "input": "[3, 1, 2]",
      "expected_canonical": "[3,1,2]",
      "expected_hash": "fdb95223ff0257469111b94c88189d23ad29b22a3ecd3059fdd169c09ea9d123"
    },
    {
      "id": "pos-004",
      "description": "Null literal",
      "input": "null",
      "expected_canonical": "null",
      "expected_hash": "03f88b99c3d8073bba8948d6e762aac443b265f606cc05abd4d172f03a4def6a"
    },
    {
      "id": "pos-005",
      "description": "Boolean true",
      "input": "true",
      "expected_canonical": "true",
      "expected_hash": "acc8a7699a2bf4cbd05f69678eac4fc236572041c28dfd0ab558e5fcf2ab6540"
    },
    {
      "id": "pos-006",
      "description": "Boolean false",
      "input": "false",
      "expected_canonical": "false",
      "expected_hash": "401f18ad0cca38559086c36f9e0295f1ca3a7023e5f095aeef69177a9b8f10ce"
    },
    {
      "id": "pos-007",
      "description": "Positive integer",
      "input": "42",
      "expected_canonical": "42",
      "expected_hash": "da136474d7575c325f702bb7aa75f1123864033cc488bf7d9c074eadaf9bd0d3"
    },
    {
      "id": "pos-008",
      "description": "Negative integer",
      "input": "-42",
      "expected_canonical": "-42",
      "expected_hash": "be1ef46b3979ca51303ac25c62e03c1885ffdedeb794554eccfbb42bbc951309"
    },
    {
      "id": "pos-009",
      "description": "Zero",
      "input": "0",
      "expected_canonical": "0",
      "expected_hash": "4d067153ac729a4a7e8220c97935ffba67487860d58298ceeb23864369867d9f"
    },
    {
      "id": "pos-010",
      "description": "Empty string",
      "input": "\"\"",
      "expected_canonical": "\"\"",
      "expected_hash": "1286f4d583fcffb2849e654c9ec78d95c03e83bf73d6b4c18b21df1dda49c7fa"
    },
    {
      "id": "pos-011",
      "description": "Empty object",
      "input": "{}",
      "expected_canonical": "{}",
      "expected_hash": "6e46dd10defc9b56c29a6ec56b508c21f54c08192194e4df25bf36f0c9c3c279"
    },
    {
      "id": "pos-012",
      "description": "Empty array",
      "input": "[]",
      "expected_canonical": "[]",
      "expected_hash": "d53d18c23212ea7b6300594bb89bce60218f6eff2b9d628b8cc42d3e79bbd5ab"
    },
    {
      "id": "pos-013",
      "description": "Maximum i64 value",
      "input": "{\"n\": 9223372036854775807}",
      "expected_canonical": "{\"n\":9223372036854775807}",
      "expected_hash": "d186ac9a7d0ad7dae72c8e7b75b6a86485eb2bdf69adacf71715da997ed19524"
    },
    {
      "id": "pos-014",
      "description": "Minimum i64 value",
      "input": "{\"n\": -9223372036854775808}",
      "expected_canonical": "{\"n\":-9223372036854775808}",
      "expected_hash": "ef9c8676d4df7ce25161643ca7a178761001946985980be86e4f1177051a20da"
    },
    {
      "id": "pos-015",
      "description": "Nested object with key reordering",
      "input": "{\"outer\": {\"z\": 1, \"a\": 2}}",
      "expected_canonical": "{\"outer\":{\"a\":2,\"z\":1}}",
      "expected_hash": "ca691ae6ac7fb2f5e5437f2c4810026117584247effe1c04e4de5552c8e5b458"
    },
    {
      "id": "pos-016",
      "description": "Nested array with object key reordering",
      "input": "{\"a\": [1, 2, {\"y\": 1, \"x\": 2}]}",
      "expected_canonical": "{\"a\":[1,2,{\"x\":2,\"y\":1}]}",
      "expected_hash": "c914e223c3f12dfd4d2262f22253e1f97cdff2665bea2bca1a93291e05f518f1"
    },
    {
      "id": "pos-017",
      "description": "String with newline escape",
      "input": "{\"text\": \"hello\\nworld\"}",
      "expected_canonical": "{\"text\":\"hello\\nworld\"}",
      "expected_hash": "a763d87bc3ee491497aaf530845cb628f70abd32863e485eeddd3bbe4ae39b5a"
    },
    {
      "id": "pos-018",
      "description": "String with tab escape",
      "input": "{\"text\": \"hello\\tworld\"}",
      "expected_canonical": "{\"text\":\"hello\\tworld\"}",
      "expected_hash": "682d692715d66ce99d92b63a6eef71a0fa9971e4337bfab7cff74228000062a1"
    },
    {
      "id": "pos-019",
      "description": "String with escaped quotes",
      "input": "{\"text\": \"say \\\"hello\\\"\"}",
      "expected_canonical": "{\"text\":\"say \\\"hello\\\"\"}",
      "expected_hash": "7d0242c476b52fcfed56bc3e92f2e52251024a768b837a990adfe548a36d8176"
    },
    {
      "id": "pos-020",
      "description": "String with backslash",
      "input": "{\"text\": \"back\\\\slash\"}",
      "expected_canonical": "{\"text\":\"back\\\\slash\"}",
      "expected_hash": "9b4830451cd6eb0e815acb638225f54aedc5780daa5721a336800d9204616751"
    },
    {
      "id": "pos-021",
      "description": "Unicode heart emoji (NFC)",
      "input": "{\"emoji\": \"\\u2764\"}",
      "expected_canonical": "{\"emoji\":\"\u2764\"}",
      "expected_hash": "d73d572f77595bca7dd3f664775b4570120d5693bbde349ff56e64ecc13c291b"
    },
    {
      "id": "pos-022",
      "description": "Chinese characters (NFC)",
      "input": "{\"chinese\": \"\\u4e2d\\u6587\"}",
      "expected_canonical": "{\"chinese\":\"\u4e2d\u6587\"}",
      "expected_hash": "448d448c89caca7c28e8fcba53d275fb05d26b77b9fee179e04277e5f37f3403"
    },
    {
      "id": "pos-023",
      "description": "Multiple nested levels",
      "input": "{\"level1\": {\"level2\": {\"level3\": {\"value\": 42}}}}",
      "expected_canonical": "{\"level1\":{\"level2\":{\"level3\":{\"value\":42}}}}",
      "expected_hash": "fff235e163ca7cec2dbf5ce4a8678976412f27f27940b3807043f23aa041a343"
    },
    {
      "id": "pos-024",
      "description": "Mixed array types",
      "input": "[1, \"string\", true, null, {\"key\": \"value\"}]",
      "expected_canonical": "[1,\"string\",true,null,{\"key\":\"value\"}]",
      "expected_hash": "16454b5bf1873432ff16dd317aca63fd2392b723b3554d834e689afaa2b8f552"
    },
    {
      "id": "pos-025",
      "description": "Whitespace in input stripped",
      "input": "  {  \"key\"  :  \"value\"  }  ",
      "expected_canonical": "{\"key\":\"value\"}",
      "expected_hash": "fe9db19f3ed52dbdf733dee6f39a3422581eb01ec0e8d0c3330f7ac3137e2d86"
    },
    {
      "id": "pos-026",
      "description": "Control character U+0000 escaped",
      "input": "{\"ctrl\": \"\\u0000\"}",
      "expected_canonical": "{\"ctrl\":\"\\u0000\"}",
      "expected_hash": "6b858880948297257c93543ac42256608ac8dd76aab79b03db149bd31ba6798b"
    },
    {
      "id": "pos-027",
      "description": "Control character U+001F escaped",
      "input": "{\"ctrl\": \"\\u001f\"}",
      "expected_canonical": "{\"ctrl\":\"\\u001f\"}",
      "expected_hash": "cd3169ed05a0313e3b223eb3816350b57eb26adc1a7c4001af336a954a683283"
    },
    {
      "id": "pos-028",
      "description": "DEL character U+007F NOT escaped (JCS minimal escaping)",
      "input": "{\"del\": \"\\u007f\"}",
      "expected_canonical": "{\"del\":\"\u007f\"}",
      "expected_hash": "5fa5e98d57911fe5afff062c800329a09dd014f506a8a9170c329503d719f37f"
    },
    {
      "id": "pos-029",
      "description": "Large integer near i64 boundary",
      "input": "{\"big\": 9223372036854775806}",
      "expected_canonical": "{\"big\":9223372036854775806}",
      "expected_hash": "1da5e8addc3c79f4989052f93a4ecce638f9407a32bf3869a5f30a535f467ef9"
    },
    {
      "id": "pos-030",
      "description": "Complex nested structure with multiple key orderings",
      "input": "{\"z\": {\"c\": 3, \"a\": 1, \"b\": 2}, \"a\": {\"x\": 10, \"y\": 20}}",
      "expected_canonical": "{\"a\":{\"x\":10,\"y\":20},\"z\":{\"a\":1,\"b\":2,\"c\":3}}",
      "expected_hash": "c41618abfff8eb5aa9710eee72b7e5933adcbc12ed8c4832c37b9b0f44a7d8b9"
    }
  ],
  "negative_vectors": [
    {
      "id": "neg-001",
      "description": "Float not allowed",
      "input": "{\"x\": 1.5}",
      "expected_error": "FloatNotAllowed"
    },
    {
      "id": "neg-002",
      "description": "Float in array",
      "input": "[1, 2.5, 3]",
      "expected_error": "FloatNotAllowed"
    },
    {
      "id": "neg-003",
      "description": "Float with scientific notation",
      "input": "{\"x\": 1.5e10}",
      "expected_error": "FloatNotAllowed"
    },
    {
      "id": "neg-004",
      "description": "Number above i64 max",
      "input": "{\"x\": 9223372036854775808}",
      "expected_error": "NumberOutOfRange"
    },
    {
      "id": "neg-005",
      "description": "Duplicate key at top level",
      "input": "{\"a\": 1, \"a\": 2}",
      "expected_error": "DuplicateKey"
    },
    {
      "id": "neg-006",
      "description": "Duplicate key in nested object",
      "input": "{\"outer\": {\"x\": 1, \"x\": 2}}",
      "expected_error": "DuplicateKey"
    },
    {
      "id": "neg-007",
      "description": "Duplicate key via escape sequence",
      "input": "{\"a\": 1, \"\\u0061\": 2}",
      "expected_error": "DuplicateKey"
    },
    {
      "id": "neg-008",
      "description": "Non-NFC string value (e + combining acute)",
      "input": "{\"key\": \"e\\u0301\"}",
      "expected_error": "NonNfcString"
    },
    {
      "id": "neg-009",
      "description": "Non-NFC string in key",
      "input": "{\"e\\u0301\": \"value\"}",
      "expected_error": "NonNfcString"
    },
    {
      "id": "neg-010",
      "description": "Invalid JSON syntax",
      "input": "not json",
      "expected_error": "ParseError"
    },
    {
      "id": "neg-011",
      "description": "Truncated JSON",
      "input": "{\"key\":",
      "expected_error": "ParseError"
    },
    {
      "id": "neg-012",
      "description": "Trailing comma (invalid JSON)",
      "input": "{\"a\": 1,}",
      "expected_error": "ParseError"
    }
  ],
  "depth_limit_vectors": [
    {
      "id": "depth-001",
      "description": "Nesting at exactly MAX_DEPTH=128 levels (may hit serde limit first)",
      "depth": 128,
      "generator": "nested_object",
      "notes": "Generate {\"n\":{\"n\":...}} nested 128 times. May succeed or fail depending on serde_json recursion limit."
    },
    {
      "id": "depth-002",
      "description": "Nesting above MAX_DEPTH=128 levels",
      "depth": 150,
      "generator": "nested_object",
      "expected_error_pattern": "depth|recursion"
    },
    {
      "id": "depth-003",
      "description": "Array nesting above MAX_DEPTH",
      "depth": 150,
      "generator": "nested_array",
      "expected_error_pattern": "depth|recursion"
    }
  ],
  "idempotence_vectors": [
    {
      "id": "idem-001",
      "description": "Canonicalization is idempotent: C(C(x)) == C(x)",
      "inputs": [
        "{\"z\": 1, \"a\": 2}",
        "{\"nested\": {\"b\": 2, \"a\": 1}, \"top\": \"value\"}",
        "[1, 2, {\"y\": 3, \"x\": 4}]"
      ]
    }
  ],
  "determinism_vectors": [
    {
      "id": "det-001",
      "description": "Equivalent JSON with different key orders produce identical canonical output",
      "inputs": [
        "{\"c\": 3, \"a\": 1, \"b\": 2}",
        "{\"a\": 1, \"b\": 2, \"c\": 3}",
        "{\"b\": 2, \"c\": 3, \"a\": 1}"
      ],
      "expected_canonical": "{\"a\":1,\"b\":2,\"c\":3}"
    },
    {
      "id": "det-002",
      "description": "Nested structure determinism",
      "inputs": [
        "{\"z\": {\"c\": 3, \"a\": 1}, \"a\": [1, 2, {\"y\": 1, \"x\": 2}]}",
        "{\"a\": [1, 2, {\"x\": 2, \"y\": 1}], \"z\": {\"a\": 1, \"c\": 3}}"
      ],
      "expected_canonical": "{\"a\":[1,2,{\"x\":2,\"y\":1}],\"z\":{\"a\":1,\"c\":3}}"
    }
  ]
}
