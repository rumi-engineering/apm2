prior_decisions_index:
  schema_version: "2026-01-26"
  generated_at: "2026-01-26T00:00:00Z"

  rfcs:
    - id: RFC-0001
      title: "APM2 Kernel Architecture: Supervisor, Ledger, Policy, and Syscall Mediation"
      status: DRAFT
      prd_id: PRD-0001
      key_decisions:
        - "Use SQLite for append-only ledger storage"
        - "Ed25519 signatures for ledger integrity"
        - "YAML policies for declarative governance"
        - "Protobuf for wire protocol events"
      relevant_to_prd_0005:
        - "Ledger can be reused for compilation run manifests"
        - "Crypto module provides signing infrastructure"

    - id: RFC-0003
      title: "Holon Framework"
      status: DRAFT
      key_decisions:
        - "Holon trait with intake/execute_episode/emit_artifact/escalate"
        - "Budget and Lease types for bounded authority"
        - "StopCondition enum for termination predicates"
        - "SkillFrontmatter parsing with HolonConfig"
      relevant_to_prd_0005:
        - "Compiler stages can implement Holon trait"
        - "Budget/Lease infrastructure reusable for compilation leases"
        - "Skill parsing infrastructure reusable for idea-compiler skill"

    - id: RFC-0004
      title: "Adapter System"
      status: DRAFT
      key_decisions:
        - "Adapter trait for process observation"
        - "ClaudeCodeAdapter for instrumented hooks"
        - "BlackBoxAdapter for filesystem observations"
      relevant_to_prd_0005:
        - "Factory run already uses ClaudeCodeAdapter"
        - "Same pattern can be used for model routing"

  prds:
    - id: PRD-0001
      title: "APM2 Kernel"
      status: DRAFT
      relevant_to_prd_0005:
        - "Establishes ledger and policy infrastructure"

    - id: PRD-0003
      title: "Holon Framework"
      status: DRAFT
      relevant_to_prd_0005:
        - "Provides bounded execution model for compiler stages"

  architectural_patterns:
    - name: "Event Sourcing with Reducers"
      location: crates/apm2-core/src/reducer
      description: "Append-only event log with projection reducers"
      applicable_to: "Run manifests, compilation history"

    - name: "Holon Bounded Execution"
      location: crates/apm2-holon
      description: "Episodic execution with stop conditions"
      applicable_to: "Compiler stage execution model"

    - name: "Skill Frontmatter"
      location: crates/apm2-holon/src/skill.rs
      description: "YAML frontmatter in markdown files"
      applicable_to: "idea-compiler skill definition"

    - name: "Factory Command Pattern"
      location: crates/apm2-cli/src/commands/factory.rs
      description: "Agent orchestration via CLI"
      applicable_to: "Factory compile command"
