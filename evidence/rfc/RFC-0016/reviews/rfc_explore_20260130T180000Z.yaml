schema_version: "1.0.0"
rfc_id: RFC-0016
review_timestamp: "2026-01-30T18:00:00Z"
review_depth: COUNCIL
review_mode: EXPLORE

rfc_version_before: "v0.1"
rfc_version_after: "v2.0"
rfc_phase_before: "v0 (Council Drafting)"
rfc_phase_after: "v2 (Grounded)"

exploration_summary: |
  EXPLORE mode codebase investigation completed. All four open questions
  resolved with concrete codebase evidence. Design decisions grounded in
  existing code patterns. RFC advanced from v0 to v2 (Grounded).

open_questions_resolved:
  - question_id: Q-HTF-0001
    question: "Tick quantum representation: store raw monotonic ns vs fixed-rate ticks"
    status: RESOLVED
    resolution: "Store raw monotonic nanoseconds; expose policy tick_rate_hz"
    evidence_files:
      - crates/apm2-core/src/ledger/bft_backend.rs:198-205
      - crates/apm2-core/src/consensus/crdt.rs:199-225

  - question_id: Q-HTF-0002
    question: "Cross-ledger mapping when multiple ledgers exist"
    status: RESOLVED_PHASE1
    resolution: "Phase 1 single ledger; LedgerTime = (ledger_id, epoch, seq)"
    evidence_files:
      - crates/apm2-core/src/ledger/bft_backend.rs:271-279
      - crates/apm2-core/src/evidence/strictly_ordered.rs:318-341

  - question_id: Q-HTF-0003
    question: "Bounded wall-time source selection and confidence representation"
    status: RESOLVED
    resolution: "ClockProfile as governed artifact; max_wall_uncertainty_ns field"
    evidence_files:
      - crates/apm2-core/src/lease/state.rs:129-149
      - crates/apm2-daemon/src/evidence/receipt.rs:17,482,833

  - question_id: Q-HTF-0004
    question: "Handling monotonic anomalies under suspend/migration"
    status: RESOLVED
    resolution: "Policy-tier framework; regressions fatal, jumps policy-dependent"
    evidence_files:
      - crates/apm2-core/src/consensus/crdt.rs:45-50
      - crates/apm2-daemon/src/episode/state.rs:72-103

codebase_investigation:
  agent_id: a870122
  files_examined:
    - path: crates/apm2-core/src/ledger/bft_backend.rs
      relevant_lines: [198-245, 271-290, 318-330]
      findings:
        - "HlcTimestamp struct implements C-clock pattern"
        - "ConsensusIndex with epoch/round/index for L-clock scaffolding"
        - "EventMetadata includes canonicalizer_id/version fields"

    - path: crates/apm2-core/src/consensus/crdt.rs
      relevant_lines: [1-88, 196-225]
      findings:
        - "Full HLC-based CRDT merge operators"
        - "MAX_FUTURE_SKEW_NS = 60 seconds guards against remote skew"
        - "Lexicographic ordering (wall_ns, logical, node_id)"

    - path: crates/apm2-core/src/evidence/strictly_ordered.rs
      relevant_lines: [317-400, 486-558]
      findings:
        - "TotalOrderProof with epoch, round, block_hash"
        - "StrictlyOrderedEvidence requires proof validation"
        - "Fail-closed pattern for admission-critical artifacts"

    - path: crates/apm2-core/src/lease/state.rs
      relevant_lines: [129-200]
      findings:
        - "Wall-time fields issued_at, expires_at (TCK-00241 target)"
        - "is_expired_at() method compares wall times"
        - "Tests use injected timestamps - good pattern"

    - path: crates/apm2-core/src/coordination/controller.rs
      relevant_lines: [112, 363, 504, 810, 961]
      findings:
        - "Instant::now() usage for duration tracking (TCK-00242 target)"
        - "elapsed_ms computed from wall time"
        - "max_duration_ms budget checking"

    - path: crates/apm2-daemon/src/evidence/receipt.rs
      relevant_lines: [17, 482, 833]
      findings:
        - "timestamp_ns fields are observational"
        - "created_at and generated_at in receipts"
        - "Not used for gate truth - compliant pattern"

    - path: crates/apm2-daemon/src/episode/state.rs
      relevant_lines: [72-103]
      findings:
        - "QuarantineReason struct exists for anomaly pinning"
        - "Foundation for HTF policy-tier defect recording"

anti_cousin_analysis:
  total_proposed_types: 5
  cousins_identified: 0
  extensions_identified: 2
  new_types: 1
  reuse_identified: 1
  verdicts:
    - proposed: LedgerTime
      verdict: NOT_COUSIN
      rationale: "Distinct from TotalOrderProof; different semantics"
    - proposed: HtfTick
      verdict: NOT_COUSIN
      rationale: "Newtype enforces tick semantics over raw u64"
    - proposed: HlcStamp
      verdict: REUSE
      rationale: "Reuse existing Hlc from consensus/crdt.rs"
    - proposed: TimeEnvelopeRef
      verdict: EXTENSION
      rationale: "Follows CAS content-hash pattern"
    - proposed: BoundedWallInterval
      verdict: NEW
      rationale: "Novel type for wall-time uncertainty"

files_modified:
  - path: documents/rfcs/RFC-0016/00_meta.yaml
    changes: "Version bumped to v2.0; version history updated"
  - path: documents/rfcs/RFC-0016/02_design_decisions.yaml
    changes: "Added codebase_grounding section with evidence"
  - path: documents/rfcs/RFC-0016/08_risks_and_open_questions.yaml
    changes: "Open questions marked RESOLVED with codebase evidence"

next_actions:
  - action: FINALIZE_TO_V4
    mode: FINALIZE
    priority: HIGH
    rationale: "Advance to v4 (Standard) for final convergence"

  - action: DECOMPOSE_TICKETS
    mode: DECOMPOSE
    priority: MEDIUM
    rationale: "Generate TCK-00236 through TCK-00247 for implementation"

  - action: EMIT_TICKETS
    command: "apm2 factory tickets emit --rfc RFC-0016"
    priority: MEDIUM
    rationale: "Tickets ready; dependencies validated"

council_metadata:
  session_id: COUNCIL-RFC-0016-20260130-explore
  review_agent: claude-opus-4-5
  previous_review: rfc_review_20260130T120000Z.yaml
  mode: EXPLORE
  phase_transition: "v0 -> v2"
  exploration_thoroughness: VERY_THOROUGH
  open_questions_before: 4
  open_questions_resolved: 4
  codebase_files_examined: 7
  anti_cousin_compliance: true
